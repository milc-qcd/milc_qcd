<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on February 21, 2012 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>The MILC Code (version: 7.7.3)</title>

<meta name="description" content="The MILC Code (version: 7.7.3)">
<meta name="keywords" content="The MILC Code (version: 7.7.3)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Top"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-MILC-Code"></a>
<h1 class="settitle">The MILC Code</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Obtaining-the-MILC-Code">1. Obtaining the MILC Code</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Building-the-MILC-Code">2. Building the MILC Code</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Command-line-options">3. Command line options</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#General-description">4. General description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Programming-with-MILC-Code">5. Programming with MILC Code</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Writing-Your-Own-Application">6. Writing Your Own Application</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Documentation-for-Specific-Applications">7. Documentation for Specific Applications</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Concept-Index">Concept Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Variable-Index">Variable Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="1">
<a name="Obtaining-the-MILC-Code"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Web-sites" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="index-Obtaining-the-MILC-Code"></a>
<a name="Obtaining-the-MILC-Code-1"></a>
<h1 class="chapter">1. Obtaining the MILC Code</h1>

<p>This chapter explains how to get the code, copyright conditions and the
installation process.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Web-sites">1.1 Web sites</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Usage-conditions">1.2 Usage conditions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Installing-the-MILC-Code">1.3 Installing the MILC Code</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Portability">1.4 Portability</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SciDAC-Support">1.5 SciDAC Support</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#GPU-Support">1.6 GPU Support</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Supported-architectures">1.7 Supported architectures</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Web-sites"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-conditions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Web-sites-1"></a>
<h2 class="section">1.1 Web sites</h2>
<a name="index-Web-sites"></a>
<a name="index-MILC-Homepage"></a>

<p>The most up-to-date information and access to the MILC Code can be found
</p>
<ul>
<li> via WWW at: 
<ul>
<li> <kbd>http://physics.utah.edu/~detar/milc/</kbd>
</li></ul>

</li><li> via email request to the authors&rsquo; representatives at: 
<ul>
<li> <kbd>doug@klingon.physics.arizona.edu</kbd>
</li><li> <kbd>detar@physics.utah.edu</kbd>
</li></ul>
</li></ul>

<hr size="6">
<a name="Usage-conditions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Web-sites" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installing-the-MILC-Code" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Usage-conditions-1"></a>
<h2 class="section">1.2 Usage conditions</h2>
<a name="index-Usage-conditions"></a>
<a name="index-Free-Software-Foundation"></a>
<a name="index-GNU-General-Public-License"></a>

<p>The MILC Code is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation.
</p>
<p><strong>Publications of research work done using this code or
derivatives of this code should acknowledge its use.</strong> The MILC project
is supported in part by grants from the US Department of Energy and
National Science Foundation, and we ask that you use (at least) the
following string in publications which derive results using this
material: 
<br>
</p>
<p><em>This work was in part based on the MILC
collaboration&rsquo;s public lattice gauge theory code. See
<strong>http://physics.utah.edu/~detar/milc.html</strong></em>
<br>
</p>
<p>This software is distributed in the hope that it will be useful, but
without any warranty; without even the implied warranty of
merchantability or fitness for a particular purpose. See the GNU
General Public License for more details, a copy of which License can be
obtained from
</p><table><tr><td>&nbsp;</td><td><pre class="example">Free Software Foundation, Inc., 
675 Mass Ave, Cambridge, MA 02139, USA.
</pre></td></tr></table>

<p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the
entire resulting derived work is distributed under the terms of a
permission notice identical to this one.
</p>
<hr size="6">
<a name="Installing-the-MILC-Code"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-conditions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Portability" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installing-the-MILC-Code-1"></a>
<h2 class="section">1.3 Installing the MILC Code</h2>
<a name="index-Installing-the-MILC-Code"></a>

<p>Unpack with the command
</p><table><tr><td>&nbsp;</td><td><pre class="example">    tar -xzf milc_qcd*.tar.gz
</pre></td></tr></table>
<p>The procedure for building the MILC code is explained later in this
document (see section <a href="#Building-the-MILC-Code">Building the MILC Code</a>) or in the <kbd>README</kbd> file
that accompanies the code.
</p>
<hr size="6">
<a name="Portability"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installing-the-MILC-Code" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SciDAC-Support" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Portability-1"></a>
<h2 class="section">1.4 Portability</h2>
<a name="index-Portability"></a>
<a name="index-Installing-the-Code"></a>

<p>One of our aims in writing this code was to make it very portable
across machine architectures and configurations. While the code must
be compiled with the architecture-specific low-level communication
files (see section <a href="#Building-the-MILC-Code">Building the MILC Code</a>), the application codes contain
a minimum of architecture-dependent <strong>#ifdef</strong>&rsquo;s, which now are
mostly for machine-dependent performance optimizations in the
conjugate gradient routines, etc, since MPI has become a portable
standard.
</p>
<p>Similarly, with regard to random numbers, care has been taken to ensure
convenience and reproducibility. With <strong>SITERAND</strong> set
(see section <a href="#Random-numbers">Random numbers</a>), the random number generator will produce
the same sequence for a given seed, indendent of architecture and
the number of nodes.
</p>
<hr size="6">
<a name="SciDAC-Support"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Portability" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPU-Support" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="SciDAC-Support-1"></a>
<h2 class="section">1.5 SciDAC Support</h2>
<a name="index-SciDAC-Support"></a>

<p>The software component of the U.S. Department of Energy Lattice QCD
SciDAC project provides a multilayer interface for lattice gauge
theory code. It is intended to be portable even to specialized
platforms, such as GPU clusters.  This release of the MILC code
supports a wide variety of C-language SciDAC modules.  They are
invoked through compilation macros described below (see section <a href="#Optional-Compilation-Macros">Optional Compilation Macros</a>).
</p>
<hr size="6">
<a name="GPU-Support"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SciDAC-Support" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Supported-architectures" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="GPU-Support-1"></a>
<h2 class="section">1.6 GPU Support</h2>
<a name="index-GPU-Support"></a>

<p>Development-grade QUDA-based GPU support for staggered and HISQ
molecular dynamics.  Currently, only single-GPU operation is
supported.  Multi-GPU is planned.
</p>
<hr size="6">
<a name="Supported-architectures"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#GPU-Support" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Supported-architectures-1"></a>
<h2 class="section">1.7 Supported architectures</h2>
<a name="index-Supported-architectures"></a>
<p>This manual covers <strong>version 7.7.3</strong> which is currently supposed to
run on: 
<br>
</p><ul>
<li> Scalar machines
</li><li> Linux+MPI clusters
</li><li> IBM BG/L BG/P BG/Q
</li><li> Cray XT3, XE6
</li><li> Multi-GPU clusters
</li></ul>

<p>In addition it has run in the past on
</p><ul>
<li> SGI Origin 2000
</li><li> IBM SP
</li><li> NT Clusters
</li><li> Compaq Alpha Clusters
</li><li> The Intel iPSC-860
</li><li> Intel Paragon
</li><li> PVM (version 3.2)
</li><li> The Ncube 2
</li><li> The Thinking Machines CM5
</li><li> SGI/Cray T3E
</li><li> Columbia/BNL QCDOC
</li></ul>
<p>and many other long gone (but not forgotten) computers.
</p>
<a name="index-bugs-reports"></a>
<a name="index-questions-to-the-authors"></a>
<p>Since this is our working code, it in a continual state of
development.  We informally support the code as best we can by
answering questions and fixing bugs.  We will be very grateful for
reports of problems and suggestions for improvements, which may be
sent to
</p><table><tr><td>&nbsp;</td><td><pre class="example">doug@klingon.physics.arizona.edu
detar@physics.utah.edu
</pre></td></tr></table>

<hr size="6">
<a name="Building-the-MILC-Code"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Supported-architectures" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Making-the-Libraries" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Obtaining-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Command-line-options" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Building-the-MILC-Code-1"></a>
<h1 class="chapter">2. Building the MILC Code</h1>
<a name="index-Building-the-code"></a>

<a name="index-Makefiles"></a>
<p>Here are the steps required to build the code.  An explanation follows.
</p>
<ol>
<li> Select the application and target you wish to build
</li><li> Edit the &lsquo;<tt>Makefile</tt>&rsquo; to select compilation options
</li><li> Edit the &lsquo;<tt>libraries/Make_vanilla</tt>&rsquo; make file.
</li><li> Edit the &lsquo;<tt>include/config.h</tt>&rsquo;. (Usually unnecessary.)
</li><li> (Optional) Build and install the SciDAC packages.
</li><li> (Optional) Build and install the FFTW packages.
</li><li> (Optional) Build and install LAPACK.
</li><li> (Optional) Build and install PRIMME.
</li><li> (Optional) Build and install QUDA.
</li><li> Run <strong>make</strong> for the appropriate target
</li></ol>

<ol>
<li> Select the application and target you wish to build

<p>The physics code is organized in various application directories.
Within each directory there are various compilation choices
corresponding to each <strong>make</strong> target.  Further variations are
controlled by macro definitions in the &lsquo;<tt>Makefile</tt>&rsquo;.  So, for
example, the <strong>pure_gauge</strong> application directory contains code
for the traditional single-plaquette action.  Choices for
<strong>make</strong> targets include a hybrid Monte Carlo code and an
overrelaxed heatbath code.  Among variations in the &lsquo;<tt>Makefile</tt>&rsquo;
are single-processor or multi-processor operation and single or double
precision computation.
</p>
</li><li> Edit the &lsquo;<tt>Makefile</tt>&rsquo; to select compilation options

<p>A generic &lsquo;<tt>Makefile</tt>&rsquo; is found in the top-level directory.  Copy
it to the application subdirectory and edit it there.  Comments in the
file explain the choices.
</p>
<p>The scalar workstation code is written in ANSI standard C99.  If your
compiler is not ANSI compliant, try using the Gnu C compiler gcc
instead.  The code can also be compiled under C++, but it uses no
exclusively C++ constructs.
</p>
</li><li> Edit the &lsquo;<tt>libraries/Make_vanilla</tt>&rsquo; make file.

<p>The MILC code contains a library of single-processor linear algebra
routines.  (No communication occurs in these routines.)  The library
is automatically built when you build the application target.
However, you need to set the compiler and compiler flags in the
library make file &lsquo;<tt>libraries/Make_vanilla</tt>&rsquo;.  It is a good idea to
verify that the compilation of the libaries is compatible with the
compilation of the application, for example, by using the same
underlying compiler for the libraries and the application code.
</p>
<p>The library consists of two archived library files, each with a single
and double-precision version.  The libraries &lsquo;<tt>complex.1.a</tt>&rsquo; and
&lsquo;<tt>complex.2.a</tt>&rsquo; do single and double precision complex arithmetic
and the libraries &lsquo;<tt>su3.1.a</tt>&rsquo; and &lsquo;<tt>su3.2.a</tt>&rsquo; do a wide variety
of single and double precison matrix and vector arithmetic.
</p>
<p>If you are cross-compiling, i.e. the working processors are of a
different architecture from the compilation processor, you may also
need to select the appropriate archiver <strong>ar</strong>.
</p>
<p>Many present-day processors have SSE capability offering faster
floating point arithmetic.  Most compilers now support them, so
additional effort to support them is not necessary.  Alternatives
include compiling assembly-coded alternatives to some of the most
heavily used library routines and, for gcc, using inlined assembly
instructions.  There is vestigial and not continually tested support
for these alternatives.
</p>
</li><li> Edit the &lsquo;<tt>include/config.h</tt>&rsquo;.

<p>At the moment we do not use autoconf/automake to get information about
the system environment.  This file deals with variations in the
operating system.  In most cases it doesn&rsquo;t need to be changed.
</p>
</li><li> (Optional) Build and install the SciDAC packages.

<p>If you wish to compile and link against the SciDAC packages, you must
first build and install them.  Note that for full functionality of the
code, you will need QMP and QIO.  The MILC code supports the
following packages:
</p><table><tr><td>&nbsp;</td><td><pre class="example">QMP (message passing)
QIO (file I/O)
QLA (linear algebra)
QDP/C (data parallel)
QOPQDP (optimized higher level code, such as inverters)
</pre></td></tr></table>
<p>They are open-source and available from
<strong>http://usqcd.jlab.org/usqcd-software/</strong>.
</p>
</li><li> (Optional) Build and install the LAPACK package.

<p>For the BlueGene some of the optimized code uses LAPACK.
</p>
</li><li> (Optional) Build and install the FFTW package.

<p>The convolution routines for source and sink operators use fast
Fourier transforms in the FFTW package.  A native MILC FFT is used if
the FFTW package is not selected in the top-level Makefile, so an
application that does not require a convolution can be built..  The
native version is inefficient, however.
</p>
</li><li> (Optional) Build and install the PRIMME package.

<p>The PRIMME preconditioned multimethod eigensolver by James R. McCombs
and Andreas Stathopoulos is recommended but not required for the
<strong>arb_overlap</strong> application.
</p>
</li><li> (Optional) Build and install the QUDA package.

<p>The QUDA package, developed by the USQCD collaboration, provides
support for GPU computations.  It is obtained from the GIT repository
<strong>https://github.com/lattice/quda</strong>.
</p>
</li><li> Run <strong>make</strong> for the appropriate target

<p>The generic &lsquo;<tt>Make_template</tt>&rsquo; file in the application directory
lists a variety of targets followed by a double colon <kbd>::</kbd>.
</p>
</li></ol>

<hr size="6">
<a name="Making-the-Libraries"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Checking-the-Build" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Command-line-options" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.1 Making the Libraries</h2>
<a name="index-making-the-libraries"></a>
<p>The libraries are built automatically when you make the application
target.  However, it is a good idea to verify that the compilation of
the libaries is compatible with the compilation of the application.
There are two libraries needed for SU(3) operations.  They come in
single and double precision versions, indicated by the suffix
<strong>1</strong> and <strong>2</strong>.
</p><ul>
<li> <strong>complex.1.a</strong> and <strong>complex.2.a</strong>
contain routines for operations on complex
numbers. See &lsquo;<tt>complex.h</tt>&rsquo; for a summary.
</li><li> <strong>su3.1.a</strong> and <strong>su3.2.a</strong> 
contain routines for operations on SU3 matrices,
three element complex vectors, and Dirac vectors (twelve element complex
vectors) among others.  See &lsquo;<tt>su3.h</tt>&rsquo; for a summary.
</li></ul>

<hr size="6">
<a name="Checking-the-Build"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Making-the-Libraries" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Command-line-options" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Command-line-options" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.2 Checking the Build</h2>
<a name="index-checking-the-build"></a>

<p>It is a good idea to run the compiled code with the sample input file
and compare the results with the sample output.  Of course, the most
straightforward way to do this is to run the test by hand.  Since
comparing a long list of numbers is tedious, each application has a
facility for testing the code and doing the comparison automatically.
</p>
<p>You can test the code automatically in single-processor or
multiprocessor mode.  A make target is provided for running regression
tests.  If you use it, and you are testing in MPP mode, you must edit
the file &lsquo;<tt>Make_test_template</tt>&rsquo; in the top-level directory to
specify the appropriate job launch command (usually &lsquo;<tt>mpirun</tt>&rsquo;).
Comments in the file specify what needs to be changed.  As released,
the &lsquo;<tt>Make_test_template</tt>&rsquo; file is set for a single-processor test.
</p>
<p>Sample input and output files are provided for most make targets.  For
each application directory, they are found in the subdirectory
&lsquo;<tt>test</tt>&rsquo;.  The file &lsquo;<tt>checklist</tt>&rsquo; contains a list of regression
tests and their variants.  A test is specified by the name of its
executable, its precision, and, if applicable, one of various input
cases.  For example, in the application directory
&lsquo;<tt>ks_imp_dyn/test</tt>&rsquo;, the &lsquo;<tt>checklist</tt>&rsquo; file starts with the line
</p>
<p><code>exec  su3_rmd                           1 - - WARMUPS RUNNING</code>
</p>
<p>The name of the executable is &lsquo;<tt>su3_rmd</tt>&rsquo;, the precision is
&lsquo;<tt>1</tt>&rsquo; for single precision, and there is only one test case
(indicated by the second dash).  Corresponding to each regression test
is a set of files, namely, a sample input file, a sample output file,
and an error tolerance file.  For the above example, the files are
&lsquo;<tt>su3_rmd.1.sample-in</tt>&rsquo;, &lsquo;<tt>su3_rmd.1.sample-out</tt>&rsquo;,
and &lsquo;<tt>su3_rmd.1.errtol</tt>&rsquo;, respectively.
</p>
<p>If you want to run the test by hand, first compile the code with the
desired precision, then go to the &lsquo;<tt>test</tt>&rsquo; directory, and run the
executable with one of the appropriate sample input files.  For the
above example, the command would be
</p>
<p><code>../su3_rmd &lt; su3_rmd.1.sample-in</code>.
</p>
<p>Compare the output with the file &lsquo;<tt>su3_rmd.1.sample-out</tt>&rsquo;.  There
are inevitably slight differences in the results because of roundoff
error.  The &lsquo;<tt>su3_rmd.1.errtol</tt>&rsquo; specifies tolerances for these
differences where they matter.  Probably, you won&rsquo;t want to compare
every number, so using the scripts invoked by &lsquo;<tt>make check</tt>&rsquo; is
more convenient.
</p>
<p>A make target is provided for running regression tests.  To run all
the regression tests listed in the &lsquo;<tt>checklist</tt>&rsquo; file, go to the
main application directory and do
</p>
<p><code>make check</code>.
</p>
<p>It is a good idea to redirect standard output and error to a file as in 
</p>
<p><code>make check 2&gt;&amp;1 &gt; maketest.log</code>
</p>
<p>so the test results can be examined individually.
</p>
<p>To run a test for a selected case in the &lsquo;<tt>checklist</tt>&rsquo; file, do
</p>
<p><code>make check &quot;EXEC=su3_rmd&quot; &quot;CASE=-&quot; &quot;PREC=1&quot;</code>
</p>
<p>Omitting the &lsquo;<tt>PREC</tt>&rsquo; definition causes both precisions to be
tested (assuming they both appear in the &lsquo;<tt>checklist</tt>&rsquo; file).
Omitting both the &lsquo;<tt>PREC</tt>&rsquo; and the &lsquo;<tt>CASE</tt>&rsquo; definition causes
all cases and precisions for the given executable to be tested.
</p> 
<p>The automated test consists in most cases of generating a file
&lsquo;<tt>test/su3_rmd.n.test-out</tt>&rsquo; for &lsquo;<tt>n</tt>&rsquo; = 1 or 2 (single or double
precision) and comparing key sections of the file with the trusted
output &lsquo;<tt>test/su3_rmc.n.sample-out</tt>&rsquo;.  The comparison checks
line-by-line the difference of numerical values on a line.  The file
&lsquo;<tt>su3_rmd.n.errtol</tt>&rsquo; specifies the tolerated differences.  An error
message is written if a field is found to differ by more than the
preset tolerance.  A summary of out-of-tolerance differences is
written to &lsquo;<tt>su3_rmd.n.test-diff</tt>&rsquo;.  Differences may arise because
of round-off or, in molecular dynamics updates, a round-off-initiated
drift.
</p>
<p>Some regression tests involve secondary output files with similar
&lsquo;<tt>sample-out</tt>&rsquo;, &lsquo;<tt>test-out</tt>&rsquo; and &lsquo;<tt>errtol</tt>&rsquo; file-name
extensions.
</p>

<hr size="6">
<a name="Command-line-options"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Checking-the-Build" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Building-the-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Command-line-options-1"></a>
<h1 class="chapter">3. Command line options</h1>
<a name="index-command-line-options"></a>
<a name="index-qmp_002dgeom"></a>
<a name="index-qmp_002djobs"></a>
<a name="index-geom"></a>
<a name="index-jobs"></a>
<a name="index-stdin"></a>
<a name="index-stdout"></a>
<a name="index-stderr"></a>

<p>All applications take the same set of command-line options.  The
format with SciDAC QMP compilation is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">   &lt;executable&gt; [-qmp-geom &lt;int(4)&gt;] [-qmp-jobs &lt;int(1-4)&gt;] 
         [ stdin_path [ stdout_path [stderr_path]]]
</pre></td></tr></table>
<p>and without QMP compilation it is
</p><table><tr><td>&nbsp;</td><td><pre class="example">   &lt;executable&gt; [-geom &lt;int(4)&gt;] [-jobs &lt;int(1-4)&gt;] 
         [ stdin_path [ stdout_path [stderr_path]]]
</pre></td></tr></table>

<p>Normally standard input, output, and error are obtaine through Unix
redirection with <strong>&lt; stdin_path</strong> and <strong>&gt; stdout_path</strong>,
etc, where <strong>stdin_path</strong> and <strong>stdout_path</strong> are names of
files containing input and output.  However some versions of
multiprocessor job launching do not support such redirection.  An
alternative is provided, which allows naming the files explicitly on
the command line.  The first name is always standard input.  The
second, if specified, is standard output, etc.
</p>
<a name="index-mesh-view"></a>

<p>On a switch-based machine, usually the assignment of sublattices to
processors makes little difference to job performance, so the division
is done automatically by the code.  On a mesh network performance is
sometimes helped by controlling the subdivision.  The
<strong>qmp-geom</strong> option or <strong>geom</strong> option
</p><table><tr><td>&nbsp;</td><td><pre class="example">  -qmp-geom mx my mz mt
</pre></td></tr></table>
<p>specifies the dimensions of a grid of processors.  The product must
equal the number of allocated processors and the grid dimensions must
separately be divisors of the corresponding lattice dimensions.  The
same effect is accomplished in some applications by the
<strong>node_geometry</strong> parameter.  If both specifications are used,
the command-line option takes precedence.
</p>
<a name="index-multijob-operation"></a>

<p>In some operating environments it may be desirable to run multiple,
independent jobs on the same machine within a single queued job
submission.  The jobs are independent in the sense that each has its
own standard input and standard output, but each executes the same
binary.  The <strong>qmp-jobs</strong> or <strong>jobs</strong> option controls the
partitioning of the allocated processors.  This option takes one or
four integers, depending on whether you are using a switch view or a
mesh view of the machine, respectively.  With a single integer
</p><table><tr><td>&nbsp;</td><td><pre class="example">  -qmp-jobs n
</pre></td></tr></table>
<p>the allocated processors are divided into <strong>n</strong> equal sets of
processors.  Thus <strong>n</strong> must be a divisor of the number of
allocated processors.  With four parameters
</p><table><tr><td>&nbsp;</td><td><pre class="example">  -qmp-jobs jx jy jz jt
</pre></td></tr></table>
<p>the mesh with dimensions mx, my, mz, mt is subdivided.  Each integer
ji must be a divisor of mi.  The number of independent jobs is the
product n = jx * jy * jz * jt.
</p>
<p>Under multijob operation it is necessary to distinguish the sets of
files for separate jobs.  Therefore, arguments <strong>stdin_path</strong>,
<strong>stdout_path</strong>, and <strong>stderr_path</strong> are required.  They are
taken to be the stems of the actual file names.  Each job is assigned
a two-digit sequence number nn as in 00, 01, 02, ... 99.  (It is
assumed that there will not be more than 100 such jobs.) The full file
names have the format
</p><table><tr><td>&nbsp;</td><td><pre class="example">   stdin_path.jnn  stdout_path.jnn  stderr_path.jnn
</pre></td></tr></table>
<p>where <strong>nn</strong> is the sequence number of the job.  In this way each
job has its unique set of files.
</p>
<hr size="6">
<a name="General-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Command-line-options" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Directory-Layout" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Command-line-options" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="General-description-1"></a>
<h1 class="chapter">4. General description</h1>
<a name="index-General-description-of-the-MILC-Code"></a>

<a name="index-MILC-Collaboration"></a>
<p><strong>The MILC Code</strong> is a set of codes written in C developed by the MIMD
Lattice Computation (MILC) collaboration for doing simulations of four
dimensional SU(3) lattice gauge theory on MIMD parallel machines.
The MILC Code is publicly available for research purposes. Publications of work
done using this code or derivatives of this code should acknowledge this
use. <a href="#Usage-conditions">Usage conditions</a>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Directory-Layout">4.1 Directory Layout</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Precision">4.3 Precision</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Directory-Layout"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#General-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Overview-of-applications" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#General-description" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Directory-Layout-1"></a>
<h2 class="section">4.1 Directory Layout</h2>
<a name="index-Directory-Layout"></a>

<p>In the top-level directory there are six categories of subdirectories:
&ldquo;applications,&rdquo; &ldquo;generic,&rdquo; &ldquo;include,&rdquo; &ldquo;libraries,&rdquo; &ldquo;doc,&rdquo;
and &ldquo;file_utilities.&rdquo;
</p>
<a name="index-libraries"></a>
<p>Each <strong>application</strong>, or major research project, has
its own directory. Examples of applications are <strong>ks_imp_dyn</strong>
(dynamical simulations with a variety of staggered fermion actions)
and <strong>clover_invert2</strong> (clover Dirac operator inversion and
spectroscopy). All applications share the <strong>libraries</strong> directory
containing low-level linear algebra routines, the <strong>include</strong>
directory containing header files shared by all applications, the
<strong>generic</strong> directory containing high level routines that is more
or less independent of the physics, and a set of slightly more
specific <strong>generic_XXX</strong> directories. Examples of
<strong>generic</strong> code are the random number routines, the layout
routines for distributing lattice sites across the machine, and
routines to evaluate the plaquette or Polyakov loop.  The <strong>doc</strong>
directory contains documentation and the <strong>file_utilities</strong>
directory contains some code for manipulating files, including a code
(check_gauge) for doing some consistency checking of a gauge
configuration file and a code (v5_to_scidac) for converting MILC
formatted lattices to SciDAC or ILDG format.
</p>
<p>Each application usually has several variants that appear as separate
targets in the make file.  For example, the <strong>ks_imp_dyn</strong>
application can be compiled for hybrid Monte Carlo updating (su3_hmc)
or the R algorithm (su3_rmd).  All application directories have
separate sample input and output files for each target, labelled with
the name of the target: for example &quot;test/su3_hmc.1.sample-in&quot;, etc., and a
corresponding output file &quot;su3_hmc.1.sample-out&quot;, etc.)  The numbers
<strong>1</strong> and <strong>2</strong> refer to single and double precision.
</p>
<p>You may unpack supporting code only for a specific application or you
may unpack the entire code.  The entire code consists of at least the
following directories.  
(see section <a href="#Building-the-MILC-Code">Building the MILC Code</a>)
</p>
<br>
<p align="center"> <em>SUPPORT ROUTINES</em>
</p><dl compact="compact">
<dt> <strong>libraries:</strong></dt>
<dd><p>Single processor linear algebra routines.  After building the code the
following libraries appear:
</p><ul>
<li> complex.1.a and complex.2.a

<p>Library of routines for complex numbers.
</p>
</li><li> su3.1.a and su3.2.a

<p>Library of routines for SU(3) matrix and vector operations.
</p>
</li></ul>
</dd>
<dt> <strong>include:</strong></dt>
<dd><p>We list only some of the major headers here.
</p>
<ul>
<li> config.h

<p>Specification of processor configuration and operating system environment.
</p>
</li><li> complex.h

<p>Header file of definitions and macros for complex numbers.
</p>
</li><li> comdefs.h

<p>Header files for communications
</p>
</li><li> dirs.h

<p>Defines some standard macros for lattice directions.
</p>
</li><li> gammatypes.h

<p>Gamma matrix definitions.
</p>
</li><li> generic_XXX.h

<p>Header files and declarations for routines in directory generic_XXX
</p>
</li><li> io_ksprop.h

<p>Prototypes and definitions for staggered fermion I/O routines.
</p>
</li><li> io_lat.h

<p>Header file for routines for reading and writing lattices (the routines
are in <kbd>generic</kbd>)
</p>
</li><li> io_scidac.h

<p>Prototypes and definitions for generic SciDAC I/O routines.
</p>
</li><li> io_wprop.h

<p>Prototypes and definitions for Dirac fermion I/O routines.
</p>
</li><li> macros.h

<p>Definitions required in all applications: field offsets, field pointers,
looping over variables...
</p>
</li><li> prefetch.h prefetch_asm.h

<p>Header files defining subroutine or macro calls for cache preloading.
</p>
</li><li> random.h

<p>Definition of structure for random number state.
</p>
</li><li> su3.h

<p>Header file of definitions and macros for SU(3) matrix and fermion
operations.
</p>
</li></ul>
</dd>
<dt> <strong>generic:</strong></dt>
<dd><p>    Procedures common to most applications, such as communications,
    I/O, data layout, and field remapping.
</p>
</dd>
<dt> <strong>generic_XXX:</strong></dt>
<dd><p>    Procedures common to a subset of applications, including
    inverters and link fattening.
    Presently &ldquo;XXX&rdquo; includes 
   generic_clover, generic_form, generic_ks, generic_pg, generic_schroed, 
   and generic_wilson.
</p>
</dd>
</dl>

<hr size="6">
<a name="Overview-of-applications"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Directory-Layout" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Precision" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#General-description" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Overview-of-Applications"></a>
<h2 class="section">4.2 Overview of Applications</h2>
<a name="index-Overview-of-Applications-in-Release-Version"></a>
<dl compact="compact">
<dt> <strong>arb_overlap:</strong></dt>
<dd><p>      Computes eigenvalues and eigenvectors of the overlap operator.
</p>
</dd>
<dt> <strong>clover_dynamical:</strong></dt>
<dd><p>	Simulations with dynamical clover fermions.  Variants
	include the &quot;R&quot;, &quot;phi&quot; and hybrid Monte Carlo updating
	algorithms. 
</p>
</dd>
<dt> <strong>clover_invert2:</strong></dt>
<dd><p>      Inversion of the clover fermion matrix (conjugate gradient,
      MR, and BiCG algorithms) and measurements with clover or staggered
      quarks.  A wide variety of sources are supported. Lattices are
      supposed to be generated by someone else.
</p>
</dd>
<dt> <strong>ext_src:</strong></dt>
<dd><p>       Generates an extended source from a staggered or clover
       propagator.
</p>
</dd>
<dt> <strong>file_utilities</strong></dt>
<dd><p>       A variety of utilities for converting lattice file formats, running
       a checksum of a gauge file, and  comparing some binary files.
</p>
</dd>
<dt> <strong>gauge_utilities</strong></dt>
<dd><p>       A variety of utilities for manipulating the gauge field, including
       coordinate translations, gauge fixing, and boundary twists.
</p>
</dd>
<dt> <strong>gluon_prop:</strong></dt>
<dd><p>       Gluon and quark propagators.
</p>
</dd>
<dt> <strong>hvy_qpot:</strong></dt>
<dd><p>       Measures static quark potential as a function of separation.
       Also a variety of Wilson loops.
</p>
</dd>
<dt> <strong>ks_eigen</strong></dt>
<dd><p>       Compute eigenvalues of the staggered Dirac matrix using the
       Kalkreuter Rayleigh-Ritz method.
</p>
</dd>
<dt> <strong>ks_imp_dyn:</strong></dt>
<dd><a name="index-Asqtad-action"></a>
<p>	Simulations with dynamical staggered (Kogut-Susskind) 
        fermions.  There are a variety of possible actions, including
        the original unimproved Kogut-Susskind action and the
        asqtad action.  One may choose a single degenerate mass or two
        different masses. Make targets
	include the &quot;R&quot;, &quot;phi&quot; and hybrid Monte Carlo updating
	algorithms.  Measurements of a few quantities are included: 
        plaquette, Polyakov loop,
<!-- MATH
 $<\psi\bar\psi>$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="60" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_12.png"
 ALT="$&lt;\psi\bar\psi&gt;$"></SPAN>
</p>
</dd>
<dt> <strong>ks_imp_rhmc:</strong></dt>
<dd><a name="index-rational-function"></a>
<a name="index-RHMC"></a>
<a name="index-HISQ"></a>
<p>        Dynamical RHMC code for staggered fermions.  In addition to
        a variety of staggered actions, the highly-improved-staggered-quark
        (HISQ) action is also supported.  A subdirectory <strong>remez-milc</strong>
        contains a utility for generating parameters of the rational functions
        needed by the RHMC codes.
</p>
</dd>
<dt> <strong>ks_imp_utilities:</strong></dt>
<dd><p>      Test code for the staggered fermion force and staggered inverter.
</p>
</dd>
<dt> <strong>ks_measure:</strong></dt>
<dd><p>      Calculate <!-- MATH
 $<\psi\bar\psi>$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="60" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_12.png"
 ALT="$&lt;\psi\bar\psi&gt;$"></SPAN>
     and a wide variety of quantities used in staggered
     thermodynamics, for the equation of state and quark number
      susceptibilities at zero and nonzero chemical potential
</p>
</dd>
<dt> <strong>ks_spectrum</strong></dt>
<dd><p>      Inversion of the staggered fermion matrix for asqtad and HISQ actions
      and measurements of correlators. A wide variety of sources are supported.
      Lattices are supposed to be generated by someone else.
</p>
</dd>
<dt> <strong>pure_gauge:</strong></dt>
<dd><p>      Simulation of the unimproved pure gauge theory, using
      microcanonical overrelaxed and quasi-heat bath, or hybrid Monte Carlo
      algorithms. Not much is measured.
</p>
</dd>
<dt> <strong>schroed_cl_inv:</strong></dt>
<dd><p>      Schroedinger functional code for clover quarks.
</p>
</dd>
<dt> <strong>smooth_inst:</strong></dt>
<dd><p>      Compute topological charge with smearing.
</p>
</dd>
<dt> <strong>symanzik_sl32</strong></dt>
<dd><p>      Pure gauge Monte Carlo for an arbitrary hypercubic action, including
      the improved gauge actions.
</p>
</dd>
</dl>

<p>The top level directory contains a &lsquo;<tt>README</tt>&rsquo; file with specific information
on how to <kbd>make</kbd> an application code (see section <a href="#Building-the-MILC-Code">Building the MILC Code</a>).
</p>
<hr size="6">
<a name="Precision"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Overview-of-applications" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Optional-Compilation-Macros" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#General-description" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Precision-1"></a>
<h2 class="section">4.3 Precision</h2>
<a name="index-Precision"></a>
<a name="index-Compilation-Macros"></a>
<a name="index-Mixed-Precision"></a>

<p>The MILC code can be compiled in single precision or double precision,
depending on whether the make macro <strong>PRECISION</strong> is set to
<strong>1</strong> or <strong>2</strong>.  You do this by editing the
<strong>Makefile</strong>.  The effect of this setting is global for the
entire compilation.  All of the MILC floating types are set to either
single or double precision types.
</p>
<p>An exception to the global precision rule is that gauge configuration
and propagator files are always written in single precision.
</p>
<p>For some applications compiled with SciDAC QOPQDP, the code now
supports mixed precision computation.  That is, you may set a global
precision with the <strong>PRECISION</strong> macro, but some applications
accept a run-time selection that allows some supporting calculations
to be done with a different precision.  This has proven to be
efficient for molecular dynamics evolution in which the fermion force
calculation can be done in single precision, but the gauge field
updating is then done in double precision.
</p>

<hr size="6">
<a name="Optional-Compilation-Macros"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Precision" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#General-description" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-description" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Optional-Compilation-Macros-1"></a>
<h2 class="section">4.4 Optional Compilation Macros</h2>
<a name="index-Macros_002c-Optional"></a>
<a name="index-Compilation-Macros-1"></a>

<p>We list some macros affecting compilation of various sections of the
code that may be defined by user option.  Most of these macros are
described with comments in the generic <strong>Makefile</strong>.  
</p>
<p>Some application-specific macros are defined in the application file
<strong>Make_template</strong>. Finally, in the application
<strong>Make_template</strong> files some choices are exercised by selecting
one of a few interchangeable object files.  Look for comments in those
files.
</p>
<p>Note that there are both <strong>make</strong> macros and compiler macros in
this list.  The compiler macros in this list are distinguished by the
compiler flag <strong>-D</strong>.
</p>
<dl compact="compact">
<dt> <strong>SciDAC package options</strong></dt>
<dd><ul>
<li> WANTQOP
<a name="index-QOP"></a>
   Use optimized QOPQDP routines.  The choices are <strong>true</strong> to
   get this option and blank (nothing) to use the native MILC versions
   instead.

</li><li> WANTQIO
<a name="index-QIO"></a>
    The choices are <strong>true</strong> and blank (nothing).  Enables
reading and writing of SciDAC (QIO/LIME) formatted files.  This option
is necessary for writing staggered and clover propagators.

</li><li> WANTQMP
<a name="index-QMP"></a>
    The choices are <strong>true</strong> and blank (nothing).  Causes
communication to take place through QMP calls.  Then, depending on
which QMP library you link with the code, you may get an
architecture-specific implementation or a generic MPI implementation.

</li></ul>

</dd>
<dt> <strong>GPU package options</strong></dt>
<dd>
<p>The code includes development-grade support for GPU computations,
currently only for single-GPU operation, but multi-GPU operation is
planned.  The QUDA package is required.  All the basic modules for
staggered fermion molecular dynamics evolution and spectroscopy are
provided.
</p>
<ul>
<li> USE_CG_GPU
<a name="index-GPU-staggered-conjugate-gradient"></a>

</li><li> USE_FL_GPU
<a name="index-GPU-fat-link-construction"></a>

</li><li> USE_REUNIT_GPU
<a name="index-GPU-reunitarization"></a>
  This step is used for constructing HISQ links.

</li><li> USE_FF_GPU
<a name="index-GPU-staggered-fermion-force"></a>

</li><li> USE_GF_GPU
<a name="index-GPU-gauge-force"></a>

</li></ul>

</dd>
<dt> <strong>Inlining</strong></dt>
<dd><a name="index-Inlining"></a>

<p>    Some of the MILC library routines can be invoked through inline
C-coded macros.  This method avoids the overhead cost of a procedure
call, but increases the size of the compiled code somewhat.  It is
usually a good idea.  Some processors have an SSE instruction set.  In
the interest of efficient computation on those architectures, some
library routines are available as inline SSE assembly code.  Inline
assembly code can be interpreted by some compilers (gcc).  Before
trying them, you might see whether the chosen compiler doesn&rsquo;t already
have an option that accesses this instruction set.  Both sets of
inline macros can be invoked globally in the computation or
selectively.  &ldquo;Globally&rdquo; means that every procedure call throughout
the code is inlined.  &ldquo;Selectively&rdquo; means only some of the procedure
calls are inlined.  To obtain the latter result, you have to edit the
code by hand, in each procedure call, changing the procedure name to
its corresponding macro name.
</p>
<p>The macros that invoke these inline codes are as follows
</p>
<ul>
<li> -DC_GLOBAL_INLINE
     Invokes C-inline versions of library routines as available.

</li><li> -DSSE_GLOBAL_INLINE
     Invokes SSE assembly-coded inline versions of library routines as
available.  Where both C and SSE assembly versions are available, the
SSE version takes precedence.

</li><li> -DC_INLINE
     Invoke C-inline versions selectively.  You then must edit the code to 
get just the routines you want.

</li><li> -DSSE_INLINE
<a name="index-SSE"></a>
     Invoke SSE assembly-coded inline versions selectively.  You then must 
edit the code to get just the routines you want.

</li></ul>

</dd>
<dt> <strong>Timing, profiling, and debugging</strong></dt>
<dd><a name="index-Timing"></a>
<a name="index-Profiling"></a>
<a name="index-Debugging"></a>

<ul>
<li> -DCGTIME
   Print timing information for the conjugate gradient solvers.

</li><li> -DFFTIME
   Print timing information for the staggered fermion force routines.

</li><li> -DFLTIME
   Print timing information for the staggered link fattening routines.

</li><li> -DGFTIME
   Print timing information for the gauge force routines.

</li><li> -DIOTIME
   Print timing information for I/O routines.

</li><li> -DPRTIME
   Print timing information for various computational steps. (Some applications.)

</li><li> -DREMAP
   In some applications it is necessary to remap data in lattice fields
   because of different layout conventions.  This macro gives code that prints
   timing information for such remapping.

</li><li> -DQDP_PROFILE
   Print profiling information for QDP/C routines.

</li><li> -DCOM_CRC
   Do checksums on all gather operations.  Slows performance somewhat.

</li><li> -DCHECK_MALLOC
   Mainly for developers for analyzing heap utilization.  In
conjunction with the script <strong>check_malloc.pl</strong>, checks the
consistency of all malloc/free activity.  (Produces voluminous
output.)

</li><li> -DCG_DEBUG
   Show detailed progress of the conjugate gradient solver.

</li><li> -DCG_OK
   Print summary information about the conjugate gradient solver.

</li></ul>

</dd>
<dt> <strong>Grid layout</strong></dt>
<dd><a name="index-Layout"></a>
<a name="index-qmp_002dgeom-1"></a>

<p>   The layout subroutines normally decide which processor memory gets
which lattice sites.  The &lsquo;<tt>layout_hyper_prime</tt>&rsquo; routine does this
by dividing the lattice into hypercubes.  This is a natural concept
for grid-based communication networks, but it is also used in
switch-based networks.  A few applications in the code now allow you
to control the geometry by hand with the <strong>FIX_NODE_GEOM</strong> macro.
If you compile with the SciDAC QMP pacakage in any application, the
same control is achieved through the <strong>-qmp-geom</strong> command-line
option.
</p>
<p>The SciDAC QIO utilities support parallel I/O through I/O partitions.
That is, for the purpose of I/O the processors are divided into
disjoint subsets called I/O partitions.  In each partition there is
one processor designated for I/O.  It works with its own exclusive
file and distributes/collects data from sites within its I/O
partition.  The QIO suite also contains scalar processor code for
converting files from partitioned format to single-file format and
back.  A few applications in the code now support this feature,
enabled through the <strong>FIX_IONODE_GEOM</strong> macro.  The I/O
partitions are created as hypercubes in the space of nodes
(processors).  Since the layout of the I/O partitions must be
commensurate with the hypercubic organization of the processors, we
require fixing the node geometry with <strong>FIX_NODE_GEOM</strong> when
using I/O partitions.
</p>
<ul>
<li> -DFIX_NODE_GEOM

<p>   For some applications only.  Provide for specifying the x, y, z,
and t dimensions of the processors, viewing the allocated machine as a
4D grid of processors.
</p>   
</li><li> -DFIX_IONODE_GEOM
<a name="index-I_002fO-partitions"></a>

<p>   For some applications only.  Provide for specifying the x, y, z,
and t dimensions of the I/O partitions.
</p>
</li></ul>

</dd>
<dt> <strong>Staggered CG inverter and Dslash optimizations</strong></dt>
<dd><a name="index-Optimization"></a>

<ul>
<li> -DDBLSTORE_FN

<p>    Double store backward links to optimize Dslash.  Uses more memory.
</p>
</li><li> -DD_FN_GATHER13

<p>    For staggered Fat-Naik actions.  Assume that the next neighbor is
gathered when the third neighbor is gathered.  This is always the case
in hypercubic layouts when the local sublattice dimensions are three
or more.  If the layout is incompatible with this option, the code
halts.
</p>
</li><li> -DFEWSUMS

<p>   Pair up global sums in the conjugate gradient algorithm to save global
   reduction time.
</p>
</li></ul>

</dd>
<dt> <strong>Multimass CG solvers</strong></dt>
<dd><a name="index-Conjugate-gradient-_002d-multimass"></a>

<p>   There are a variety of options for doing multimass CG solves, some
of them experimental and debugging.  This list will be pruned in future
versions.
</p>
<ul>
<li> -DKS_MULTICG=HYBRID

<p>    Solve with multimass and polish each solution with single-mass CG.
    Good for reliability.
</p>
</li><li> -DKS_MULTICG=FAKE

<p>    Solve by iterating through the single-mass solver.  For debugging.
</p>
</li></ul>


</dd>
<dt> <strong>Multifermion force routines</strong></dt>
<dd><a name="index-Fermion-force-_0028multiple_0029"></a>

<p>   There are a variety of options for computing the multimass fermion
force needed for the RHMC algorithm.
</p>
<ul>
<li> -DKS_MULTIFF=FNMAT

<p>    First sum the outer products of the sources and work with matrix
parallel transporters.  This method is generally more efficient.
</p>
</li><li> -DKS_MULTIFF=FNMATREV

<p>    Traverses the path in reverse order.
</p>
</li><li> -DKS_MULTIFF=ASVEC

<p>    Do parallel transport of the list of source vectors, rather than
parallel transporting a matrix.  The <strong>-DVECLENGTH=n</strong> macro sets
the maximum number of source vectors processed at a time.  The fermion
force routine is then called as many times as needed to process them
all.  For HISQ actions, the only option is <strong>FNMAT</strong>.
</p>
</li></ul>

</dd>
<dt> <strong>RHMC molecular dynamics algorithms</strong></dt>
<dd><a name="index-RHMC-1"></a>

<p>   These macros control only the RHMC molecular dynamics algorithms.
They determine the integration algorithm and the relative frequency of
gauge and fermion field updates.
</p>
<ul>
<li> -DINT_ALG=INT_LEAPFROG
</li><li> -DINT_ALG=INT_LEAPFROG
</li><li> -DINT_ALG=INT_OMELYAN
</li><li> -DINT_ALG=INT_2EPS_3TO1
</li><li> -DINT_ALG=INT_2EPS_2TO1
</li><li> -DINT_ALG=INT_2G1F
</li><li> -DINT_ALG=INT_3G1F
</li><li> -DINT_ALG=INT_4MN4FP
</li><li> -DINT_ALG=INT_4MN5FV
</li><li> -DINT_ALG=INT_FOURSTEP
</li><li> -DINT_ALG=INT_PLAY

</li></ul>


</dd>
<dt> <strong>Dirac (clover) inverter choices</strong></dt>
<dd><a name="index-Dirac-inverter"></a>
<a name="index-Clover-inverter"></a>

<p>  There are a variety of Dirac (clover) solvers
</p>
<ul>
<li> -DCL_CG=BICG  Biconjugate gradient
</li><li> -DCL_CG=CG    Standard CG
</li><li> -DCL_CG=MR    Minimum residue
</li><li> -DCL_CG=HOP   Hopping

</li></ul>

</dd>
</dl>

<hr size="6">
<a name="Programming-with-MILC-Code"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Optional-Compilation-Macros" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Header-files" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#General-description" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Programming-with-MILC-Code-1"></a>
<h1 class="chapter">5. Programming with MILC Code</h1>
<a name="index-Programming-with-MILC-Code"></a>


<p>These notes document some of the features of the MILC QCD code.  They
are intended to help people understand the basic philosophy and
structure of the code, and to outline how one would modify existing
applications for a new project.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Header-files">5.1 Header files</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Global-variables">5.2 Global variables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Data-types">5.4 Data types</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Library-routines">5.5 Library routines</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Accessing-fields-at-other-sites">5.7 Accessing fields at other sites</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Distributing-sites-among-nodes">5.9 Distributing sites among nodes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Reading-and-Writing-Lattices-and-Propagators">5.10 Reading and writing lattices and propagators</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Random-numbers">5.11 Random numbers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#A-Sample-Applications-Directory">5.12 A Sample Applications Directory</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Bugs-and-features">5.13 Bugs and features</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Header-files"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Global-variables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Header-files-1"></a>
<h2 class="section">5.1 Header files</h2>
<a name="index-header-files"></a>

<p>Various header files define structures, macros, and global
variables.  The minimal set at the moment is:
<a name="index-config_002eh"></a>
<a name="index-comdefs_002eh"></a>
<a name="index-complex_002eh"></a>
<a name="index-defines_002eh"></a>
<a name="index-dirs_002eh"></a>
<a name="index-io_005flat_002eh"></a>
<a name="index-lattice_002eh"></a>
<a name="index-macros_002eh"></a>
<a name="index-params_002eh"></a>
<a name="index-su3_002eh"></a>
</p>
<dl compact="compact">
<dt> &lsquo;<tt>config.h</tt>&rsquo;</dt>
<dd><p>specifies processor and operating-system-dependent macros
</p>
</dd>
<dt> &lsquo;<tt>comdefs.h</tt>&rsquo; </dt>
<dd><p>macros and defines for communication routines (see section <a href="#Library-routines">Library routines</a>).
</p>
</dd>
<dt> &lsquo;<tt>complex.h</tt>&rsquo;	</dt>
<dd><p>declarations for complex arithmetic (see section <a href="#Library-routines">Library routines</a>).
</p>
</dd>
<dt> &lsquo;<tt>defines.h</tt>&rsquo;</dt>
<dd><p>defines macros specific to an application.  Macros that are
independent of the site structure can also be defined here.  Compiler
macros common to all targets are also defined here.
</p>
</dd>
<dt> &lsquo;<tt>dirs.h</tt>&rsquo;</dt>
<dd><p>defines macros specifying lattice directions
</p>
</dd>
<dt> &lsquo;<tt>lattice.h</tt>&rsquo;</dt>
<dd><p>defines lattice fields and global variables specific to an
application, found in applications directories
</p>
</dd>
<dt> &lsquo;<tt>macros.h</tt>&rsquo;</dt>
<dd><p>miscellaneous macros including loop control
</p>
</dd>
<dt> &lsquo;<tt>params.h</tt>&rsquo;</dt>
<dd><p>defines the parameter structure for holding parameter values read from
standard input, such as the lattice size, number of iterations, etc.
</p>
</dd>
<dt> &lsquo;<tt>su3.h</tt>&rsquo; </dt>
<dd><p>declarations for SU(3) operations, eg. matrix multiply (see section <a href="#Library-routines">Library routines</a>).
</p>
</dd>
</dl>

<p>The <strong>lattice.h</strong> file is special to an application directory.
It defines the site structure (fields) for the lattice. The files
<strong>defines.h</strong> and <strong>params.h</strong> are also peculiar to an
application directory.  The other header files are stored in the
<strong>include</strong> directory and not changed.
</p>
<a name="index-Include-files_002e"></a>

<p>The local header <strong>defines.h</strong> must be included near the top of the <strong>lattice.h</strong> file.  Other headers, of course, should be
included to declare data types appearing in the <strong>lattice.h</strong>
file.
</p>
<a name="index-EXTERN"></a>
<a name="index-CONTROL"></a>
<p>In C global variables must be defined as &ldquo;extern&rdquo; in all but one of
the compilation units.  To make this happen with global variables in
<strong>lattice.h</strong>, we use the macro prefix <kbd>EXTERN</kbd>.  The macro
is normally defined as &quot;extern&quot;, but when the macro <kbd>CONTROL</kbd> is
defined, <kbd>EXTERN</kbd> becomes null. The effect is to reserve storage
in whichever file <kbd>CONTROL</kbd> is defined.  We do this typically [qin
the file containing the <em>main()</em> program, which is typically part
of a file with a name like <kbd>control.c</kbd>. (C++ would fix this
nonsense).
</p>
<hr size="6">
<a name="Global-variables"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Header-files" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lattice-storage" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Global-variables-1"></a>
<h2 class="section">5.2 Global variables</h2>
<a name="index-Global-variables"></a>

<a name="index-beta"></a>
<a name="index-epsilon"></a>
<a name="index-even_005fsites_005fon_005fnode"></a>
<a name="index-fixflag"></a>
<a name="index-iseed"></a>
<a name="index-mass"></a>
<a name="index-nflavors"></a>
<a name="index-nflavors1_002c-nflavors2"></a>
<a name="index-number_005fof_005fnodes"></a>
<a name="index-nx_002cny_002cnz_002cnt"></a>
<a name="index-odd_005fsites_005fon_005fnode"></a>
<a name="index-saveflag"></a>
<a name="index-_002asavefile"></a>
<a name="index-saveflag-1"></a>
<a name="index-_002astartfile"></a>
<a name="index-sites_005fon_005fnode"></a>
<a name="index-startflag"></a>
<a name="index-steps"></a>
<a name="index-this_005fnode"></a>
<a name="index-total_005fiters"></a>
<a name="index-trajecs"></a>
<a name="index-volume"></a>
<a name="index-warms"></a>
<p>A number of global variables are typically available.  Most of them are
declared in &lsquo;<tt>lattice.h</tt>&rsquo;. Unless specified, these variables are
initialized in the function <kbd>initial_set()</kbd>.  Most of them take
values from a parameter input file at run time.
</p>
<dl compact="compact">
<dt> <kbd>int nx,ny,nz,nt</kbd></dt>
<dd><p>lattice dimensions
</p></dd>
<dt> <kbd>int volume</kbd></dt>
<dd><p>volume = nx * ny * nz * nt
</p></dd>
<dt> <kbd>int iseed</kbd></dt>
<dd><p>random number seed
</p></dd>
</dl>

<p>Other variables are used to keep track of the relation between sites of the
lattice and nodes:
</p><dl compact="compact">
<dt> <kbd>int this_node</kbd></dt>
<dd><p>number of this node
</p></dd>
<dt> <kbd>int number_of_nodes</kbd></dt>
<dd><p>number of nodes in use
</p></dd>
<dt> <kbd>int sites_on_node</kbd>	</dt>
<dd><p>number of sites on this node. [<em>This variable is set in:</em>
<kbd>setup_layout()</kbd>]
</p></dd>
<dt> <kbd>int even_sites_on_node</kbd></dt>
<dd><p>number of evensites on this node. [<em>This variable is set in:</em>
<kbd>setup_layout()</kbd>]
</p></dd>
<dt> <kbd>int odd_sites_on_node</kbd></dt>
<dd><p>number of odd sites on this node. [<em>This variable is set in:</em>
<kbd>setup_layout()</kbd>]
</p></dd>
</dl>


<a name="index-setup_002ec"></a>
<a name="index-params"></a>
<p>Other variables are not fundamental to the layout of the
lattice but vary from application to application. These dynamical
variables are part of a <kbd>params</kbd> struct, defined in the required
header <a name="index-params_002eh_002c-which-is-passed-between-nodes-by"></a>
<kbd>initial_set()</kbd> in &lsquo;<tt>setup.c</tt>&rsquo; For example, a pure gauge
simulation might have a <kbd>params</kbd> struct like this:
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* structure for passing simulation parameters to each node */
typedef struct {
        int nx,ny,nz,nt;  /* lattice dimensions */
        int iseed;      /* for random numbers */
        int warms;      /* the number of warmup trajectories */
        int trajecs;    /* the number of real trajectories */
        int steps;      /* number of steps for updating */
        int stepsQ;     /* number of steps for quasi-heatbath */
        int propinterval;  /* number of trajectories between measurements */
        int startflag;  /* what to do for beginning lattice */
        int fixflag;    /* whether to gauge fix */
        int saveflag;   /* what to do with lattice at end */
        float beta;     /* gauge coupling */
        float epsilon;  /* time step */
        char startfile[80],savefile[80];
} params; 
</pre></td></tr></table>
<p>These run-time variables are usually loaded by a loop over
<kbd>readin()</kbd> defined in &lsquo;<tt>setup.c</tt>&rsquo;.
</p>

<hr size="6">
<a name="Lattice-storage"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Global-variables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-types" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Lattice-storage-1"></a>
<h2 class="section">5.3 Lattice storage</h2>
<a name="index-Lattice-storage"></a>
<a name="index-site"></a>
<a name="index-site-1"></a>
<a name="index-lattice_005b_005d"></a>

<p>The original MILC code put all of the application variables that live
on a lattice site in a huge structure called the &ldquo;site&rdquo; structure.
The <kbd>lattice</kbd> variable was then an array of <kbd>site</kbd> objects.
We call this data structure&ldquo;site major&rdquo; order.  Experience has shown
that it is usually better for cache coherence to store each lattice
field in its own separate linear array.  We call this &ldquo;field major&rdquo;
order.  Thus we are in the process of dismantling the site structure
in each application.  Eventually all fields will be stored in
field-major order.  In the transitional phase most utilities in the
code support both data structures.
</p>
<p>The <kbd>site</kbd> structure is defined in &lsquo;<tt>lattice.h</tt>&rsquo; (see section <a href="#Header-files">Header files</a>). Each <em>node</em> of the parallel machine has an array of such
structures called <kbd>lattice</kbd>, with as many elements as there are
sites on the <em>node</em>.  In scalar mode there is only one
<em>node</em>.  The <kbd>site</kbd> structure looks like this:
</p><table><tr><td>&nbsp;</td><td><pre class="example">typedef struct {
    /* The first part is standard to all programs */
        /* coordinates of this site */
        short x,y,z,t;
        /* is it even or odd? */
        char parity;
        /* my index in the lattice array */
        int index;

    /* Now come the physical fields, application dependent. We will 
       add or delete whatever we need. This is just an example. */
        /* gauge field */
        su3_matrix link[4];

        /* antihermitian momentum matrices in each direction */
         anti_hermitmat mom[4];

         su3_vector phi; /* Gaussian random source vector */ 
} site; 
</pre></td></tr></table>

<p>At run time space for the lattice sites is allocated dynamically,
typically as an array <kbd>lattice[i]</kbd>, each element of which is a site
structure.  Thus, to refer to the <kbd>phi</kbd> field on a particular
lattice site, site &quot;<kbd>i</kbd>&quot; on this node, you say
</p><table><tr><td>&nbsp;</td><td><pre class="example">   lattice[i].phi,
</pre></td></tr></table>
<p>and for the real part of color 0
</p><table><tr><td>&nbsp;</td><td><pre class="example">   lattice[i].phi.c[0].real,
</pre></td></tr></table>
<p>etc. You usually won&rsquo;t need to know the relation between the index
<kbd>i</kbd> and a the location of a particular site (but see
 (see section <a href="#Distributing-sites-among-nodes">Distributing sites among nodes</a> for how to figure out
the index <kbd>i</kbd>). 
</p>
<p>In general, looping over sites is done using a pointer to the
 site, and then you would
refer to the field as:
</p><table><tr><td>&nbsp;</td><td><pre class="example">site *s; ...  
/* s gets set to &amp;(lattice[i]) */ 
s-&gt;phi
</pre></td></tr></table>

<p>The coordinate, parity and index fields are used by the gather routines
and other utility routines, so it is probably a bad idea to alter
them unless you want to change a lot of things.  Other data can be
added or deleted with abandon.
</p>
<p>The routine <kbd>generic/make_lattice()</kbd> is called from <kbd>setup()</kbd> to
allocate the lattice on each node.
</p>
<a name="index-neighbor_005b_005d"></a>
<p>In addition to the fields in the <kbd>site</kbd> structure, there are two
sets of vectors whose elements correspond to lattice sites. 
They are hidden in the communications routines and you are likely never to
encounter them. These are
the eight vectors of integers:
</p><table><tr><td>&nbsp;</td><td><pre class="example">int *neighbor[MAX_GATHERS]
</pre></td></tr></table>
<p><kbd>neighbor[XDOWN][i]</kbd> is the index of the site in the <strong>XDOWN</strong>
direction from the i&rsquo;th site on the
node, if that site is on the same node. If the neighboring site is on
another node, this pointer will be <strong>NOT_HERE (= -1)</strong>. These
vectors are mostly used by the gather routines.
</p>
<a name="index-gen_005fpt_005b_005d"></a>
<p>There are a number of important vectors of pointers used for accessing
fields at other (usually neighboring) neighboring sites,
</p><table><tr><td>&nbsp;</td><td><pre class="example">char **gen_pt[MAX_GATHERS]
</pre></td></tr></table>
<p>These vectors of pointers are declared in &lsquo;<tt>lattice.h</tt>&rsquo; and allocated
in <kbd>generic/make_lattice()</kbd>. They are filled by the gather routines,
<kbd>start_gather()</kbd> and <kbd>start_general_gather()</kbd>, with pointers to
the gathered field. See section <a href="#Accessing-fields-at-other-sites">Accessing fields at other sites</a>.  You use one
of these pointer vectors for each simultaneous gather you have going.
</p>

<p>This storage scheme seems to allow the easiest coding, and likely the
fastest performance.  It certainly makes gathers about as easy as
possible.  However, it is somewhat wasteful of memory, since all
fields are statically allocated.  Also, there is no mechanism for
defining a field on only even or odd sites.
</p>
<hr size="6">
<a name="Data-types"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Lattice-storage" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Library-routines" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Data-types-1"></a>
<h2 class="section">5.4 Data types</h2>
<a name="index-Data-types"></a>

<p>Various data structures have been defined for QCD computations, which
we now list.   You may define new ones if you wish.
In names of members of structure, we  use the following conventions:
</p><dl compact="compact">
<dt> <kbd>c</kbd> </dt>
<dd><p>means color, and has an index which takes three values (0,1,2).
</p></dd>
<dt> <kbd>d</kbd></dt>
<dd><p>means Dirac spin, and its index takes four values (0-3).
</p></dd>
<dt> <kbd>e</kbd></dt>
<dd><p>means element of a matrix, and has two indices which take three values -
row and column&ndash;(0-2),(0-2)
</p></dd>
</dl>

<p>Complex numbers: (in &lsquo;<tt>complex.h</tt>&rsquo;).  Since present-day C compilers have
native complex types these MILC types will be replaced in future code
with native types.
</p><table><tr><td>&nbsp;</td><td><pre class="example">typedef struct { /* standard complex number declaration for single- */
   float real;    /* precision complex numbers */
   float imag; 
} complex;

typedef struct { /* standard complex number declaration for double- */
   double real;   /* precision complex numbers */
   double imag; 
} double_complex;
</pre></td></tr></table>

<p>Three component complex vectors, 3x3 complex matrices, and 3x3
antihermitian matrices stored in triangular (compressed) format.  (in
&lsquo;<tt>su3.h</tt>&rsquo;)
</p><table><tr><td>&nbsp;</td><td><pre class="example">typedef struct { complex e[3][3]; } su3_matrix; 
typedef struct { complex c[3]; } su3_vector; 
typedef struct {
  float m00im,m11im,m22im;
  complex m01,m02,m12; 
} anti_hermitmat;
</pre></td></tr></table>

<p>Wilson vectors have both Dirac and color indices:
</p><table><tr><td>&nbsp;</td><td><pre class="example">  typedef struct { su3_vector d[4]; } wilson_vector;
</pre></td></tr></table>
<p>Projections of Wilson vectors
<!-- MATH
 $(1 \pm \gamma_\mu)\psi$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="72" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_13.png"
 ALT="$(1 \pm \gamma_\mu)\psi$"></SPAN>
</p><table><tr><td>&nbsp;</td><td><pre class="example">  typedef struct { su3_vector h[2]; } half_wilson_vector;
</pre></td></tr></table>
<p>A definition to be used in the next definition:
</p><table><tr><td>&nbsp;</td><td><pre class="example">  typedef struct { wilson_vector d[4]; } spin_wilson_vector;
</pre></td></tr></table>
<p>A four index object &mdash; source spin and color by sink spin and color:
</p><table><tr><td>&nbsp;</td><td><pre class="example">  typedef struct { spin_wilson_vector c[3]; } wilson_propagator
</pre></td></tr></table>

<p>Examples:
</p><table><tr><td>&nbsp;</td><td><pre class="example">su3_vector phi; /* declares a vector */ 
su3_matrix m1,m2,m3;         /* declares 3x3 complex matrices */ 
wilson_vector wvec;          /* declares a Wilson quark vector */

phi.c[0].real = 1.0;         /* sets real part of color 0 to 1.0 */ 
phi.c[1] = cmplx(0.0,0.0);   /* sets color 1 to zero (requires
                                including &quot;complex.h&quot; */ 
m1.e[0][0] = cmplx(0,0);     /* refers to 0,0 element */ 
mult_su3_nn( &amp;m1, &amp;m2, &amp;m3); /* subroutine arguments are usually
                                addresses of structures */
wvec.d[2].c[0].imag = 1.0;   /* How to refer to imaginary part of
                                spin two, color zero. */
</pre></td></tr></table>

<hr size="6">
<a name="Library-routines"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Data-types" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Complex-numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Library-routines-1"></a>
<h2 class="section">5.5 Library routines</h2>
<a name="index-Library-routines"></a>

<hr size="6">
<a name="Complex-numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Library-routines" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SU_00283_0029-operations" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Library-routines" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">5.5.1 Complex numbers</h3>
<p>&lsquo;<tt>complex.h</tt>&rsquo; and &lsquo;<tt>complex.a</tt>&rsquo; contain macros and subroutines for
complex numbers.  For example:
</p><table><tr><td>&nbsp;</td><td><pre class="example">complex a,b,c; 
CMUL(a,b,c); /* macro: c &lt;- a*b */
</pre></td></tr></table>
<p>Note that all the subroutines (<kbd>cmul()</kbd>, etc.) take addresses as
arguments, but the macros generally take the structures themselves.
These functions have separate versions for single and double precision
complex numbers.  The macros work with either single or double precison
(or mixed).  &lsquo;<tt>complex.a</tt>&rsquo; contains:
</p><table><tr><td>&nbsp;</td><td><pre class="example">complex cmplx(float r, float i);      /* (r,i) */ 
complex cadd(complex *a, complex *b); /* a + b */ 
complex cmul(complex *a, complex *b); /* a * b */ 
complex csub(complex *a, complex *b); /* a - b */ 
complex cdiv(complex *a, complex *b); /* a / b */ 
complex conjg(complex *a);            /* conjugate of a */ 
complex cexp(complex *a);             /* exp(a) */ 
complex clog(complex *a);             /* ln(a) */ 
complex csqrt(complex *a);            /* sqrt(a) */
complex ce_itheta(float theta);       /* exp( i*theta) */

double_complex dcmplx(double r, double i);                  /* (r,i) */ 
double_complex dcadd(double_complex *a, double_complex *b); /* a + b */ 
double_complex dcmul(double_complex *a, double_complex *b); /* a * b */ 
double_complex dcsub(double_complex *a, double_complex *b); /* a - b */ 
double_complex dcdiv(double_complex *a, double_complex *b); /* a / b */ 
double_complex dconjg(double_complex *a);          /* conjugate of a */ 
double_complex dcexp(double_complex *a);                   /* exp(a) */ 
double_complex dclog(double_complex *a);                    /* ln(a) */ 
double_complex dcsqrt(double_complex *a);                 /* sqrt(a) */ 
double_complex dce_itheta(double theta);            /* exp( i*theta) */
</pre></td></tr></table>
<p>and macros:
</p><table><tr><td>&nbsp;</td><td><pre class="example">CONJG(a,b)        b = conjg(a)
CADD(a,b,c)       c = a + b
CSUM(a,b)         a += b
CSUB(a,b,c)       c = a - b
CMUL(a,b,c)       c = a * b
CDIV(a,b,c)       c = a / b
CMUL_J(a,b,c)     c = a * conjg(b)
CMULJ_(a,b,c)     c = conjg(a) * b
CMULJJ(a,b,c)     c = conjg(a*b)
CNEGATE(a,b)      b = -a
CMUL_I(a,b)       b = ia
CMUL_MINUS_I(a,b) b = -ia
CMULREAL(a,b,c)   c = ba with b real and a complex
CDIVREAL(a,b,c)   c = a/b with a complex and b real
</pre></td></tr></table>

<hr size="6">
<a name="SU_00283_0029-operations"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Complex-numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Moving-around-in-the-lattice" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Library-routines" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">5.5.2 SU(3) operations</h3>
<p>&lsquo;<tt>su3.h</tt>&rsquo; and &lsquo;<tt>su3.a</tt>&rsquo; contain a plethora of
functions for SU(3) operations.
For example:
</p><table><tr><td>&nbsp;</td><td><pre class="example">void mult_su3_nn(su3_matrix *a, su3_matrix *b, su3_matrix *c); 
/* matrix multiply, no adjoints
   *c &lt;- *a * *b (arguments are pointers) */

void mult_su3_mat_vec_sum(su3_matrix *a, su3_vector *b, su3_vector *c);
/* su3_matrix times su3_vector multiply and add to another su3_vector
   *c &lt;- *A * *b + *c */
</pre></td></tr></table>
<p>There have come to be a great many of these routines, too many to keep a
duplicate list of here.  Consult the include file &lsquo;<tt>su3.h</tt>&rsquo; for a
list of prototypes and description of functions. 
</p>
<hr size="6">
<a name="Moving-around-in-the-lattice"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SU_00283_0029-operations" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Accessing-fields-at-other-sites" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Moving-around-in-the-lattice-1"></a>
<h2 class="section">5.6 Moving around in the lattice</h2>
<a name="index-Moving-around-in-the-lattice"></a>

<a name="index-field_005foffset"></a>
<a name="index-field_005fpointer"></a>
<a name="index-F_005fOFFSET"></a>
<a name="index-F_005fPT"></a>
<p>Various definitions, macros and routines exist for dealing with the
lattice fields.  
The definitions and macros (defined in &lsquo;<tt>dirs.h</tt>&rsquo;) are:
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* Directions, and a macro to give the opposite direction */ 
/* These must go from 0 to 7 because they will be used to index an
   array. */ 
/* Also define NDIRS = number of directions */
#define XUP 0 
#define YUP 1 
#define ZUP 2 
#define TUP 3 
#define TDOWN 4 
#define ZDOWN 5 
#define YDOWN 6 
#define XDOWN 7 
#define OPP_DIR(dir) (7-(dir))  /* Opposite direction */ 
                                /* for example, OPP_DIR(XUP) is XDOWN */
/* number of directions */ 
#define NDIRS 8 
</pre></td></tr></table>

<p>The parity of a site is <strong>EVEN</strong> or <strong>ODD</strong>, where
<strong>EVEN</strong> means (x+y+z+t)%2=0.  Lots of routines take <strong>EVEN</strong>,
<strong>ODD</strong> or <strong>EVENANDODD</strong> as an argument. Specifically (in hex):
</p><table><tr><td>&nbsp;</td><td><pre class="example">#define EVEN 0x02 
#define ODD 0x01 
#define EVENANDODD 0x03
</pre></td></tr></table>

<p>Often we want to use the name of a field as an argument to a routine, as
in <kbd>dslash(chi,phi)</kbd>. Often these fields are members of the structure 
<kbd>site</kbd>, and such variables can&rsquo;t be used directly as arguments
 in C. Instead, we use a
 macro to convert the name of a field
into an integer, and another one to convert this integer back into an
address at a given site.  A type <kbd>field_offset</kbd>, which is secretly
an integer, is defined to help make the programs clearer.
</p>
<p><strong>F_OFFSET</strong>(<kbd>fieldname</kbd>) gives the offset in the site structure of
the named field. <strong>F_PT</strong>(<kbd>*site</kbd>, <kbd>field_offset</kbd>) gives the
address of the field whose offset is <kbd>field_offset</kbd> at the site
<kbd>*site</kbd>. An example is certainly in order:
</p><table><tr><td>&nbsp;</td><td><pre class="example">int main() {
  copy_site( F_OFFSET(phi), F_OFFSET(chi) );
  /* &quot;phi&quot; and &quot;chi&quot; are names of su3_vector's in site. */ 
}

/* Copy an su3_vector field in the site structure over the whole lattice */
int copy_site(field_offset off1, field_offset off2) {
  int i;
  site *s;
  su3_vector *v1,*v2;

  for(i=0;i&lt;nsites_on_node;i++) { /* loop over sites on node */
     s = &amp;(lattice[i]); /* pointer to current site */
     v1 = (su3_vector *)F_PT( s, off1); /* address of first vector */
     v2 = (su3_vector *)F_PT( s, off2);
     *v2 = *v1; /* copy the vector at this site */
  } 
}
</pre></td></tr></table>


<p>For ANSI prototyping, you must typecast the result of the
<strong>F_PT</strong> macro to the appropriate pointer type.  (It naturally
produces a character pointer).  The code for copy_site could be much
shorter at the expense of clarity.  Here we use a macro to be defined
below.
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* Copy an su3_vector field in the site structure over the whole lattice */
void copy_site(field_offset off1, field_offset off2) {
  int i;
  site *s;
  FORALLSITES(i,s) {
    *(su3_vector *)F_PT(s,off1) = *(su3_vector *)F_PT(s,off2);
  } 
}
</pre></td></tr></table>

<p>Since we now recommend field-major order for the fields, here is
the same example, but for the recommended practice:
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* Copy an su3_vector field in field-major order over the whole lattice */
void copy_field(su3_vector vec1[], su3_vector vec2[]) {
  int i;
  site *s;
  FORALLSITES(i,s) {
    vec1[i] = vec2[i];
  } 
}
</pre></td></tr></table>

<p>The following macros are not necessary, but are very useful.  You may
use them or ignore them as you see fit. Loops over sites are so common
that we have defined macros for them ( in
&lsquo;<tt>include/macros.h</tt>&rsquo;). These macros use an integer and a site pointer,
which are available inside the loop.  The site pointer is especially
useful for accessing fields at the site.
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* macros to loop over sites of a given parity, or all sites on a node.
   Usage:
        int i;
        site *s;
        FOREVENSITES(i,s) {
            Commands go here, where s is a pointer to the current
            site and i is the index of the site on the node.
            For example, the phi vector at this site is &quot;s-&gt;phi&quot;.
        } */ 
#define FOREVENSITES(i,s) \
    for(i=0,s=lattice;i&lt;even_sites_on_node;i++,s++)
#define FORODDSITES(i,s) \
    for(i=even_sites_on_node,s= &amp;(lattice[i]);i&lt;sites_on_node;i++,s++)
#define FORALLSITES(i,s) \
    for(i=0,s=lattice;i&lt;sites_on_node;i++,s++)
#define FORSOMEPARITY(i,s,parity) \
    for( i=((choice)==ODD ? even_sites_on_node : 0 ),  \
    s= &amp;(lattice[i]); \
    i&lt; ( (choice)==EVEN ? even_sites_on_node : sites_on_node); \
    i++,s++)
</pre></td></tr></table>
<p>The first three of these macros loop over even, odd or all sites on the
node, setting a pointer to the site and the index in the array.  The
index and pointer are available for use by the commands inside the
braces.  The last macro takes an additional argument which should be one
of <strong>EVEN</strong>, <strong>ODD</strong> or <strong>EVENANDODD</strong>, and loops over
sites of the selected parity.
</p>
<hr size="6">
<a name="Accessing-fields-at-other-sites"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Moving-around-in-the-lattice" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Details-of-gathers-and-creating-new-ones" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Accessing-fields-at-other-sites-1"></a>
<h2 class="section">5.7 Accessing fields at other sites</h2>
<a name="index-Accessing-fields-at-other-sites"></a>

<p>In the examples thus far each node fetches and stores field values
only on its own sites.  To fetch field values at other sites, we use
gather routines.  These are portable in the sense that they will look
the same on all the machines on which this code runs, although what is
inside them is quite different.  All of these routines return pointers
to fields.  If the fields are on the same node, these are just
pointers into the lattice, and if the fields are on sites on another
node some message passing takes place.  Because the communcation
routines may have to allocate buffers for data, it is necessary to
free the buffers by calling the appropriate cleanup routine when you
are finished with the data.  These routines are in &lsquo;<tt>com_XXXXX.c</tt>&rsquo;,
where <kbd>XXXXX</kbd> is either <kbd>vanilla</kbd> for a scalar machine,
<kbd>mpi</kbd> for MPI operation, <kbd>qmp</kbd> for QMP support.
</p>
<p>The four standard routines for moving field values are
<kbd>start_gather_site</kbd> and <kbd>start_gather_field</kbd>, which start the
data exchange for either data in the site structure or in field-major
order, <kbd>wait_gather</kbd>, which interrupts the processor until the
data arrives, and <kbd>cleanup_gather</kbd>, which frees the memory used by
the gathered data.  A special <kbd>msg_tag</kbd> structure is used to
identify the gather.  If you are doing more than one gather at a time,
just use different <kbd>*msg_tags</kbd> for each one to keep them straight.
</p>
<p>The abstraction used in gathers is that sites fetch data from sites,
rather than nodes from nodes.  In this way the physical distribution of
data among the nodes is hidden from the higher level call.  Any
one-to-one mapping of sites onto sites can be used to define a gather
operation, but the most common gather fetches data from a neigboring
site in one of the eight cardinal directions.  The result of a gather is
presented as a list of pointers.  Generally one of the <kbd>gen_pt[0]</kbd>,
etc. arrays is used. (see section <a href="#Lattice-storage">Lattice storage</a>). On each site, or on each
site of the selected parity, this pointer either points to an on-node
address when the required data is on-node or points to an address in a
communications buffer when the required data has been passed from
another node.
</p>
<p>These routines use asynchronous sends and receives when possible, so it
is possible to start one or more gathers going, and do something else
while awaiting the data.
</p>
<p>Here are the four gather routines:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">/* &quot;start_gather_site()&quot; starts asynchronous sends and receives required
    to gather neighbors. */

msg_tag * start_gather_site(offset,size,direction,parity,dest);
  /* arguments */
  field_offset offset;  /* which field? Some member of structure &quot;site&quot; */
  int size;            /* size in bytes of the field
                            (eg. sizeof(su3_vector))*/
  int direction;       /* direction to gather from. eg XUP */
  int parity;          /* parity of sites whose neighbors we gather.
                            one of EVEN, ODD or EVENANDODD. */ 
  char * dest;         /* one of the vectors of pointers */


msg_tag * start_gather_field(void *field,size,direction,parity,dest);
  /* arguments */
  void *field;         /* which field? Some member of an array */
  int size;            /* size in bytes per site of the field
                            (eg. sizeof(su3_vector))*/
  int direction;       /* direction to gather from. eg XUP */
  int parity;          /* parity of sites whose neighbors we gather.
                            one of EVEN, ODD or EVENANDODD. */ 
  char * dest;         /* one of the vectors of pointers */


/* &quot;wait_gather()&quot; waits for receives to finish, insuring that the
   data has actually arrived.  The argument is the (msg_tag *) returned
   by start_gather. */

void wait_gather(msg_tag *mbuf);


/* &quot;cleanup_gather()&quot; frees all the buffers that were allocated, WHICH
    MEANS THAT THE GATHERED DATA MAY SOON DISAPPEAR. */

void cleanup_gather(msg_tag *mbuf);
</pre></td></tr></table>

<p>Nearest neighbor gathers are done as follows. In the first example
we gather <kbd>phi</kbd> at all even sites from the neighbors in the
<strong>XUP</strong> direction.  (<em>Gathering at <strong>EVEN</strong> sites means
that <kbd>phi</kbd> at odd sites will be made available for computations at
<strong>EVEN</strong> sites.</em>)
</p><table><tr><td>&nbsp;</td><td><pre class="example">msg_tag *tag; 
site *s; 
int i;
su3_vector *phi;

phi = (su3_vector *)malloc(sites_on_node * sizeof(su3_vector);

...

tag = start_gather_field( phi, sizeof(su3_vector), XUP,
                         EVEN, gen_pt[0] );

/* do other stuff */

wait_gather(tag); 
/* *(su3_vector *)gen_pt[0][i] now contains the address of the
    phi vector (or a copy therof) on the neighbor of site i in the
    XUP direction for all even sites i.  */

FOREVENSITES(i,s) { 
/* do whatever you want with it here.
   (su3_vector *)(gen_pt[0][i]) is a pointer to phi on
   the neighbor site. */ 
}

cleanup_gather(tag); 
/* subsequent calls will overwrite the gathered fields. but if you 
don't clean up, you will eventually run out of space */
</pre></td></tr></table>


<p>This second example gathers <kbd>phi</kbd> from two directions at once:
</p><table><tr><td>&nbsp;</td><td><pre class="example">msg_tag *tag0,*tag1; 
tag0 = start_gather_site( phi, sizeof(su3_vector), XUP,
                          EVENANDODD, gen_pt[0] ); 
tag1 = start_gather_site( phi, sizeof(su3_vector), YUP,
                          EVENANDODD, gen_pt[1] );

/** do other stuff **/

wait_gather(tag0); 
/* you may now use *(su3_vector *)gen_pt[0][i], the
   neighbors in the XUP direction. */

wait_gather(tag1); 
/* you may now use *(su3_vector *)gen_pt[1][i], the
   neighbors in the YUP direction. */

cleanup_gather(tag0); 
cleanup_gather(tag1);
</pre></td></tr></table>

<p>Of course, you can also simultaneously gather different fields, or
gather one field to even sites and another field to odd sites.  Just be
sure to keep your <kbd>msg_tag</kbd> pointers straight.  The internal
workings of these routines are far too horrible to discuss here.
Consult the source code and comments in &lsquo;<tt>com_XXXXX.c</tt>&rsquo; if you must.
</p>
<p>Another predefined gather fetches a field at an arbitrary displacement
from a site.  It uses the family of calls <kbd>start_general_gather_site</kbd>,
<kbd>start_general_gather_field</kbd>,
<kbd>wait_general_gather</kbd>, <kbd>cleanup_general_gather</kbd>.  It works like
the gather described above except that instead of specifying the
direction you specify a four-component array of integers which is the
relative displacement of the field to be fetched.  It is a bit slower
than a gather defined by <kbd>make_gather</kbd>, because it is necessary to
build the neighbor tables with each call to <kbd>start_general_gather</kbd>.
</p>
<p>Chaos will ensue if you use <kbd>wait_gather()</kbd> with a message tag
returned by <kbd>start_general_gather_XXXX()</kbd>, or vice-versa.
<kbd>start_general_gather_site()</kbd> has the following format:
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* &quot;start_general_gather_site()&quot; starts asynchronous sends and receives
    required to gather neighbors. */ 
msg_tag * start_general_gather_site(offset,size,displacement,parity,dest)
  /* arguments */
  field_offset offset; /* which field? Some member of structure site */
  int size;           /* size in bytes of the field 
                           (eg. sizeof(su3_vector))*/
  int *displacement;  /* displacement to gather from,
                           a four component array */
  int parity;         /* parity of sites whose neighbors we gather.
                           one of EVEN, ODD or EVENANDODD. */
  char ** dest;       /* one of the vectors of pointers */

/* &quot;wait_general_gather()&quot; waits for receives to finish, insuring that
    the data has actually arrived.  The argument is the (msg_tag *) 
    returned by start_general_gather. */ 
void wait_general_gather(msg_tag *mbuf);
</pre></td></tr></table>

<p><kbd>start_general_gather_field()</kbd> has the following format:
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* &quot;start_general_gather_field()&quot; starts asynchronous sends and receives
    required to gather neighbors. */ 
msg_tag * start_general_gather_field(field,size,displacement,parity,dest)
  /* arguments */
  void *field;        /* which field? A field in field-major order */
  int size;           /* size in bytes per site of the field 
                           (eg. sizeof(su3_vector))*/
  int *displacement;  /* displacement to gather from,
                           a four component array */
  int parity;         /* parity of sites whose neighbors we gather.
                           one of EVEN, ODD or EVENANDODD. */
  char ** dest;       /* one of the vectors of pointers */

/* &quot;wait_general_gather()&quot; waits for receives to finish, insuring that
    the data has actually arrived.  The argument is the (msg_tag *) 
    returned by start_general_gather. */ 
void wait_general_gather(msg_tag *mbuf);

/* &quot;cleanup_general_gather()&quot; frees all the buffers that were
    allocated, <em>WHICH MEANS THAT THE GATHERED DATA MAY SOON
    DISAPPEAR.</em>  */ 
void cleanup_general_gather(msg_tag *mbuf);
</pre></td></tr></table>

<p>This example gathers <kbd>phi</kbd> from a site displaced by +1 in the x
direction and -1 in the y direction.
</p><table><tr><td>&nbsp;</td><td><pre class="example">msg_tag *tag; 
site *s; 
int i, disp[4];

disp[XUP] = +1; disp[YUP] = -1; disp[ZUP] = disp[TUP] = 0;

tag = start_general_gather_site( F_OFFSET(phi), sizeof(su3_vector), disp,
                                 EVEN, gen_pt[0] ); /* do other stuff */

wait_general_gather(tag); 
/* gen_pt[0][i] now contains the address of the phi
   vector (or a copy therof) on the site displaced from site i
   by the vector &quot;disp&quot; for all even sites i. */

FOREVENSITES(i,s) { 
/* do whatever you want with it here.
   (su3_vector *)(gen_pt[0][i]) is a pointer to phi on
   the other site. */ 
}

cleanup_general_gather(tag);
</pre></td></tr></table>

<p>Here is an example of a gather from a field in field-major order:
</p><table><tr><td>&nbsp;</td><td><pre class="example">  su3_vector *tempvec;
  msg_tag *tag;
  tempvec = (su3_vector *)malloc( sites_on_node*sizeof(su3_vector) );
  ...
  FORALLSITES(i,s){  tempvec[i] = s-&gt;grand; }
  ...
  tag=start_gather_field( tempvec, sizeof(su3_vector), dir,EVEN,gen_pt[1] );
  ...
  wait_gather(tag);
  ...
  cleanup_gather(tag);
  ...
  free(tempvec);
</pre></td></tr></table>

<p>  At present the code does not support a strided gather from a field
in field-major order.  This could present a problem.
For example, the gauge links are typically defined as an array of four
<kbd>su3_matrices</kbd>, and we typically gather only one of them.  This
won&rsquo;t work with <kbd>start_gather_field</kbd>.
</p>
<p>  Don&rsquo;t try to chain successive gathers by using
 <kbd>start_gather_field</kbd>
     to gather the <kbd>gen_pt fields</kbd>.  It will gather the pointers, but not
     what they point to.  This is insidious, because it will work on one
     node as you are testing it, but fail on multiple nodes.
</p>
<p>To set up the data structures required by the gather routines,
<kbd>make_nn_gathers()</kbd> is called in the setup part of the program.
This must be done <em>after</em> the call to <kbd>make_lattice()</kbd>.
</p>
<hr size="6">
<a name="Details-of-gathers-and-creating-new-ones"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Accessing-fields-at-other-sites" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Distributing-sites-among-nodes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Details-of-gathers-and-creating-new-ones-1"></a>
<h2 class="section">5.8 Details of gathers and creating new ones</h2>
<a name="index-Details-of-gathers-and-creating-new-ones"></a>

<p>(You don&rsquo;t need to read this section the first time through.)
</p>
<p>The nearest-neighbor and fixed-displacement gathers are always available
at run time, but a user can make other gathers using the
<kbd>make_gather</kbd> routine.  Examples of such gathers are the bit-reverse
and butterfly maps used in FFT&rsquo;s.  The only requirement is that the
gather pattern must correspond to a one-to-one map of sites onto sites.
<kbd>make_gather</kbd> speeds up gathers by preparing tables on each node
containing information about what sites must be sent to other nodes or
received from other nodes. The call to this routine is:
</p><table><tr><td>&nbsp;</td><td><pre class="example">#include &lt;comdefs.h&gt; 
int make_gather( function, arg_pointer, inverse, want_even_odd,
                 parity_conserve )
  int (*function)();
  int *arg_pointer;
  int inverse;
  int parity_conserve;
</pre></td></tr></table>

<p>The <kbd>&quot;function&quot;</kbd> argument is a pointer to a function which defines
the mapping. This function must have the following form:
</p><table><tr><td>&nbsp;</td><td><pre class="example">int function( x, y, z, t, arg_pointer, forw_back, xpt, ypt, zpt, tpt)
  int x,y,z,t;
  int *arg_pointer;
  int forw_back;
  int *xpt,*ypt,*zpt,*tpt;
</pre></td></tr></table>
<p>Here <kbd>x,y,z,t</kbd> are the coordinates of the site <em>RECEIVING</em> the
data.  <kbd>arg_pointer</kbd> is a pointer to a list of integers, which is
passed through to the function from the call to <kbd>make_gather()</kbd>.
This provides a mechanism to use the same function for different
gathers.  For example, in setting up nearest neighbor gathers we would
want to specify the direction.  See the examples below.
</p>
<p><kbd>forw_back</kbd> is either <strong>FORWARDS</strong> or <strong>BACKWARDS</strong>.  If
it is <strong>FORWARDS</strong>, the function should compute the coordinates of
the site that sends data to <kbd>x,y,z,t</kbd>.  If it is <strong>BACKWARDS</strong>,
the function should compute the coordinates of the site which gets data
from <kbd>x,y,z,t</kbd>.  It is necessary for the function to handle
<strong>BACKWARDS</strong> correctly even if you don&rsquo;t want to set up the
inverse gather (see below).  At the moment, only one-to-one (invertible)
mappings are supported.
</p>
<a name="index-FFT"></a>
<a name="index-Butterflies-_0028FFT_0029"></a>
<p>The <kbd>inverse</kbd> argument to <kbd>make_gather()</kbd> is one of
<strong>OWN_INVERSE</strong>, <strong>WANT_INVERSE</strong>, or <strong>NO_INVERSE</strong>.  If
it is <strong>OWN_INVERSE</strong>, the mapping is its own inverse.  In other
words, if site <kbd>x1,y1,z1,t1</kbd> gets data from <kbd>x2,y2,z2,t2</kbd> then
site <kbd>x2,y2,z2,t2</kbd> gets data from <kbd>x1,y1,z1,t1</kbd>.  Examples of
mappings which are there own inverse are the butterflies in FFT&rsquo;s.  If
<kbd>inverse</kbd> is <strong>WANT_INVERSE</strong>, then <kbd>make_gather()</kbd> will
make two sets of lists, one for the gather and one for the gather using
the inverse mapping.  If <kbd>inverse</kbd> is <strong>NO_INVERSE</strong>, then
only one set of tables is made.
</p>
<p>The <kbd>want_even_odd</kbd> argument is one of <strong>ALLOW_EVEN_ODD</strong> or
<strong>NO_EVEN_ODD</strong>.  If it is <strong>ALLOW_EVEN_ODD</strong> separate tables
are made for even and odd sites, so that start gather can be called with
parity <strong>EVEN</strong>, <strong>ODD</strong> or <strong>EVENANDODD</strong>.  If it is
<strong>NO_EVEN_ODD</strong>, only one set of tables is made and you can only
call gathers with parity <strong>EVENANDODD</strong>.
</p>
<p>The <kbd>parity_conserve</kbd> argument to <kbd>make_gather()</kbd> is one of
<strong>SAME_PARITY</strong>, <strong>SWITCH_PARITY</strong>, or <strong>SCRAMBLE_PARITY</strong>.
Use <strong>SAME_PARITY</strong> if the gather connects even sites to even sites
and odd sites to odd sites.  Use <strong>SWITCH_PARITY</strong> if the gather
connects even sites to odd sites and vice versa.  Use
<strong>SCRAMBLE_PARITY</strong> if the gather connects some even sites to even
sites and some even sites to odd sites.  If you have specified
<strong>NO_EVEN_ODD</strong> for <kbd>want_even_odd</kbd>, then the
<kbd>parity_conserve</kbd> argument does nothing.  Otherwise, it is used by
<kbd>make_gather()</kbd> to help avoid making redundant lists.
</p>
<p><kbd>make_gather()</kbd> returns an integer, which can then be used as the
<kbd>direction</kbd> argument to <kbd>start_gather()</kbd>.  If an inverse
gather is also requested, its <kbd>direction</kbd> will be one more than
the value returned by <kbd>make_gather()</kbd>.  In other words, if
<kbd>make_gather()</kbd> returns 10, then to gather using the inverse mapping
you would use 11 as the direction argument in start_gather.
</p>
<p>Notice that the nearest neighbor gathers do not have their inverse
directions numbered this convention.  Instead, they are sorted so that
<strong>OPP_DIR</strong>(<kbd>direction</kbd>) gives the gather using the inverse
mapping.
</p>

<p>Now for some examples which we hope will clarify all this.
</p>
<p>First, suppose we wish to set up nearest neighbor gathers.  (Ordinarily.
 <kbd>make_comlinks()</kbd> already does this for you, but it is a
good example.)  The function which defines the mapping is basically
<kbd>neighbor_coords()</kbd>, with a wrapper which fixes up the arguments.
<kbd>arg</kbd> should be set to the address of the direction &mdash;
<strong>XUP</strong>, etc.
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* The function which defines the mapping */
void neighbor_temp(x,y,z,t, arg, forw_back, xpt, ypt, zpt, tpt)
  int x,y,z,t;
  int *arg;
  int forw_back;
  int *xpt,*ypt,*zpt,*tpt;
{
  register int dir; /* local variable */
  dir = *arg;
  if(forw_back==BACKWARDS)dir=OPP_DIR(dir);
  neighbor_coords(x,y,z,t,dir,xpt,ypt,zpt,tpt);
}

/* Code fragment to set up the gathers */
/* Do this once, in the setup part of the program. */
int xup_dir, xdown_dir;
int temp;
temp = XUP; /* we need the address of XUP */
xup_dir = make_gather( neighbor_temp, &amp;temp, WANT_INVERSE,
                       ALLOW_EVEN_ODD, SWITCH_PARITY);
xdown_dir = xup_dir+1;

/* Now you can start gathers */
start_gather_field( phi, sizeof(su3_vector), xup_dir, EVEN,
                    gen_pt[0] );
/* and use wait_gather, cleanup_gather as always. */
</pre></td></tr></table>

<p>Again, once it is set up, it works just as before.  Essentially, you are
just defining new <kbd>directions</kbd>.  Again, <kbd>make_comlinks()</kbd> does
the same thing, except that it arranges the directions so that you can
just use <strong>XUP</strong>, <strong>XDOWN</strong>, etc. as the <kbd>direction</kbd>
argument to <kbd>start_gather()</kbd>.
</p>
<p>A second example is for a gather from a general displacement.  You
might, for example, set up a bunch of these to take care of the link
gathered from the second mearest neighbor in evaluating the plaquette in
the pure gauge code.  In this example, the mapping function needs a list
of four arguments &mdash; the displacement in each of four directions.  Notice
that for this displacement even sites connect to even sites, etc.
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* The function which defines the mapping */
/* arg is a four element array, with the four displacements */
void general_displacement(x,y,z,t, arg, forw_back, xpt, ypt, zpt, tpt)
  int x,y,z,t;
  int *arg;
  int forw_back;
  int *xpt,*ypt,*zpt,*tpt;
{
    if( forw_back==FORWARDS ) { /* add displacement */
       *xpt = (x+nx+arg[0])%nx;
       *ypt = (y+ny+arg[1])%ny;
       *zpt = (z+nz+arg[2])%nz;
       *tpt = (t+nt+arg[3])%nt;
    }
    else { /* subtract displacement */
       *xpt = (x+nx-arg[0])%nx;
       *ypt = (y+ny-arg[1])%ny;
       *zpt = (z+nz-arg[2])%nz;
       *tpt = (t+nt-arg[3])%nt;
    }
}

/* Code fragment to set up the gathers */
/* Do this once, in the setup part of the program. */
/* In this example, I set up to gather from displacement -1 in
   the x direction and +1 in the y direction */
int plus_x_minus_y;
int disp[4];
disp[0] = -1;
disp[1] = +1;
disp[2] = 0;
disp[3] = 0;
plus_x_minus_y = make_gather( general_displacement, disp,
                              NO_INVERSE, ALLOW_EVEN_ODD, SAME_PARITY);

/* Now you can start gathers */
start_gather_site( F_OFFSET(link[YUP]), sizeof(su3_matrix), plus_x_minus_y,
                   EVEN, gen_pt[0] );
/* and use wait_gather, cleanup_gather as always. */
</pre></td></tr></table>

<p>Finally, we would set up an FFT butterfly  roughly as
follows.  Here the function wants two arguments: the direction of the
butterfly and the level.
</p><table><tr><td>&nbsp;</td><td><pre class="example">/* The function which defines the mapping */
/* arg is a two element array, with the direction and level */
void butterfly_map(x,y,z,t, arg, forw_back, xpt, ypt, zpt, tpt)
  int x,y,z,t;
  int *arg;
  int forw_back;
  int *xpt,*ypt,*zpt,*tpt;
{
int direction,level;
    direction = arg[0];
    level = arg[1];
    /* Rest of code goes here */
}

/* Code fragment to set up the gathers */
/* Do this once, in the setup part of the program. */
int butterfly_dir[5]; /* for nx=16 */
int args[2];
args[0]=XUP;
for( level=1; level&lt;=4; level++ ) {
    args[1]=level;
    butterfly_dir[level] = make_gather( butterfly_map, args,
       OWN_INVERSE, NO_EVEN_ODD, SCRAMBLE_PARITY);
}
/* similarly for y,z,t directions */
</pre></td></tr></table>

<a name="index-iPSC_002d860"></a>
<a name="index-Intel-Paragon"></a>
<a name="index-interupts"></a>

<hr size="6">
<a name="Distributing-sites-among-nodes"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Details-of-gathers-and-creating-new-ones" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-and-Writing-Lattices-and-Propagators" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Distributing-sites-among-nodes-1"></a>
<h2 class="section">5.9 Distributing sites among nodes</h2>
<a name="index-Distributing-sites-among-nodes"></a>

<p>Four functions are used to determine the distribution of <kbd>sites</kbd>
among the parallel <em>nodes</em>.
</p>
<p><kbd>setup_layout()</kbd> is called once on each node at initialization time,
to do any calculation and set up any static variables that the other
functions may need.  At the time <kbd>setup_layout()</kbd> is called the
global variables <kbd>nx,ny,nz</kbd> and <kbd>nt</kbd> (the lattice dimensions)
are set.  
<br>
</p>
<p><kbd>setup_layout()</kbd> must initialize the global variables:
</p><table><tr><td>&nbsp;</td><td><pre class="example">sites_on_node, 
even_sites_on_node, 
odd_sites_on_node.
</pre></td></tr></table>
<br>

<p>The following functions are available for node/site reference:
</p><dl compact="compact">
<dt> <kbd>size_t num_sites(int node)</kbd> </dt>
<dd><p>returns the number of sites on a node
</p></dd>
<dt> <kbd>int node_number(int x, int y, int z, int t)</kbd> </dt>
<dd><p>returns the node number on which a site lives.
</p></dd>
<dt> <kbd>int node_index(int x, int y, int z, int t)</kbd></dt>
<dd><p>returns the index of the site on the node.
</p></dd>
<dt> <kbd>int io_node(int node)</kbd></dt>
<dd><p>returns the I/O node assigned to a node
</p></dd>
<dt> <kbd>const int *get_logical_dimensions()</kbd></dt>
<dd><p>returns the machine dimensions as an integer array
</p></dd>
<dt> <kbd>const int *get_logical_coordinates()</kbd></dt>
<dd><p>returns the node coordinates when the machine is viewed as a grid of nodes
</p></dd>
<dt> <kbd>void get_coords(int coords[], int node, int index)</kbd></dt>
<dd><p>the inverse of node_index and node_number.  Returns coords.
</p></dd>
</dl>
<p>Thus, the site at <kbd>x,y,z,t</kbd> is <kbd>lattice[node_index(x,y,z,t)]</kbd>.
</p>
<p>These functions may be changed, but
chaos will ensue if they are not consistent. For example, it is a gross
error for the <kbd>node_index</kbd> function to return a value larger than or
equal to the value returned by <kbd>num_sites</kbd> of the appropriate node.
In fact, <kbd>node_index</kbd> must provide a one-to-one mapping of the
coordinates of the <kbd>sites</kbd> on one node to the integers from 0 to
<kbd>num_sites(node)-1</kbd>.
</p>

<p>A good choice of site distribution on nodes will minimize the amount of
communication.  These routines are in &lsquo;<tt>layout_XXX.c</tt>&rsquo;. There are
currently several layout strategies to choose from; select one in your
&lsquo;<tt>Makefile</tt>&rsquo; (see section <a href="#Building-the-MILC-Code">Building the MILC Code</a>).
</p><dl compact="compact">
<dt>  &lsquo;<tt>layout_hyper_prime.c</tt>&rsquo;</dt>
<dd><p>Divides the lattice up into hypercubes by dividing dimensions by the
smallest prime factors.  This is pretty much our standard layout these days.
</p>
</dd>
<dt>  &lsquo;<tt>layout_timeslices.c layout_timeslices_2.c</tt>&rsquo;</dt>
<dd><p>These routines are now obsolete.  They arranged sites so entire time
slices appeared on each processor.  This was especially efficient for
spatial Fourier transforms.  The same effect can now be obtained with
the <strong>IO_NODE_GEOM</strong> macro or QMP <strong>-qmp_geom</strong> command-line
option.
</p>
</dd>
<dt> &lsquo;<tt>layout_hyper_sl32.c</tt>&rsquo;</dt>
<dd><p>Version for 32 sublattices, for extended actions.
This version divides the lattice by factors of two in any of the
   four directions.  It prefers to divide the longest dimensions,
   which mimimizes the area of the surfaces.  Similarly, it prefers
   to divide dimensions which have already been divided, thus not
   introducing more off-node directions.
 This requires that the lattice volume be divisible by the number
   of nodes, which is a power of two.
</p></dd>
</dl>

<p>Below is a completely simple example, which just deals out the sites
among nodes like cards in a deck.  It works, but you would really want
to do much better.
</p><table><tr><td>&nbsp;</td><td><pre class="example">int Num_of_nodes; /* static storage used by these routines */

void setup_layout() {
  Num_of_nodes = numnodes();
  sites_on_node = nx*ny*nz*nt/Num_of_nodes;
  even_sites_on_node = odd_sites_on_node = sites_on_node/2; 
}

int node_number(x,y,z,t) 
int x,y,z,t; 
{
  register int i;
  i = x+nx*(y+ny*(z+nz*t));
  return( i%Num_of_nodes ); 
}

int node_index(x,y,z,t) 
int x,y,z,t; 
{
  register int i;
  i = x+nx*(y+ny*(z+nz*t));
  return( i/Num_of_nodes ); 
}

int num_sites(node) 
int node; 
{ 
  register int i;
  i = nx*ny*nz*nt;
  if( node&lt; i%Num_of_nodes ) return( i/Num_of_nodes+1 );
  else return( i/Num_of_nodes ); 
}
</pre></td></tr></table>

<table><tr><td>&nbsp;</td><td><pre class="example">/* utility function for finding coordinates of neighbor */ 
/* x,y,z,t are the coordinates of some site, and x2p... are
   pointers.  *x2p... will be set to the coordinates of the
   neighbor site at direction &quot;dir&quot;.

void neighbor_coords( x,y,z,t,dir, x2p,y2p,z2p,t2p)
  int x,y,z,t,dir; /* coordinates of site, and direction (eg XUP) */
  int *x2p,*y2p,*z2p,*t2p;
</pre></td></tr></table>

<hr size="6">
<a name="Reading-and-Writing-Lattices-and-Propagators"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Distributing-sites-among-nodes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random-numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Reading-and-writing-lattices-and-propagators"></a>
<h2 class="section">5.10 Reading and writing lattices and propagators</h2>
<a name="index-Reading-and-writing-lattices-and-propagators"></a>

<p>The MILC code supports a MILC-standard single-precision binary gauge
configuration (&ldquo;lattice&rdquo;) file format.  This format includes a
companion ASCII metadata &ldquo;info&rdquo; file with standardized fields to
describe the parameters that went into creating the configuration.
The code also reads gauge configurations files in NERSC, ILDG, SciDAC,
and Fermilab formats and writes files in NERSC, ILDG, and SciDAC
formats.  For MILC, ILDG, and SciDAC formats, it supports reading and
writing either serially through node 0 or in parallel to and from a
single file.  There is also an historic but seldom-used provision for
reading and writing ASCII gauge configuration files.  Through SciDAC
QIO the MILC code supports parallel reading and writing of multiple
partitioned SciDAC file formats.
</p>
<p>The MILC code supports the USQCD Dirac and staggered propagator file
formats through QIO.  It also supports reading and writing two
standard Fermilab propagator file formats.
</p>
<p>Input and output types are set at run time.
Here is a summary of the I/O choices for gauge configuration files:
</p>
<dl compact="compact">
<dt>  <kbd>reload_ascii</kbd></dt>
<dt>   <kbd>reload_serial</kbd> </dt>
<dd><p>   Binary read by node 0.  File format is autodetected.
</p></dd>
<dt>   <kbd>reload_parallel</kbd></dt>
<dd><p>  Binary read by all nodes.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_ascii</kbd></dt>
<dt>   <kbd>save_serial</kbd> </dt>
<dd><p>     Binary through node 0 - standard index order
</p></dd>
<dt>   <kbd>save_parallel</kbd></dt>
<dd><p>    Binary parallel - standard index order.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_checkpoint</kbd> </dt>
<dd><p>    Binary parallel - node dump order
</p></dd>
<dt>   <kbd>save_serial_archive</kbd></dt>
<dd><p>    NERSC Gauge Connection format.  For the moment a parallel version
    is not available.
</p></dd>
<dt>   <kbd>save_serial_scidac</kbd></dt>
<dt>   <kbd>save_parallel_scidac</kbd></dt>
<dt>   <kbd>save_serial_ildg</kbd></dt>
<dd><p>    SciDAC single-file format and ILDG-compatible format.
</p></dd>
<dt>   <kbd>save_partition_scidac</kbd></dt>
<dt>   <kbd>save_partition_ildg</kbd></dt>
<dd><p>    SciDAC partition file format and ILDG-compatible partition file format.
</p></dd>
<dt>   <kbd>save_multifile_scidac</kbd></dt>
<dt>   <kbd>save_multifile_ildg</kbd></dt>
<dd><p>    SciDAC multifile format. (Node dump order, intended for temporary
    storage, rather than archiving.)
</p></dd>
</dl>

<p>For Dirac propagators the old MILC-standard format has been abandoned
in favor of the USQCD and Fermilab formats.  Here is a summary of
Dirac propagator I/O choices:
</p>
<dl compact="compact">
<dt>  <kbd>reload_ascii_wprop</kbd></dt>
<dt>   <kbd>reload_serial_wprop</kbd> </dt>
<dd><p>   Binary read by node 0.  File format is autodetected.
</p></dd>
<dt>   <kbd>reload_parallel_wprop</kbd></dt>
<dd><p>  Binary read by all nodes.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_ascii_wprop</kbd></dt>
<dt>   <kbd>save_serial_scidac_wprop</kbd></dt>
<dd><p>     Binary through node 0 - standard index order
</p></dd>
<dt>   <kbd>save_parallel_scidac_wprop</kbd></dt>
<dd><p>    Binary parallel - standard index order.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_partfile_scidac_wprop</kbd></dt>
<dd><p>    Binary parallel with multiple files.
</p></dd>
<dt>   <kbd>save_multifile_scidac_wprop</kbd></dt>
<dd><p>    Binary parallel with multiple files - node dump order
</p></dd>
<dt>   <kbd>save_serial_fm_wprop</kbd></dt>
<dt>   <kbd>save_serial_fm_sc_wprop</kbd></dt>
<dd><p>    Fermilab formats
</p></dd>
</dl>

<p>For staggered propagators the code supports a MILC-standard format as
well as the USQCD formats and the Fermilab format.  Here is a summary
of Dirac propagator I/O choices:
</p>
<dl compact="compact">
<dt>  <kbd>reload_ascii_ksprop</kbd></dt>
<dt>   <kbd>reload_serial_ksprop</kbd> </dt>
<dd><p>   Binary read by node 0.  File format is autodetected.
</p></dd>
<dt>   <kbd>reload_parallel_ksprop</kbd></dt>
<dd><p>  Binary read by all nodes.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_ascii_ksprop</kbd></dt>
<dt>   <kbd>save_serial_ksprop</kbd></dt>
<dd><p>     Binary through node 0 - standard index order
</p></dd>
<dt>   <kbd>save_serial_scidac_ksprop</kbd></dt>
<dd><p>    Binary through node 0 - standard index order
</p></dd>
<dt>   <kbd>save_parallel_scidac_ksprop</kbd></dt>
<dd><p>    Binary parallel - standard index order.  Only where hardware is available.
</p></dd>
<dt>   <kbd>save_partfile_scidac_ksprop</kbd></dt>
<dd><p>    Binary parallel with multiple files.
</p></dd>
<dt>   <kbd>save_multifile_scidac_ksprop</kbd></dt>
<dd><p>    Binary parallel with multiple files - node dump order
</p></dd>
<dt>   <kbd>save_serial_fm_ksprop</kbd></dt>
<dd><p>     Fermilab format.
</p></dd>
</dl>

<p>To print out variables for debugging purposes, the library routines
<kbd>dumpvec</kbd>, <kbd>dumpmat</kbd> and <kbd>dump_wvec</kbd> (for SU(3) vectors,
SU(3) matrices and Wilson vectors) are quite useful:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">
          FORALLSITES(i,s) {
        if(magsq_wvec(&amp;(s-&gt;psi)) &gt; 1.e-10) {
        printf(&quot;%d %d %d %d\n&quot;, s-&gt;x, s-&gt;y, s-&gt;z,s-&gt;t);
        printf(&quot;psi\n&quot;);
        dump_wvec(&amp;(s-&gt;psi));
        }
    }
</pre></td></tr></table>


<hr size="6">
<a name="Random-numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reading-and-Writing-Lattices-and-Propagators" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#A-Sample-Applications-Directory" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Random-numbers-1"></a>
<h2 class="section">5.11 Random numbers</h2>
<a name="index-Random-numbers"></a>

<p>The random number generator is the exclusive-OR of a 127 bit feedback
shift register and a 32 bit integer congruence generator.  It is
supposed to be machine independent.  Each node or site uses a
different multipler in the congruence generator and different initial
state in the shift register, so all are generating different sequences
of numbers.  If <strong>SITERAND</strong> is defined, which has become
standard practice in our code, each lattice site has its own random
number generator state.  This takes extra storage, but means that the
results of the program will be independent of the number of nodes or
the distribution of the sites among the nodes.  The random number
routine is <kbd>generic/ranstuff.c</kbd>.
</p>

<hr size="6">
<a name="A-Sample-Applications-Directory"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Random-numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Bugs-and-features" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="A-Sample-Applications-Directory-1"></a>
<h2 class="section">5.12 A Sample Applications Directory</h2>
<a name="index-A-Sample-Applications-Directory"></a>

<p>An example of the files which make up an application are listed here.
This list depends very much on which application of the program
(Kogut-Susskind/Wilson?  Thermodynamics/Spectrum?) is being built. The
listing here is for the pure MILC code (non-SciDAC) compilation of the
<kbd>su3_spectrum</kbd> target for the 2+1 asqtad action in the
<kbd>ks_imp_dyn</kbd> application.
</p><dl compact="compact">
<dt> &lsquo;<tt>Make_template:</tt>&rsquo;</dt>
<dd><p>	Contains instructions for compiling and linking. 
	Three routines you can make, &quot;su3_rmd&quot;, &quot;su3_phi&quot; and &quot;su3_hmc&quot;,
	 are programs for the R algorithm, the phi algorithm, or
        the hybrid Monte Carlo algorithm.
</p></dd>
</dl>
<br>

<p><strong>SOME HIGH LEVEL ROUTINES:</strong>
</p><dl compact="compact">
<dt> &lsquo;<tt>control.c</tt>&rsquo;</dt>
<dd><p>    main program
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ranmom.c</tt>&rsquo; </dt>
<dd><p>    generate Gaussian random momenta for the gauge fields
</p></dd>
<dt> &lsquo;<tt>../generic_ks/grsource_imp.c</tt>&rsquo;</dt>
<dd><p>    generate Gaussian random pseudofermion field
</p></dd>
<dt> &lsquo;<tt>setup.c</tt>&rsquo;</dt>
<dd><p>    interpret parameter input
</p></dd>
<dt> &lsquo;<tt>update.c</tt>&rsquo;</dt>
<dd><p>    top-level molecular dynamics
</p></dd>
<dt> &lsquo;<tt>update_h.c</tt>&rsquo;</dt>
<dd><p>    update the gauge momenta
</p></dd>
<dt> &lsquo;<tt>update_u.c</tt>&rsquo;</dt>
<dd><p>    update the gauge fields
</p></dd>
</dl>
<br>

<p><strong>HEADERS</strong>
</p><dl compact="compact">
<dt> &lsquo;<tt>defines.h</tt>&rsquo;</dt>
<dd><p>    Required. Local macros common to all targets in an application.
    SITERAND should be defined here.  Other macros that are independent of
    the site structure can also be defined here.
</p></dd>
<dt> &lsquo;<tt>gauge_action.h</tt>&rsquo;</dt>
<dd><p>    Defines the gauge action
</p></dd>
<dt> &lsquo;<tt>ks_imp_includes.h</tt>&rsquo;</dt>
<dd><p>    Function prototypes for all files in the <kbd>ks_imp_dyn</kbd> application directory.
</p></dd>
<dt> &lsquo;<tt>lattice.h</tt>&rsquo;</dt>
<dd><p>    Required. Defines the site structure and global variables.
</p></dd>
<dt> &lsquo;<tt>lattice_qdp.h</tt>&rsquo;</dt>
<dd><p>    Required. Used only for QDP support.
</p></dd>
<dt> &lsquo;<tt>params.h</tt>&rsquo;</dt>
<dd><p>    Required. Defines the parameter structure used in <kbd>setup.c</kbd> for passing
    input parameters to the nodes.
</p></dd>
<dt> &lsquo;<tt>quark_action.h</tt>&rsquo;</dt>
<dd><p>    Defines the quark action
</p></dd>
</dl>
<br>

<p><strong>LOWER LEVEL ROUTINES</strong>
</p><dl compact="compact">
<dt> &lsquo;<tt>gauge_info.c</tt>&rsquo;</dt>
<dd><p>      Print gauge info to file.
</p></dd>
<dt> &lsquo;<tt>../generic/ape_smear.c</tt>&rsquo;</dt>
<dd><p>      APE smearing
</p></dd>
<dt> &lsquo;<tt>../generic/check_unitarity.c</tt>&rsquo;</dt>
<dd><p>      Check unitarity
</p></dd>
<dt> &lsquo;<tt>../generic/com_qmp.c</tt>&rsquo;</dt>
<dd><p>      Communications
</p></dd>
<dt> &lsquo;<tt>../generic/d_plaq4.c</tt>&rsquo; </dt>
<dd><p>      Plaquette
</p></dd>
<dt> &lsquo;<tt>../generic/field_utilities.c</tt>&rsquo;</dt>
<dd><p>      Creation and destruction of fields
</p></dd>
<dt> &lsquo;<tt>../generic/file_types_milc_usqcd.c</tt>&rsquo;</dt>
<dd><p>      USQCD file type translation
</p></dd>
<dt> &lsquo;<tt>../generic/gauge_force_imp.c</tt>&rsquo;</dt>
<dd><p>      Gauge force
</p></dd>
<dt> &lsquo;<tt>../generic/gauge_stuff.c</tt>&rsquo;</dt>
<dd><p>      Construction of gauge force.
</p></dd>
<dt> &lsquo;<tt>../generic/gauge_utilities.c</tt>&rsquo;</dt>
<dd><p>      Gauge field creation and destruction
</p></dd>
<dt> &lsquo;<tt>../generic/gaugefix2.c</tt>&rsquo; </dt>
<dd><p>      Gauge fixing
</p></dd>
<dt> &lsquo;<tt>../generic/general_staple.c</tt>&rsquo; </dt>
<dd><p>      General staple calculation
</p></dd>
<dt> &lsquo;<tt>../generic/io_ansi.c</tt>&rsquo;</dt>
<dd><p>      Interface for ANSI I/O
</p></dd>
<dt> &lsquo;<tt>../generic/io_detect.c</tt>&rsquo;</dt>
<dd><p>      File type recognition
</p></dd>
<dt> &lsquo;<tt>../generic/io_helpers.c</tt>&rsquo;</dt>
<dd><p>      Top level lattice I/O
</p></dd>
<dt> &lsquo;<tt>../generic/io_lat4.c</tt>&rsquo; </dt>
<dd><p>      Gauge field I/O
</p></dd>
<dt> &lsquo;<tt>../generic/io_lat_utils.c</tt>&rsquo;</dt>
<dd><p>      Gauge field I/O
</p></dd>
<dt> &lsquo;<tt>../generic/io_scidac.c</tt>&rsquo;</dt>
<dd><p>      SciDAC file I/O wrapper
</p></dd>
<dt> &lsquo;<tt>../generic/io_scidac_types.c</tt>&rsquo;</dt>
<dd><p>      File type recognition
</p></dd>
<dt> &lsquo;<tt>../generic/layout_hyper_prime.c</tt>&rsquo;</dt>
<dd><p>      Lattice layout
</p></dd>
<dt> &lsquo;<tt>../generic/make_lattice.c</tt>&rsquo;</dt>
<dd><p>      Lattice creation
</p></dd>
<dt> &lsquo;<tt>../generic/momentum_twist.c</tt>&rsquo; </dt>
<dd><p>      Momentum twist insertion, removal
</p></dd>
<dt> &lsquo;<tt>../generic/nersc_cksum.c</tt>&rsquo; </dt>
<dd><p>      NERSC-type checksum
</p></dd>
<dt> &lsquo;<tt>../generic/path_product.c</tt>&rsquo;</dt>
<dd><p>      Paralle transport along path
</p></dd>
<dt> &lsquo;<tt>../generic/ploop3.c</tt>&rsquo;</dt>
<dd><p>      Polyakov loop
</p></dd>
<dt> &lsquo;<tt>../generic/project_su3_hit.c</tt>&rsquo;</dt>
<dd><p>      SU(3) projection
</p></dd>
<dt> &lsquo;<tt>../generic/ranstuff.c</tt>&rsquo;</dt>
<dd><p>      Random number generator
</p></dd>
<dt> &lsquo;<tt>../generic/remap_stdio_from_args.c</tt>&rsquo;</dt>
<dd><p>      Standard I/O remapping
</p></dd>
<dt> &lsquo;<tt>../generic/report_invert_status.c</tt>&rsquo;</dt>
<dd><p>      Status report
</p></dd>
<dt> &lsquo;<tt>../generic/reunitarize2.c</tt>&rsquo;</dt>
<dd><p>      Reunitarization of gauge links
</p></dd>
<dt> &lsquo;<tt>../generic/show_generic_opts.c</tt>&rsquo;</dt>
<dd><p>      List options turned on
</p></dd>
<dt> &lsquo;<tt>../generic_ks/d_congrad5_fn.c</tt>&rsquo;</dt>
<dd><p>      Conjugate gradient inverter - top level
</p></dd>
<dt> &lsquo;<tt>../generic_ks/d_congrad5_fn_milc.c</tt>&rsquo;</dt>
<dd><p>      MILC coded inverter - single mass
</p></dd>
<dt> &lsquo;<tt>../generic_ks/d_congrad5_two_src.c</tt>&rsquo;</dt>
<dd><p>      Two-source inverter
</p></dd>
<dt> &lsquo;<tt>../generic_ks/d_congrad_opt.c</tt>&rsquo;</dt>
<dd><p>      Inverter support
</p></dd>
<dt> &lsquo;<tt>../generic_ks/dslash_fn_dblstore.c</tt>&rsquo; </dt>
<dd><p>      Dslash
</p></dd>
<dt> &lsquo;<tt>../generic_ks/f_meas.c</tt>&rsquo;</dt>
<dd><p>      Scalar operators, such as psi-bar-psi
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_force_asqtad.c</tt>&rsquo; </dt>
<dd><p>      Fermion force
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_force_fn_multi.c</tt>&rsquo; </dt>
<dd><p>      Fermion force
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_force_multi.c</tt>&rsquo; </dt>
<dd><p>      Fermion force for multiple shifts
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_links.c</tt>&rsquo; </dt>
<dd><p>      Fermion link creation/destruction
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_links_fn_load_milc.c</tt>&rsquo;</dt>
<dd><p>      Asqtad link fattening
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_links_fn_twist_milc.c</tt>&rsquo;</dt>
<dd><p>      Boundary twist
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_links_from_site.c</tt>&rsquo;</dt>
<dd><p>      Wrapper for creating links from gauge field
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fermion_links_milc.c</tt>&rsquo; </dt>
<dd><p>      Fermion link fattening
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ff_opt.c</tt>&rsquo;  </dt>
<dd><p>      Fermion force optimization
</p></dd>
<dt> &lsquo;<tt>../generic_ks/fn_links_milc.c</tt>&rsquo; </dt>
<dd><p>      Creation/destruction utilities for fermion links
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ks_action_paths.c</tt>&rsquo; </dt>
<dd><p>      Link fattening path
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ks_invert.c</tt>&rsquo; </dt>
<dd><p>      Wrapper for staggered inversion
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ks_multicg.c</tt>&rsquo; </dt>
<dd><p>      Multimass inverter - top level
</p></dd>
<dt> &lsquo;<tt>../generic_ks/ks_multicg_offset.c</tt>&rsquo; </dt>
<dd><p>      Multimass inverter
</p></dd>
<dt> &lsquo;<tt>../generic_ks/mat_invert.c</tt>&rsquo; </dt>
<dd><p>      Inverter for spectrum
</p></dd>
<dt> &lsquo;<tt>../generic_ks/path_transport.c</tt>&rsquo;</dt>
<dd><p>      Parallel transport
</p></dd>
<dt> &lsquo;<tt>../generic_ks/rephase.c</tt>&rsquo;</dt>
<dd><p>      Insert/remove KS phases
</p></dd>
<dt> &lsquo;<tt>../generic_ks/show_generic_ks_md_opts.c</tt>&rsquo;</dt>
<dd><p>      Show options in force
</p></dd>
<dt> &lsquo;<tt>../generic_ks/show_generic_ks_opts.c</tt>&rsquo; </dt>
<dd><p>      Show options in force
</p></dd>
<dt> &lsquo;<tt>../generic_ks/show_hisq_force_opts.c</tt>&rsquo;</dt>
<dd><p>      Show options in force
<br>
</p></dd>
</dl>
<br>

<p><strong>LIBRARIES</strong>
</p><dl compact="compact">
<dt> &lsquo;<tt>complex.1.a</tt>&rsquo;</dt>
<dd><p>	complex number operations.  See section on &quot;Library routines&quot;.
</p></dd>
<dt> &lsquo;<tt>su3.1.a</tt>&rsquo;</dt>
<dd><p>	3x3 matrix and 3 component vector operations.  See &quot;utility
	subroutines&quot;.
</p></dd>
</dl>


<hr size="6">
<a name="Bugs-and-features"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#A-Sample-Applications-Directory" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Bugs-and-features-1"></a>
<h2 class="section">5.13 Bugs and features</h2>
<a name="index-Bugs-and-features"></a>
<a name="index-doubleword-boundaries"></a>


<p>Some variants of the version 4 MILC code had library routines and
applications for doing SU(2) gauge theory. This code has not been
translated into version 7 conventions.
</p>
<p>The MILC code is hard-wired for four dimensional simulations.
Three and five dimensional variants are believed to exist, but are not
maintained by us.
</p>
<p>For some unknown reason, lost in the mists of time,
 the MILC code uses the opposite convention for the projectors
<BR><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{displaymath}
S = \sum_x \bar \psi(x) \psi(x) - \kappa(
 \sum_\mu \bar \psi(x) (1+\gamma_\mu)U_\mu(x) \psi(x+\mu) +
 \sum_\mu \bar \psi(x+\mu) (1-\gamma_\mu)U_\mu^\dagger(x) \psi(x))
\end{displaymath}
 -->

<IMG
 WIDTH="572" HEIGHT="46" BORDER="0"
 SRC="milcv7_14.png"
 ALT="\begin{displaymath}S = \sum_x \bar \psi(x) \psi(x) - \kappa(
\sum_\mu \bar \psi...
...m_\mu \bar \psi(x+\mu) (1-\gamma_\mu)U_\mu^\dagger(x) \psi(x)) \end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
rather than the more standard convention
<BR><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{displaymath}
S = \sum_x \bar \psi(x) \psi(x) - \kappa(
 \sum_\mu \bar \psi(x) (1-\gamma_\mu)U_\mu(x) \psi(x+\mu) ) +
 \sum_\mu \bar \psi(x+\mu) (1+\gamma_\mu)U_\mu^\dagger(x) \psi(x) )
\end{displaymath}
 -->

<IMG
 WIDTH="578" HEIGHT="46" BORDER="0"
 SRC="milcv7_15.png"
 ALT="\begin{displaymath}S = \sum_x \bar \psi(x) \psi(x) - \kappa(
\sum_\mu \bar \psi...
..._\mu \bar \psi(x+\mu) (1+\gamma_\mu)U_\mu^\dagger(x) \psi(x) ) \end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
Furthermore, the sign convention for 
 <SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_16.png"
 ALT="$\gamma_2$"></SPAN> 
is minus the standard convention.  Thus the MILC spinor fields differ
from the &ldquo;conventional&rdquo; ones by a gamma-5 multiplication
 <!-- MATH
 $\psi_{MILC}= \gamma_5 \psi_{usual}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="134" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_17.png"
 ALT="$\psi_{MILC}= \gamma_5 \psi_{usual}$"></SPAN>.
and a reflection in the x-z plane.
  MILC uses Weyl-basis (gamma-5 diagonal)
 Dirac matrices.
</p>
<hr size="6">
<a name="Writing-Your-Own-Application"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Bugs-and-features" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Programming-with-MILC-Code" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Writing-Your-Own-Application-1"></a>
<h1 class="chapter">6. Writing Your Own Application</h1>
<a name="index-Writing-Your-Own-Application"></a>

<p>Each application typically uses at least four header files,
<kbd>APP_includes.h</kbd>, <kbd>lattice.h</kbd>, <kbd>defines.h</kbd> and
<kbd>params.h</kbd>. The first contains definitions of all the routines in
the application directory; the second contains a list of global macros
and global definitions and a specification of the <kbd>site</kbd> structure
(all the variables living on the sites of your lattice); the third
contains local macros common to all targets in an application; and the
last defines the parameter structure used for passing input parameters
to the nodes.  The application directory also has its own makefile,
<kbd>Make_template</kbd>, which contains all the (machine-independent)
dependencies necessary for your applications.
</p>
<p>It is customary to put the <kbd>main()</kbd> routine in a file which begins with
the word &ldquo;control&rdquo; (e.g. <kbd>control_clov_p.c</kbd>). Beyond that, you are
on your own. If you poke around, you may find a routine similar
to the one you want to write, which you can modify. A typical application
reads in a lattice 
reads in some input parameters,
does things to variables on every site,
moves information from site to site (see section <a href="#Accessing-fields-at-other-sites">Accessing fields at other sites</a>)
and
writes out a lattice at the end.
</p>
<p>One problem is how to read in global parameters (like a coupling
or the number of iterations of a process). This is done in a file with
a name similar to <kbd>setup.c</kbd>. To read in a global variable and
broadcast it to all the nodes, you must first edit <kbd>lattice.h</kbd>
adding the variable to the list of globals
 (in the long set of <kbd>EXTERN</kbd>&rsquo;s
at the top), and edit the <kbd>params.h</kbd> file to
add it to the <kbd>params</kbd> structure. Next, in <kbd>setup.c</kbd>,
add a set of lines to prompt for the input,
and find the place where the <kbd>params</kbd> structure is initialized or read.
Add your variable once to each list, to put it into <kbd>par_buf</kbd>,
and then to extract it. Good luck!
</p>
<hr size="6">
<a name="Documentation-for-Specific-Applications"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-Your-Own-Application" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Documentation-for-Specific-Applications-1"></a>
<h1 class="chapter">7. Documentation for Specific Applications</h1>
<a name="index-Documentation-for-Specific-Applications"></a>

<p>We provide, here, documentation for some of the applications.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#clover_005finvert2">7.1 clover_invert2</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#ks_005fspectrum">7.2 ks_spectrum</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="clover_005finvert2"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Geometry-etc_002e-specification" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="clover_005finvert2-1"></a>
<h2 class="section">7.1 clover_invert2</h2>
<a name="index-clover_005finvert2"></a>

<p>This code generates Dirac clover and naive propagators from a wide
variety of sources and ties them together to form meson and baryon
correlators.  With extended sources, the code also computes
correlators needed fo three-point and higher functions. The code is
designed to be flexible in specifying source interpolating operators,
propagators, sink interpolating operators, and the combinations to
form hadrons.  In broad terms a &ldquo;meson&rdquo; is contructed by tying
together quark and antiquark propagators.  These quark propagators are
generated in a succession of steps.  First a base source is defined.
A base source can then be modified by applying a sequence of source
operators to complete the definition of the source interpolating
operator.  The propagator starts from the source and propagates to any
sink location.  At the sink a variety of operators can be applied to
form the completed quark propagator.  They are then used to form the
hadrons.
</p>
<p>Because of the high degree of flexibility in the code, the parameter
input file is rather complex and highly structured.  We explain
the construction of the parameter input file in some detail here.
Examples can be found in the directory
<strong>clover_invert2/test/*.sample-in</strong>.
</p>
<p>The parameter input file consists of the following required parts in
this order:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Geometry-etc_002e-specification">7.1.1 Geometry etc. specification</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Gauge-field-specification">7.1.2 Gauge field specification</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Inversion-control">7.1.3 Inversion control</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Base-sources">7.1.4 Base sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Modified-sources">7.1.5 Modified sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Propagator-description">7.1.6 Propagator description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Quark-description">7.1.7 Quark description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Hadron-description">7.1.8 Hadron description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>This complete set of commands can be repeated indefinitely to form a
chain of consecutive computations.
</p>
<p>For human readability, comments on lines beginning with hash (#) are
allowed in the parameter input file.  Blank lines are also permitted.
</p>
<br>

<hr size="6">
<a name="Geometry-etc_002e-specification"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#clover_005finvert2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Geometry-etc_002e-specification-1"></a>
<h3 class="subsection">7.1.1 Geometry etc. specification</h3>
<a name="index-Geometry-etc_002e-specification"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">prompt &lt;int&gt;
</pre></td></tr></table>

<p>Here, valid values of &lt;int&gt; are 0, 1, 2.  The value 0 takes parameters
from stdin without prompting.  The value 1 takes parameters from stdin
with stdout prompts.  The value 2 is for proofreading.  The parameter
input file is scanned but no computations take place.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">nx &lt;int&gt;
ny &lt;int&gt;
nz &lt;int&gt;
nt &lt;int&gt;
</pre></td></tr></table>

<p>These are the lattice dimensions.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">node_geometry &lt;int[4]&gt;
</pre></td></tr></table>

<p>If the code is compiled with the macro <strong>FIX_NODE_GEOM</strong>, the
above line is required.  Otherwise, it should be omitted.  It sets up a
mesh view of the machine based on the machine x y z t dimensions.  The
lattice nx ny nz nt dimensions are divided according to these values.
The product of the int[4] values must equal the number of cores to be
used.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">ionode_geometry &lt;int[4]&gt;
</pre></td></tr></table>

<p>If the code is compiled with both <strong>FIX_NODE_GEOM</strong> and
<strong>FIX_IONODE_GEOM</strong> defined, then the above line is required.  It
sets I/O partitions for SciDAC partfile operation.  The values 1 1 1 1
put the entire machine into one I/O partition, so only one partfile is
written/read.  Copying the values in node_geometry puts each core in
its own I/O partition, so resulting in as many partfiles read/written
as there are cores.  Each value in ionode_geometry must be a divisor
of the corresponding value in node_geometry.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">iseed &lt;int&gt;
</pre></td></tr></table>

<p>This line sets the random number seed.  It is needed for random wall sources.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">job_id &lt;char[]&gt;
</pre></td></tr></table>

<p>The Job ID is copied into the metadata in the output correlator files.
</p>
<hr size="6">
<a name="Gauge-field-specification"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Geometry-etc_002e-specification" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-input" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Gauge-field-specification-1"></a>
<h3 class="subsection">7.1.2 Gauge field specification</h3>
<a name="index-Gauge-field-specification"></a>

<p>The gauge field specification has the following required components:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Gauge-field-input">7.1.2.1 Gauge field input</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Tadpole-factor-and-gauge-fixing">7.1.2.2 Tadpole factor and gauge fixing</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Gauge-field-output">7.1.2.3 Gauge field output</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#APE-smearing">7.1.2.4 APE smearing</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Coordinate-origin">7.1.2.5 Coordinate origin</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Gauge-field-input"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tadpole-factor-and-gauge-fixing" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Gauge-field-input-1"></a>
<h4 class="subsubsection">7.1.2.1 Gauge field input</h4>
<a name="index-Gauge-field-input"></a>

<p>The following choices are available.  Use only one of these.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">reload_serial &lt;char[]&gt; |
reload_parallal &lt;char[]&gt; |
reload_ascii &lt;char[]&gt; |
fresh |
continue
</pre></td></tr></table>

<p>The &lt;char[]&gt; string is the path to the file.  The file type is
detected automatically.  Supported binary file types include MILCv5,
SciDAC (USQCD), ILDG, NERSC, and FNAL-style.  If the file is in SciDAC
format in multiple parts with volume extensions <strong>volnnnnn</strong>, the
path should omit the volume extension.
</p>
<p>With serial reading only the I/O nodes read the file. With SciDAC
singlefile format, there is only one I/O node, namely the master node.
With SciDAC partfile format, each I/O partition resulting from the
<strong>ionode_geometry</strong> specification has one I/O node and it reads
its own partfiles serially.  With parallel reading all nodes read the
file.  Currently, parallel reading is not supported for partfiles, but
future versions of SciDAC QIO may do so.
</p>
<p>Provision is made for reading a file in ASCII format, but this mode is
never used for production running.  
</p>
<p>The <strong>fresh</strong> command specifies a gauge field consisting of unit
matrices.  The <strong>continue</strong> command is used when several
computations are chained together.  It retains the previously loaded
gauge configuration.
</p>
<hr size="6">
<a name="Tadpole-factor-and-gauge-fixing"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Gauge-field-input" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-output" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tadpole-factor-and-gauge-fixing-1"></a>
<h4 class="subsubsection">7.1.2.2 Tadpole factor and gauge fixing</h4>
<a name="index-Tadpole-factor-and-gauge-fixing"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">u0 &lt;float&gt;
</pre></td></tr></table>

<p>This sets the tadpole factor.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">coulomb_gauge_fix |
no_gauge_fix
</pre></td></tr></table>

<p>This line specifies whether to fix to Coulomb gauge or not.  Choose one of these.
</p>
<hr size="6">
<a name="Gauge-field-output"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Tadpole-factor-and-gauge-fixing" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#APE-smearing" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Gauge-field-output-1"></a>
<h4 class="subsubsection">7.1.2.3 Gauge field output</h4>
<a name="index-Gauge-field-output"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">forget |
save_ascii &lt;char[]&gt; |
save_serial &lt;char[]&gt; |
save_parallel &lt;char[]&gt; |
save_checkpoint &lt;char[]&gt; |
save_serial_fm &lt;char[]&gt; |
save_serial_scidac &lt;char[]&gt; |
save_parallel_scidac &lt;char[]&gt; |
save_multifile_scidac &lt;char[]&gt; |
save_partfile_scidac &lt;char[]&gt; |
save_serial_ildg &lt;char[]&gt; |
save_parallel_ildg &lt;char[]&gt; |
save_multifile_ildg &lt;char[]&gt; |
save_partfile_ildg &lt;char[]&gt;
</pre></td></tr></table>

<p>Choose one of these for saving the gauge configuration to a file.  The
command <strong>forget</strong> does not save it.  Otherwise, the &lt;char[]&gt;
specifies the path to the file to be created.
</p>
<p>The <strong>save_serial</strong>, <strong>save_parallel</strong>, and
<strong>save_checkpoint</strong> commands save the file in MILCv5 format.  The
mode of writing is either serial (only the master node writes the
file), parallel (all nodes write to a single file), and checkpoint
(each node writes its own data to a separate file.)  The checkpoint
format is deprecated.  It is being replaced by the corresponding
SciDAC partfile format.
</p>
<p>The <strong>save_serial_fm</strong> command saves the file in Fermilab format.
</p>
<p>The various <strong>scidac</strong> and <strong>ildg</strong> modes require
compilation with QIO and QMP.  The <strong>serial_scidac</strong> mode writes
to a single file through a single node.  The <strong>parallel_scidac</strong>
mode writes to a single file with all nodes writing.  The
<strong>partfile_scidac</strong> mode writes multiple partfiles, one file per
I/O partition.  The <strong>multifile_scidac</strong> mode writes a separate
file for each node.
</p>
<p>The <strong>ildg</strong> mode generates an ILDG-compatible file.  It
requires specifying the ILDG logical file name (LFN) on a separate
line immediately following the <strong>save_XXX_ildg</strong> line:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">ILDG_LFN &lt;char[]&gt;
</pre></td></tr></table>

<hr size="6">
<a name="APE-smearing"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Gauge-field-output" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Coordinate-origin" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="APE-smearing-1"></a>
<h4 class="subsubsection">7.1.2.4 APE smearing</h4>
<a name="index-APE-smearing"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">staple_weight &lt;float&gt;
ape_iter &lt;int&gt;
</pre></td></tr></table>

<p>Provision is made to smooth the input gauge field with the specified
number of APE iterations using the specified weight.  These lines are
required even if smearing is not desired.  In that case use zeros for
each value.
</p>
<hr size="6">
<a name="Coordinate-origin"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#APE-smearing" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Inversion-control" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Gauge-field-specification" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Coordinate-origin-1"></a>
<h4 class="subsubsection">7.1.2.5 Coordinate origin</h4>
<a name="index-coordinate-origin"></a>

<p>Boundary conditions and momentum (&ldquo;boundary&rdquo;) twists for the Dirac
operator depend on the coordinate origin, which establishes which
gauge links are on the boundary.  It is common practice to boost
statistics by computing the same hadron correlator from several
origins on the same gauge field configuration.  It may be desirable to
guarantee that the result is equivalent to applying a straight
coordinate translation to the gauge field configuration and then
computing propagators from an unshifted origin.  The coordinate origin
parameter does this
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">coordinate_origin &lt;int[4]&gt;
</pre></td></tr></table>

<p>The order of coordinates is, as usual, x, y, z, and t.
</p>
<hr size="6">
<a name="Inversion-control"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Coordinate-origin" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Inversion-control-1"></a>
<h3 class="subsection">7.1.3 Inversion control</h3>
<a name="index-Inversion-control"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">max_cg_iterations &lt;int&gt;
max_cg_restarts &lt;int&gt;
</pre></td></tr></table>

<p>These lines specify the maximum number of CG iterations allowed before
restarting and the maximum number of restarts.  Thus the overall
maximum number of iterations is the product of these two.  Further
inversion control is given below for each propagator.
</p>
<hr size="6">
<a name="Base-sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Inversion-control" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#complex_005ffield" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Base-sources-1"></a>
<h3 class="subsection">7.1.4 Base sources</h3>
<a name="index-Base-sources"></a>

<p>Here we describe the specification of the base sources.  They are
elementary and can be used by themselves or made more elaborate with
modifications.
</p>
<p>The definition starts by specifying the number of base sources,
followed by that many stanzas describing the sources.  Here we have
used a hash (#) to introduce comments.  Choices for the
<strong>[source_stanza]</strong> are explained below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_base_sources &lt;int = n&gt;

# source 0

[source_stanza]

# source 1

[source_stanza]

etc.

# source n-1

[source_stanza]
</pre></td></tr></table>

<p>Each <strong>[source_stanza]</strong> has the following structure.  Items in
brackets [] are explained below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&lt;char[] source_name&gt;
subset &lt;full|corner&gt;
[source_parameters]
[optional scale factor]
source_label &lt;char[]&gt;
[save_source_specification]
</pre></td></tr></table>

<p>The <strong>source_name</strong> can specify a complex field, a color vector
field, or a dirac field (usually defined on a single time slice).  For
each source type the <strong>[source_parameters]</strong> are specified as
explained in more detail below.  For a Dirac propagator, the spin and
color content is completed by multiplying an appropriate spin-color
unit vector by the specified complex field.  The possible choices and
their <strong>[source_parameters]</strong> are described in detail below.
</p>
<p>The <strong>subset</strong> mask is applied to the base source and to any of
its modifications.  The choices are <strong>corner</strong> and <strong>full</strong>.
With <strong>corner</strong>, after a source is constructed, the values on all
sites are set to zero except on the corners of each 2^4 hypercube.
With <strong>full</strong>, no mask is applied.  This mask is useful for
naive and staggered fermion sources.
</p>
<p>The <strong>[optional_scale_factor]</strong> has the form
</p><table><tr><td>&nbsp;</td><td><pre class="example">scale_factor &lt;float&gt;
</pre></td></tr></table>

<p>This line is read only if the code is compiled with the macro
<strong>SCALE_PROP</strong> defined.  It multiplies the source by this factor,
and then divides the resulting hadron correlators by this factor to
compensate, which should result in no visible modification of the
result.  It is useful to prevent exponent underflow in computing
propagators for especially heavy quarks.  At the moment this factor is
applied only to Dirac field sources.
</p>
<p>The <strong>source_label</strong> should be only a couple characters long,
since it is used in constructing a name for the hadron correlator.
</p>
<p>Provision is made for saving the source to a file.  Currently, this
happens only if the source is actually used to calculate a propagator.
The <strong>[save_source_specification]</strong> has the syntax
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">forget_source |
save_serial_scidac_ks_source &lt;char[]&gt; |
save_multifile_scidac_ks_source &lt;char[]&gt; |
save_partfile_scidac_ks_source &lt;char[]&gt; |
save_serial_scidac_w_source &lt;char[]&gt; |
save_multifile_scidac_w_source &lt;char[]&gt; |
save_partfile_scidac_w_source &lt;char[]&gt;
</pre></td></tr></table>

<p>These choices follow the same pattern as the choices for saving the
gauge configuration, except they are more limited.
</p>
<p>We turn now to a description of the various source types and their
parameters.  Complex field source names can be any of the following:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#complex_005ffield">7.1.4.1 complex_field</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#complex_005ffield_005ffm">7.1.4.2 complex_field_fm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#corner_005fwall">7.1.4.3 corner_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#even_005fwall">7.1.4.4 even_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#evenandodd_005fwall">7.1.4.5 evenandodd_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#evenminusodd_005fwall">7.1.4.6 evenminusodd_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#gaussian">7.1.4.7 gaussian_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#point">7.1.4.8 point</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#wavefunction">7.1.4.9 wavefunction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>A color vector field serves as the complete source for a naive
propagator (which begins its life as a staggered propagator).  For a
clover propagator, the spin content is completed by multipying the
color field by an appropriate unit spin vector.  Color vector field
names are any of the following:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#random_005fcolor_005fwall">7.1.4.10 random_color_wall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vector_005ffield">7.1.4.11 vector_field</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vector_005ffield_005ffm">7.1.4.12 vector_field_fm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vector_005fpropagator_005ffile">7.1.4.13 vector_propagator_file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>Dirac field source names are any of the following:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#dirac_005ffield">7.1.4.14 dirac_field</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#dirac_005ffield_005ffm">7.1.4.15 dirac_field_fm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#dirac_005fpropagator_005ffile">7.1.4.16 dirac_propagator_file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="complex_005ffield"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Base-sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#complex_005ffield_005ffm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="complex_005ffield-1"></a>
<h4 class="subsubsection">7.1.4.1 complex_field</h4>
<a name="index-complex_005ffield"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>These are the <strong>[source_parameters]</strong> for the
<strong>complex_field</strong> source.  This source is read from a file in
SciDAC format.  The source must be on a single time slice.  The
placement of the source is controlled by the file, which must agree
with the source origin on the <strong>origin</strong> line.  (Typically, the
source file was created in a previous calculation.  In that case the
origin should match the value in that calculation.  If that
calculation required only a value for the time slice coordinate
<strong>t0</strong>, then use the origin <strong>0 0 0 t0</strong>).  The
<strong>momentum</strong> line specifies a plane wave factor that can modify
the source.  The integers specify the x, y, and z components of the
momentum in units of 2 pi/nx, 2 pi/ny, and 2 pi/nz, respectively.
</p>
<hr size="6">
<a name="complex_005ffield_005ffm"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#complex_005ffield" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#corner_005fwall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="complex_005ffield_005ffm-1"></a>
<h4 class="subsubsection">7.1.4.2 complex_field_fm</h4>
<a name="index-complex_005ffield_005ffm"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>This source is similar to the <strong>complex_field</strong> source, except
the binary file is in Fermilab format.
</p>
<hr size="6">
<a name="corner_005fwall"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#complex_005ffield_005ffm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#even_005fwall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="corner_005fwall-1"></a>
<h4 class="subsubsection">7.1.4.3 corner_wall</h4>
<a name="index-corner_005fwall"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">t0 &lt;int&gt;
</pre></td></tr></table>

<p>On the specified time slice this source is one at the origin of each
2^3 cube and zero elsewhere.
</p>
<hr size="6">
<a name="even_005fwall"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#corner_005fwall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#evenandodd_005fwall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="even_005fwall-1"></a>
<h4 class="subsubsection">7.1.4.4 even_wall</h4>
<a name="index-even_005fwall"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">t0 &lt;int&gt;
</pre></td></tr></table>

<p>On the specified time slice this source is one on all even sites,
i.e. with (x + y + z) even.
</p>
<hr size="6">
<a name="evenandodd_005fwall"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#even_005fwall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#evenminusodd_005fwall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="evenandodd_005fwall-1"></a>
<h4 class="subsubsection">7.1.4.5 evenandodd_wall</h4>
<a name="index-evenandodd_005fwall"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">t0 &lt;int&gt;
</pre></td></tr></table>

<p>On the specified time slice this source is one on all sites.
</p>
<hr size="6">
<a name="evenminusodd_005fwall"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#evenandodd_005fwall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#gaussian" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="evenminusodd_005fwall-1"></a>
<h4 class="subsubsection">7.1.4.6 evenminusodd_wall</h4>
<a name="index-evenminusodd_005fwall"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">t0 &lt;int&gt;
</pre></td></tr></table>

<p>On the specified time slice this source is one on even sites and minus
one on odd sites.
</p>
<hr size="6">
<a name="gaussian"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#evenminusodd_005fwall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#point" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="gaussian_005fwall"></a>
<h4 class="subsubsection">7.1.4.7 gaussian_wall</h4>
<a name="index-gaussian_005fwall"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
r0 &lt;float&gt;
</pre></td></tr></table>

<p>A Gaussian profile source centered at the origin, specified by the
integers x, y, z, t.  This source has the value
 <!-- MATH
 $\exp[-(r/r0)^2]$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="101" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_18.png"
 ALT="$\exp[-(r/r0)^2]$"></SPAN>
where r is the Cartesian displacement from x, y, z an the fixed time
slice t.  This is a non-gauge-covariant source, so it is common to use
it only with Coulomb gauge fixing.
</p>
<hr size="6">
<a name="point"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#gaussian" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#wavefunction" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="point-1"></a>
<h4 class="subsubsection">7.1.4.8 point</h4>
<a name="index-point-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
</pre></td></tr></table>

<p>A point source of strength one at the origin specified by the integers
x, y, z, and t.
</p>
<hr size="6">
<a name="wavefunction"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#point" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#random_005fcolor_005fwall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="wavefunction-1"></a>
<h4 class="subsubsection">7.1.4.9 wavefunction</h4>
<a name="index-wavefunction-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
a &lt;float&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Reads an ASCII wavefunction specified in physical coordinates (fm) and
converts it to lattice coordinates for lattice spacing <strong>a</strong>.
The wavefunction is centered at the <strong>origin</strong>, specified by four
integers x, y, z, and t.  A Fourier phase factor specified by the
three integer momentum components multiplies the wave function.
</p>

<hr size="6">
<a name="random_005fcolor_005fwall"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#wavefunction" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vector_005ffield" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="random_005fcolor_005fwall-1"></a>
<h4 class="subsubsection">7.1.4.10 random_color_wall</h4>
<a name="index-random_005fcolor_005fwall-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">t0 &lt;int&gt;
ncolor &lt;int&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Generates <strong>ncolor</strong> random color vector fields on the time slice
<strong>t0</strong>.  For a Dirac source the same random source is used for
each of the four associated spins. A Fourier phase factor specified by
the three integer momentum components multiplies the wave function.
</p>
<hr size="6">
<a name="vector_005ffield"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#random_005fcolor_005fwall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vector_005ffield_005ffm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="vector_005ffield-1"></a>
<h4 class="subsubsection">7.1.4.11 vector_field</h4>
<a name="index-vector_005ffield-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
ncolor &lt;int&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Reads <strong>ncolor</strong> color vector sources from a file in SciDAC
format.  The oritin <strong>origin</strong> must match the origin in the
file. (Typically, the source file was created in a previous
calculation.  In that case the origin should match the value in that
calculation.  If that calculation required only a value for the time
slice coordinate <strong>t0</strong>, then use the origin <strong>0 0 0
t0</strong>). A Fourier phase factor specified by the three integer momentum
components multiplies the wave function.
</p>
<hr size="6">
<a name="vector_005ffield_005ffm"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#vector_005ffield" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vector_005fpropagator_005ffile" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="vector_005ffield_005ffm-1"></a>
<h4 class="subsubsection">7.1.4.12 vector_field_fm</h4>
<a name="index-vector_005ffield_005ffm-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
ncolor &lt;int&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Reads <strong>ncolor</strong> color vector sources from a file in Fermilab
format.  The origin <strong>origin</strong> must match the origin in the
file.  (See the note for <strong>vector_field</strong> for further
explanation.) A Fourier phase factor specified by the three integer
momentum components multiplies the wave function.
</p>
<hr size="6">
<a name="vector_005fpropagator_005ffile"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#vector_005ffield_005ffm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dirac_005ffield" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="vector_005fpropagator_005ffile-1"></a>
<h4 class="subsubsection">7.1.4.13 vector_propagator_file</h4>
<a name="index-vector_005fpropagator_005ffile-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">ncolor &lt;int&gt;
</pre></td></tr></table>

<p>Our USQCD-formatted propagator files include the source fields with
the solution fields.  In this case the source field is to be taken
from the file specified in the propagator stanza below.
</p>
<hr size="6">
<a name="dirac_005ffield"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#vector_005fpropagator_005ffile" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dirac_005ffield_005ffm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dirac_005ffield-1"></a>
<h4 class="subsubsection">7.1.4.14 dirac_field</h4>
<a name="index-dirac_005ffield-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
nsource &lt;int&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Reads <strong>nsource</strong> Dirac field sources from a file in SciDAC
format.  The origin <strong>origin</strong> must match the origin in the
file. (See the note for <strong>vector_field</strong> for further
explanation.)  A Fourier phase factor specified by the three integer
momentum components multiplies the wave function.
</p>
<p>The <strong>nsource</strong> Counts colors times spins, so it should be 12 for
a conventional Dirac source.
</p>
<hr size="6">
<a name="dirac_005ffield_005ffm"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#dirac_005ffield" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dirac_005fpropagator_005ffile" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dirac_005ffield_005ffm-1"></a>
<h4 class="subsubsection">7.1.4.15 dirac_field_fm</h4>
<a name="index-dirac_005ffield_005ffm-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">origin &lt;int[4]&gt;
load_source &lt;char[] = file_name&gt;
momentum &lt;int[3]&gt;
</pre></td></tr></table>

<p>Reads exactly 12 Dirac field sources from a file in FNAL format.  The
origin <strong>origin</strong> must match the origin in the file. (See the
note for <strong>vector_field</strong> for further explanation.)  A Fourier
phase factor specified by the three integer momentum components
multiplies the wave function.
</p>
<hr size="6">
<a name="dirac_005fpropagator_005ffile"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#dirac_005ffield_005ffm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Base-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dirac_005fpropagator_005ffile-1"></a>
<h4 class="subsubsection">7.1.4.16 dirac_propagator_file</h4>
<a name="index-dirac_005fpropagator_005ffile-source"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">nsource &lt;int&gt;
</pre></td></tr></table>

<p>Our USQCD-formatted propagator files include the source fields with
the solution fields.  In this case the source field is to be taken
from the file specified in the propagator stanza below.  The number of
source to use is specified by <strong>nsource</strong>.
</p>

<hr size="6">
<a name="Modified-sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#dirac_005fpropagator_005ffile" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#complex_005ffield-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Modified-sources-1"></a>
<h3 class="subsection">7.1.5 Modified sources</h3>
<a name="index-Modified-sources"></a>

<p>The base sources described above can be used directly for computing
propagators, but they can also be modified.  The modifications are
defined by a sequence of operators acting on the base sources and on
the previously modified sources.  The same operators are used at the
propagator sink, as described below.  The only difference is that the
source operators act on only the source time slice, whereas the sink
operators act on all sink time slices.
</p>
<p>The operator definition starts by specifying the number of modified
sources, followed by that many stanzas describing the
modifications. Choices for the <strong>[operator_stanza]</strong> are
explained below.
</p>
<p>At present all sources are referred to by integers.  The enumeration
of the sources is consecutive from zero, starting with the base
sources and continuing with the modified sources.  Thus after n base
sources the first modified source is source number n.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_modified_sources &lt;int =  m&gt;

# source n

[operator_stanza]

# source n+1

[operator_stanza]

etc.

# source n+m-1

[operator_stanza]
</pre></td></tr></table>

<p>Each <strong>[operator_stanza]</strong> has the following structure.  Items in
brackets [] are explained below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&lt;char[] operator_name&gt;
source &lt;int&gt;
[operator_parameters]
op_label &lt;char[]&gt;
[save_source_specification]
</pre></td></tr></table>

<p>Choices for <strong>operator_name</strong> and the corresponding
<strong>[operator_parameteers]</strong> are described in detail below.
</p>
<p>The <strong>source</strong> line specifies the previous source upon which the
operator acts.  This source can be either a previously defined base
source or modified source.
</p>
<p>The <strong>op_label</strong> and <strong>[save_source_specification]</strong> are
the same as for the base sources.  Again, in the current code version,
a request to save a source is ignored unless the source is also used
to construct a propagator.
</p>
<p>Here are possible choices for the <strong>[operator_stanza]</strong>.
As with the base sources, each has its specific set of parameters.
</p>
<p>The first set of operators specify convolutions with a complex field,
which can be applied to both staggered and Dirac fiels:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#complex_005ffield-operator">7.1.5.1 complex_field operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#complex_005ffield_005ffm-operator">7.1.5.2 complex_field_fm operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#evenandodd_005fwall-operator">7.1.5.3 evenandodd_wall operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#gaussian-operator">7.1.5.4 gaussian</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#identity-operator">7.1.5.5 identity operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#wavefunction-operator">7.1.5.6 wavefunction operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>The second set apply covariant smearing and derivatives, which can
also be applied to both staggered and Dirac fiels:
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#covariant_005fgaussian-operator">7.1.5.7 covariant_gaussian operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#deriv1-operator">7.1.5.8 deriv1 operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#deriv2_005fD-operator">7.1.5.9 deriv2_D operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#deriv2_005fB-operator">7.1.5.10 deriv2_B operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#deriv3_005fA-operator">7.1.5.11 deriv3_A operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#fat_005fcovariant_005fgaussian-operator">7.1.5.12 fat_covariant_gaussian operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>The third set is peculiar to staggered fermions:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#funnywall1-operator">7.1.5.13 funnywall1 operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#funnywall2-operator">7.1.5.14 funnywall2 operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>The fourth set is used only with Dirac fermions:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#rotate_005f3D-operator">7.1.5.15 funnywall2 operator</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>Here are the operators that do convolutions with a complex field:
</p>
<hr size="6">
<a name="complex_005ffield-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Modified-sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#complex_005ffield_005ffm-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="complex_005ffield-operator-1"></a>
<h4 class="subsubsection">7.1.5.1 complex_field operator</h4>
<a name="index-complex_005ffield-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">load_source &lt;char[]&gt;
</pre></td></tr></table>

<p>The complex field is contained the specified file (SciDAC format).
The convolution takes place on the time slice of the underlying source.
</p>
<hr size="6">
<a name="complex_005ffield_005ffm-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#complex_005ffield-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#evenandodd_005fwall-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="complex_005ffield_005ffm-operator-1"></a>
<h4 class="subsubsection">7.1.5.2 complex_field_fm operator</h4>
<a name="index-complex_005ffield_005ffm-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">load_source &lt;char[]&gt;
</pre></td></tr></table>

<p>Same as <strong>complex_field</strong>, but the file is in FNAL format.
</p>
<hr size="6">
<a name="evenandodd_005fwall-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#complex_005ffield_005ffm-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#gaussian-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="evenandodd_005fwall-operator-1"></a>
<h4 class="subsubsection">7.1.5.3 evenandodd_wall operator</h4>
<a name="index-evenandodd_005fwall-operator"></a>

<p>There are no additional parameters.  This convolution is equivalent to
a projection onto zero momentum.  In other words it replaces the
source value at each site on the underlying source time slice with the
time-slice sum of the underlying source.
</p>
<hr size="6">
<a name="gaussian-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#evenandodd_005fwall-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#identity-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="gaussian-1"></a>
<h4 class="subsubsection">7.1.5.4 gaussian</h4>
<a name="index-gaussian-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">r0 &lt;float&gt;
</pre></td></tr></table>

<p>The convolution uses a Gaussian of width r0 (centered at the origin).
The convention for the width <strong>r0</strong> is the same as for the
<strong>gaussian</strong> base source.
</p>
<hr size="6">
<a name="identity-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#gaussian-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#wavefunction-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="identity-operator-1"></a>
<h4 class="subsubsection">7.1.5.5 identity operator</h4>
<a name="index-identity-operator"></a>

<p>There are no parameters.  This operator simply produces a copy.  There
should be no need to use it for sources, but it has a use as a sink
operator, as described below.
</p>
<hr size="6">
<a name="wavefunction-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#identity-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#covariant_005fgaussian-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="wavefunction-operator-1"></a>
<h4 class="subsubsection">7.1.5.6 wavefunction operator</h4>
<a name="index-wavefunction-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">wavefunction
load_source &lt;char[]&gt;
a &lt;float&gt;
</pre></td></tr></table>

<p>This convolution uses the wave function in the specified ASCII file. As
with the analogous base source, the wave function is in physical (fm)
units.  It is converted to lattice units using lattice spacing <strong>a</strong>.
</p>
<hr size="6">
<a name="covariant_005fgaussian-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#wavefunction-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deriv1-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="covariant_005fgaussian-operator-1"></a>
<h4 class="subsubsection">7.1.5.7 covariant_gaussian operator</h4>
<a name="index-covariant_005fgaussian-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">r0 &lt;float&gt;
source_iters &lt;int = n&gt;
</pre></td></tr></table>

<p>This operator applies a covariant Gaussian with the specified width
and iterations. It is define by 
 <!-- MATH
 $[1 + r_0^2 D^2/n]^2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="101" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_19.png"
 ALT="$[1 + r_0^2 D^2/n]^2$"></SPAN> 
The discrete covariant Laplacian 
 <SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="milcv7_20.png"
 ALT="$D^2$"></SPAN> 
is constructed from
the original unfattened gauge field.
</p>
<hr size="6">
<a name="deriv1-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#covariant_005fgaussian-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deriv2_005fD-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deriv1-operator-1"></a>
<h4 class="subsubsection">7.1.5.8 deriv1 operator</h4>
<a name="index-deriv1-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">dir &lt;x|y|z&gt;
disp &lt;int = d&gt;
weights &lt;float[d]&gt;
</pre></td></tr></table>

<p>This operator applies a covariant finite difference in the direction
specified by <strong>dir</strong>. The difference operation is specified by a
template over <strong>2d+1</strong> lattice sites with the specified weights.
So to get the central finite difference, use disp 1 and weights 1.
</p>
<hr size="6">
<a name="deriv2_005fD-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#deriv1-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deriv2_005fB-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deriv2_005fD-operator-1"></a>
<h4 class="subsubsection">7.1.5.9 deriv2_D operator</h4>
<a name="index-deriv2_005fD-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">dir &lt;x|y|z&gt; &lt;x|y|z&gt;
disp &lt;int = d&gt;
weights &lt;fload[d]&gt;
</pre></td></tr></table>

<p>Computes a symmetric covariant second derivative based on the
specified template and directions.  That is for <strong>dir x y</strong> the
operation results in <strong>D_x D_y + D_y D_x</strong>, where <strong>D_i</strong> is
the <strong>deriv1</strong> operation above.
</p>
<hr size="6">
<a name="deriv2_005fB-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#deriv2_005fD-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deriv3_005fA-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deriv2_005fB-operator-1"></a>
<h4 class="subsubsection">7.1.5.10 deriv2_B operator</h4>
<a name="index-deriv2_005fB-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">dir &lt;x|y|z&gt; &lt;x|y|z&gt;
disp &lt;int = d&gt;
weights &lt;float[d]&gt;
</pre></td></tr></table>

<p>Computes an antisymmetric covariant second derivative based on the
specified template and directions.  That is, for <strong>dir x y</strong> the
operation results in <strong>D_x D_y - D_y D_x</strong>, where <strong>D_i</strong> is
the <strong>deriv1</strong> operation above.
</p>
<hr size="6">
<a name="deriv3_005fA-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#deriv2_005fB-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#fat_005fcovariant_005fgaussian-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deriv3_005fA-operator-1"></a>
<h4 class="subsubsection">7.1.5.11 deriv3_A operator</h4>
<a name="index-deriv3_005fA-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">disp &lt;int = d&gt;
weights &lt;float[d]&gt;
</pre></td></tr></table>

<p>This operation is not yet supported.
</p>
<hr size="6">
<a name="fat_005fcovariant_005fgaussian-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#deriv3_005fA-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#funnywall1-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="fat_005fcovariant_005fgaussian-operator-1"></a>
<h4 class="subsubsection">7.1.5.12 fat_covariant_gaussian operator</h4>
<a name="index-fat_005fcovariant_005fgaussian-operator"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">r0 &lt;float&gt;
source_iters &lt;int&gt;
</pre></td></tr></table>

<p>This operation is the same as covariant_gaussian, except that the APE
smeared links are used.  See the gauge-field description above for
APE smearing.
</p>
<hr size="6">
<a name="funnywall1-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#fat_005fcovariant_005fgaussian-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#funnywall2-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="funnywall1-operator-1"></a>
<h4 class="subsubsection">7.1.5.13 funnywall1 operator</h4>
<a name="index-funnywall1-operator"></a>

<p>No parameters.  This operation applies the staggered fermion
&ldquo;funnywall1&rdquo; operator that couples to a subset of tastes.  It is
meaningful only for staggered fermion sources and propagators.
</p>
<hr size="6">
<a name="funnywall2-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#funnywall1-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rotate_005f3D-operator" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="funnywall2-operator-2"></a>
<h4 class="subsubsection">7.1.5.14 funnywall2 operator</h4>
<a name="index-funnywall2-operator"></a>

<p>Same as above, but for the &ldquo;funnywall2&rdquo; operator.
</p>
<hr size="6">
<a name="rotate_005f3D-operator"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#funnywall2-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Propagator-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Modified-sources" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="funnywall2-operator-1"></a>
<h4 class="subsubsection">7.1.5.15 funnywall2 operator</h4>
<a name="index-funnywall2-operator-1"></a>

<table><tr><td>&nbsp;</td><td><pre class="example">d1 &lt;float&gt;
</pre></td></tr></table>

<p>This operator applies the FNAL 3D rotation to a Dirac source or sink.
</p>

<hr size="6">
<a name="Propagator-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#rotate_005f3D-operator" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Quark-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Propagator-description-1"></a>
<h3 class="subsection">7.1.6 Propagator description</h3>
<a name="index-Propagator-description"></a>

<p>Propagators are solutions to the inhomogeneous Dirac equation with
either base or modified sources.  These solutions can then be modified
at the sink to implement appropriate sink interpolating operators.
For simplicity we call the unmodified propagators &ldquo;propagators&rdquo; and
the modified propagators &ldquo;quarks&rdquo;.  The &ldquo;quarks&rdquo; are used to
construct the hadron propagators.  Here we describe the
&ldquo;propagators&rdquo;.
</p>
<p>The code generates three classes of propagators, namely clover, naive,
and &ldquo;extended naive&rdquo;.  The naive propagator is constructed starting
from a (uually improved) staggered propagator, and multiplying by a
spin matrix that reverses the Kawamoto-Smit staggered spin rotation.
The extended naive propagator is singled out because the source
treatment is special.  It is intended for applications that generate a
naive propagator from the special extended Dirac sources produced by
the <strong>ext_src</strong> application.  In that case four staggered
inversions are required for each Dirac source, one for each of the
four spin components.  The extended Dirac source on a single time
slice is usually the value on that time slice of a Dirac propagator
that started propagation from an underlying source on a distant time
slice. So there is one extended Dirac source for each spin and color
of the underlying source.  The number of staggered inversions is
therefore four times the number of underlying spins and colors.
</p>
<p>One must pay particular attention to the spin structure in the
conversion from a staggered to a naive propagator.  The spin matrix in
the conversion depends on the source and sink 2^4 hypercube
coordinates.  The sink dependence is not problematic.  The source
dependence is, however.  The conversion fails when the source for the
staggered propagator has support on different hypercube sites.  Thus,
as a rule, the source for a naive propagator should be constructed
with the <strong>subset corner</strong> mask, so it has support on only the
hypercube origins.  For the special case of an extended naive
propagator, the spin conversion is partially done in the
<strong>ext_src</strong> application and completed in the
<strong>clover_invert2</strong> application.  In this way the extended source
can have support on all spatial sites on the source time slice.  If
the extended source is not constructed by the <strong>ext_src</strong>
application, it, too, should be restricted to the hypercube origins.
</p>
<p>The propagators are specified in a manner similar to the sources.  The
number of propagators is specified, followed by that many stanzas, one
for each propagator.
</p>

<table><tr><td>&nbsp;</td><td><pre class="example">number_of_propagators &lt;int p&gt;

# propagator 0

[propagator_stanza]

# propagator 1

[propagator_stanza]

...

# propagator p-1

[propagator_stanza]
</pre></td></tr></table>

<p>The <strong>[propagator_stanza]</strong> has the following structure;
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">[propagator_type]
[propagator_parameters]
check &lt;yes|no&gt;
error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;
precision &lt;1|2&gt;
momentum_twist &lt;float[3]&gt;
time_bc &lt;periodic|antiperiodic&gt;
source &lt;int&gt;
[propagator input specification]
[propagator output specification]
</pre></td></tr></table>

<p>There are three propagator types with their corresponding parameters:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">propagator_type clover
kappa &lt;float&gt;
clov_c &lt;float&gt;
</pre></td></tr></table>
<p>These lines specify a clover propagator and its parameters.
The <strong>clov_c</strong> factor multiplies a tadpole factor of 1/u0^3,
resulting in an effective clover coefficient of <strong>clov_c/u0^3</strong>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">propagator_type KS
mass &lt;float&gt;
# With naive HISQ quarks, we also have ...
naik_term_epsilon &lt;float&gt;
</pre></td></tr></table>

<p>These lines specify a naive propagator with its mass.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">propagator_type KS4
mass &lt;float&gt;
</pre></td></tr></table>

<p>These lines specify an extended naive propagator, starting from an
extended <strong>KS4</strong>-type Dirac source.  (Please see the discussion
above about the spin conversion.)
</p>
<p>The <strong>check</strong> line specifies whether the code should calculate or
recalculate the propagator.  If the propagator is unknown, of course,
we would want to compute it from the specified source.  If the
propagator is being read from a file, we might still want to check it
by handing its source and supposed solution to the inverter.  One or
two CG iterations may be all that is needed to check it.  In both
cases we would say <strong>check yes</strong>.  If the propagator is being
read from a file, and we prefer not to check it, we would say
<strong>check no</strong>.  In that case, it doesn&rsquo;t matter what source we
associate it with, since the source would not be used.
</p>
<p>The <strong>error_for_propagator</strong> specifies the desired upper bound
for the Cartesian norm ratio
<!-- MATH
 $|resid|/|source|$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="113" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_21.png"
 ALT="$\vert resid\vert/\vert source\vert$"></SPAN>
where <strong>resid</strong> is the residual vector.  Note, this is not the
squared upper bound.  The <strong>rel_error_for_propagator</strong> specifies
the desired upper bound for the &ldquo;relative norm&rdquo;
<!-- MATH
 $\sqrt{\sum_x|resid(x)|^2/|soln(x)|^2/V}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="218" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="milcv7_22.png"
 ALT="$\sqrt{\sum_x\vert resid(x)\vert^2/\vert soln(x)\vert^2/V}$"></SPAN>
where <strong>|resid(x)|</strong> is the magnitude of the residual vector
(magniude of the Dirac spinor or color vector) on a single site
<strong>x</strong>, <strong>|soln(x)|</strong> is the magnitude of the solution vector
on a single site <strong>x</strong> and <strong>V</strong> is the lattice volume.  The
relative norm is preferred over the Cartesian norm for heavy quark
propagators that decrease sharply, since it is sensitive to the small
components.
</p>
<p>The <strong>precision</strong> line specifies whether the propagator is to be
computed in single or double precision.  This feature is supported in
if the code is compiled with QOPQDP package, but not otherwise.
</p>
<p>The <strong>momentum_twist</strong> injects momentum through the so-called
&quot;boundary twist&quot;.  Three twist angles are specified for the x, y, and
z directions.  They are given in units of pi/L.  Thus a twist of 1
changes the standard periodic boundary condition in the corresponding
spatial direction to antiperiodic.
</p>
<p>The <strong>time_bc</strong> specifies whether to use periodic or antiperiodic
boundary conditions in the time direction.
</p>
<p>The <strong>source</strong> line specifies the source sequence number for the
source upon which the propagator is built.
</p>
<p>For <strong>clover</strong> and <strong>KS4</strong> type propagators the
<strong>[propagator input specification]</strong> has the syntax
</p><table><tr><td>&nbsp;</td><td><pre class="example">fresh_wprop |
continue_wprop |
reload_ascii_wprop &lt;char[]&gt; |
reload_serial_wprop &lt;char[]&gt; |
reload_parallel_wprop &lt;char[]&gt;
</pre></td></tr></table>
<p>For the standard naive propagator (type <strong>KS</strong>) the
<strong>[propagator input specification]</strong> has the form
</p><table><tr><td>&nbsp;</td><td><pre class="example">fresh_ksprop |
continue_ksprop |
reload_ascii_ksprop &lt;char[]&gt; |
reload_serial_ksprop &lt;char[]&gt; |
reload_parallel_ksprop &lt;char[]&gt;
</pre></td></tr></table>
<p>Both of these imitate the corresponding specifications for the gauge field.
</p>
<p>Likewise, the output specification for <strong>clover</strong> and
<strong>KS4</strong> propagators has the form
</p><table><tr><td>&nbsp;</td><td><pre class="example">forget_wprop |
save_ascii_wprop &lt;char[]&gt; |
save_serial_fm_wprop &lt;char[]&gt; |
save_serial_fm_sc_wprop &lt;char[]&gt; |
save_serial_scidac_wprop &lt;char[]&gt; |
save_parallel_scidac_wprop &lt;char[]&gt; |
save_partfile_scidac_wprop &lt;char[]&gt; |
save_multifile_scidac_wprop &lt;char[]&gt; |
</pre></td></tr></table>

<p>and for type <strong>KS</strong> propagators,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">forget_wprop |
save_ascii_wprop &lt;char[]&gt; |
save_serial_fm_wprop &lt;char[]&gt; |
save_serial_fm_sc_wprop &lt;char[]&gt; |
save_serial_scidac_wprop &lt;char[]&gt; |
save_parallel_scidac_wprop &lt;char[]&gt; |
save_partfile_scidac_wprop &lt;char[]&gt; |
save_multifile_scidac_wprop &lt;char[]&gt; |
</pre></td></tr></table>


<hr size="6">
<a name="Quark-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Propagator-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hadron-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Quark-description-1"></a>
<h3 class="subsection">7.1.7 Quark description</h3>
<a name="index-Quark-description"></a>

<p>In the terminology of the code &ldquo;quarks&rdquo; are &ldquo;propagators&rdquo; with a
sink treatment applied.  The sink treatment can be a trivial identity
operator.  Each quark is constructed by operating (with one of the
several operators) on a previoiusly defined propagator or a previously
defined quark.  In this code hadrons are built from quarks, but not
directly from propagators. Propagators are referred to by their
sequence number, starting with zero.  Quarks are referred to by their
sequence number, also starting with zero.  In this respect the
convention differs from the convention for the base and modified
sources.  The specification for quarks is similar to that for
propagators.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_quarks &lt;int q&gt;

# quark 0

[quark_stanza]

# quark 1

[quark_stanza]

...

# quark q-1

[quark_stanza]
</pre></td></tr></table>

<p>The <strong>[quark_stanza]</strong> has the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">propagator|quark &lt;int&gt;
[operator_specification]
op_label &lt;char[]&gt;
[propagator_output]
</pre></td></tr></table>

<p>The first line specifies either a <strong>propagator</strong> index or a
<strong>quark</strong> index.  The choices for the
<strong>[operator_specification]</strong> are the same as for the modified
sources above, with the exception that the operators act on the
propagator/quark field on all time slices.  Other parameters have the
same function as above.
</p>

<hr size="6">
<a name="Hadron-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Quark-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clover_005finvert2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Hadron-description-1"></a>
<h3 class="subsection">7.1.8 Hadron description</h3>
<a name="index-Hadron-description"></a>

<p>Hadron correlators are formed by tying together the &ldquo;quarks&rdquo; at the
source and sink.  Correlators for both mesons and baryons (to some
extent) and a special &ldquo;open meson&rdquo; correlator are supported.  (The
open meson omits tying the sink spins and colors together.  Thus the
open meson correlator consists of a complex 12 by 12 matrix field.  It
is written in FermiQCD binary format for post processing.)
</p>
<p>The hadron specification starts with the number of &ldquo;pairings&rdquo; of
quarks, followed by that many hadron stanzas:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_pairings &lt;int h&gt;

# pair 0

[hadron_stanza]

# pair 1

[hadron_stanza]

...

# pair h-1
</pre></td></tr></table>

<p>[hadron_stanza]
</p>
<p>A hadron stanza has the following structure
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">pair &lt;int&gt; &lt;int&gt;
spectrum_request &lt;[meson],[baryon]|open_meson&gt;
save_corr_fnal &lt;char[]&gt;
r_offset &lt;int[4]&gt;
number_of_correlators &lt;int&gt;
&lt;correlator_line&gt;
&lt;correlator_line&gt;
...
&lt;correlator_line&gt;
</pre></td></tr></table>

<p>The <strong>pair</strong> line gives the sequence numbers of the &ldquo;quarks&rdquo; to
be used to form the mesons or baryons in this stanza.  In the case of
mesons the first quark index in the <strong>pair</strong> line refers to the
antiquark and the second, to the quark.  In the case of baryons,
currently, the code supports only correlators in which at least two of
the three valence quarks are identical and form protons,
deltas, and lambdas.
</p>
<p>The <strong>spectrum_request</strong> line specifies the types of hadron
correlators to be computed.  The request is written as a
comma-separated string with no white space.  The code does not compute
both open meson and &ldquo;closed&rdquo; hadron propagators for a given pairing.
</p>
<p>The <strong>save_corr_fnal</strong> line specifies a file to which all
correlators in this pairing are written.  The format follows a style
introduced by the Fermilab Lattice collaboration.  Note that data is
always appended to the file.
</p>
<p>The <strong>r_offset</strong> causes the sink hadron locations (and
correlators) to be defined relative to the specified offset
coordinate.  If the source is specified at the same coordinate, the
result should be the same as translating the gauge field by minus this
coordinate and putting the source at the zero origin with zero offset.
</p>
<p>The correlator lines are for mesons only.  They specify the source and
sink gamma matrices, phase factors, and momentum projections.  They
have the syntax
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">correlator &lt;char[] = label&gt; &lt;char[] = momlabel&gt; 
   &lt;1|-1|i|-i&gt; &lt;*|/&gt; &lt;float = norm&gt; &lt;Gsource&gt; &lt;Gsink&gt; 
   &lt;int[3] = mom&gt; &lt;char[3] = E|O|EO = reflection_parity&gt;
</pre></td></tr></table>

<p>Here is a specific example of nine related correlators:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">correlator RHO     p100  1 * 1 GX  GX  1 0 0 E E E
correlator RHO     p100  1 * 1 GX  GX  0 1 0 E E E
correlator RHO     p100  1 * 1 GX  GX  0 0 1 E E E
correlator RHO     p100  1 * 1 GY  GY  1 0 0 E E E
correlator RHO     p100  1 * 1 GY  GY  0 1 0 E E E
correlator RHO     p100  1 * 1 GY  GY  0 0 1 E E E
correlator RHO     p100  1 * 1 GZ  GZ  1 0 0 E E E
correlator RHO     p100  1 * 1 GZ  GZ  0 1 0 E E E
correlator RHO     p100  1 * 1 GZ  GZ  0 0 1 E E E
</pre></td></tr></table>

<p>Here the correlator <strong>label</strong> is RHO and <strong>momlabel</strong> is
p100.  Correlators with the same combination of <strong>label</strong> and
<strong>momlabel</strong>, as in this example, are averaged.  The fourth field
specifies the phase that multiplies the correlator.  Choices are 1,
-1, i, and -i. The fifth and sixth fields specify a normalization
factor, which is multiplied or divided, as specified by the fifth
field.
</p>
<p>The source and sink gamma matrices are denoted G1 G5 GX GY GZ GT GXY
GZX GYZ GXT GYT GZT G5X G5Y G5Z G5T, where G1 is the identity, and the
others should be obvious.  Note that it has been an unfortunate but
unbroken tradition in our code to use the wrong sign for GY, so in
cases where it matters, this can be corrected with an appropriate
phase factor.
</p>
<p>The momentum px, py, pz is specified by three integers kx ky kz in
units of 2 pi/nx, 2 pi/ny, and 2 pi/nz.  The phase factor for the
momentum Fourier transform is usually exp(ip_j*r_j) for each direction
j, but we usually want to combine results with momentum p_j and -p_j.
Rather than having to enumerate all the signs, which would double the
number of lines in this example, and cause worse proliferation for
momentum 1 1 1, we simply specify whether the results for opposite
momentum components are to be added or subtracted.  With E we add
them, so the Fourier phase factor becomes  cos(p_j*r_j).  With O we
subtract, so it becomes sin(p_j*r_j).  With EO the exp(ip_j*r_j) is
kept and the correlator with the opposite momentum component is
ignored.  This reflection parity is specified for each of the three
directions in the order x, y, z.
</p>

<hr size="6">
<a name="ks_005fspectrum"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hadron-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-geometry-etc_002e-specification" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="ks_005fspectrum-1"></a>
<h2 class="section">7.2 ks_spectrum</h2>
<a name="index-ks_005fspectrum"></a>

<p>This code generates staggered propagators from a wide variety of
sources and ties them together to form meson and baryon correlators.
Actions supported include asqtad and HISQ.  Like the clover_invert2
code, this code is designed to be flexible in specifying source
interpolating operators, propagators, sink interpolating operators,
and the combinations to form hadrons.  The design is similar to the
clover_invert2 code. In broad terms a hadron is contructed by tying
together quark and antiquark propagators.  These quark propagators are
generated in a succession of steps.  First a base source is defined.
A base source can then be modified by applying a sequence of source
operators to complete the definition of the source interpolating
operator.  The propagator starts at the source and propagates to
any sink location.  At the sink a variety of operators can be applied
to form the completed quark propagator.  They are then used to form
the hadrons.
</p>
<p>Because of the high degree of flexibility in the code. the parameter
input file is highly structured.  We explain here the construction of
the parameter input file in some detail.  Examples can be found in the
directory <strong>ks_spectrum/test/*.sample-in</strong>.
</p>
<p>The parameter input file consists of the following required parts in
this order:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#KS-geometry-etc_002e-specification">7.2.1 KS geometry etc. specification</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-gauge-field-specification">7.2.2 KS gauge field specification</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-quark-condensate-specification">7.2.3 KS quark condensate specification</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-base-sources">7.2.4 KS base sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-modified-sources">7.2.5 KS modified sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-propagator-set-description">7.2.6 KS propagator set description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-quark-description">7.2.7 KS quark description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-meson-description">7.2.8 KS meson description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#KS-baryon-description">7.2.9 KS baryon description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>This complete set of commands can be repeated indefinitely to form a
chain of consecutive computations.
</p>
<p>For human readability, comments on lines beginning with hash (#) are
allowed in the parameter input file.  Blank lines are also permitted.
</p>
<br>

<hr size="6">
<a name="KS-geometry-etc_002e-specification"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-gauge-field-specification" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-geometry-etc_002e-specification-1"></a>
<h3 class="subsection">7.2.1 KS geometry etc. specification</h3>
<a name="index-KS-geometry-etc_002e-specification"></a>

<p>The geometry specification is the same as for the
<strong>clover_invert2</strong> code.  See section <a href="#Geometry-etc_002e-specification">Geometry etc. specification</a>.
</p>
<hr size="6">
<a name="KS-gauge-field-specification"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-geometry-etc_002e-specification" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-quark-condensate-specification" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-gauge-field-specification-1"></a>
<h3 class="subsection">7.2.2 KS gauge field specification</h3>
<a name="index-KS-gauge-field-specification"></a>

<p>The gauge field specification is the same as for the
<strong>clover_invert2</strong> code.  See section <a href="#Gauge-field-specification">Gauge field specification</a>.
</p>
<hr size="6">
<a name="KS-quark-condensate-specification"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-gauge-field-specification" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-base-sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-quark-condensate-specification-1"></a>
<h3 class="subsection">7.2.3 KS quark condensate specification</h3>
<a name="index-KS-quark-condensate-specification"></a>

<p>Provision is made for calculating the chiral condensate for any number
of masses.  This input section starts by specifying the number of such
masses.  If no chiral condensates are to be computed, this number
should be zero and no other input lines are required.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_pbp_masses &lt;int = n&gt;

max_cg_iterations &lt;int&gt;
max_cg_restarts &lt;int&gt;
npbp_reps &lt;int&gt;
prec_pbp &lt;1|2&gt;

# mass 0

mass &lt;float&gt;
error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;

# mass 1

mass &lt;float&gt;
error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;

etc.

# mass n-1

mass &lt;float&gt;
error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;
</pre></td></tr></table>

<p>The <strong>max_cg_iterations</strong> and <strong>max_cg_restarts</strong> control
the conjugate gradient iterations.  The overall maximum number of
iterations is the product of thse two.
</p>
<p>The chiral condensate is calculated using a stochastic estimator.  The
number of such estimators is specified by the <strong>npbp_reps</strong> line.
The precision of the conjugate gradient calculation is specified by
<strong>prec_pbp</strong>.  This request has effect only if the code is built
with the SciDAC QOP package.
</p>
<p>The remaining stanzas specify the masses and the stopping condition
for the conjugate gradient. The conventions for residual errors are
explained in the <strong>clover_invert2</strong> propagator
specification. See section <a href="#Propagator-description">Propagator description</a>.
</p>
<p>With HISQ actions it is also necessary to specify the Naik term
epsilon parameter for each mass, so an additional line is required in
each mass stanza:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">mass &lt;float&gt;
naik_term_epsilon &lt;float&gt;
error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;
</pre></td></tr></table>

<hr size="6">
<a name="KS-base-sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-quark-condensate-specification" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-modified-sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-base-sources-1"></a>
<h3 class="subsection">7.2.4 KS base sources</h3>
<a name="index-KS-base-sources"></a>

<p>The base sources are specified in the same manner as for the
<strong>clover_invert2</strong> code, except that Dirac sources are not
appropriate. They are not repeated here. See section <a href="#Base-sources">Base sources</a>.
</p>
<hr size="6">
<a name="KS-modified-sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-base-sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-propagator-set-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-modified-sources-1"></a>
<h3 class="subsection">7.2.5 KS modified sources</h3>
<a name="index-KS-modified-sources"></a>

<p>The base sources are modified in the same was as for the
<strong>clover_invert2</strong> code.  The description is not repeated
here. See section <a href="#Modified-sources">Modified sources</a>.  As before, the numbering is
sequential, starting with the base sources and continuing with the
modified sources.
</p>
<hr size="6">
<a name="KS-propagator-set-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-modified-sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-quark-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-propagator-set-description-1"></a>
<h3 class="subsection">7.2.6 KS propagator set description</h3>
<a name="index-KS-propagator-set-description"></a>

<p>As with the <strong>clover_invert</strong> code, we first define
&ldquo;propagators&rdquo; that start from either base sources or modified
sources.  A series of sink operators then act on propagators,
resulting in &ldquo;quarks&rdquo;.  They, in turn are tied together to form
mesons and baryons.  Unlike the <strong>clover_invert</strong> code, the
staggered fermion propagators are defined in &ldquo;sets&rdquo; that share a
common source and differ only in their masses.  This organization
allows more efficient use of the multimass inverters.  Sets are
defined with the following series of input lines:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_sets &lt;int = s&gt;

# set 0

[set_stanza]

# set 1

[set_stanza]

etc.

# set s-1

[set_stanza]
</pre></td></tr></table>

<p>The <strong>[set_stanza]</strong> begins with parameters common to all
memberso of the set:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">max_cg_iterations &lt;int&gt;
max_cg_restarts &lt;int&gt;
check &lt;yes|no&gt;
momentum_twist &lt;float[3]&gt;
time_bc &lt;periodic|antiperiodic&gt;
source &lt;int&gt;
</pre></td></tr></table>

<p>The above parameters have the same meaning as the corresponding
parameters for the <strong>clover_invert2</strong> code. See section <a href="#Propagator-description">Propagator description</a>.
</p>
<p>The <strong>[set_stanza]</strong> continues with a list of parameters for each
propagator in the set.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_propagators &lt;int=p&gt;

# propagator 0

[propagator_stanza]

# propagator 1

[propagator_stanza]

etc.

# propagator p-1

[propagator_stanza]
</pre></td></tr></table>

<p>Propagators are numbered sequentially starting with zero and
continuing into the next set.  So after the first set with <strong>p</strong>
propagators, the first propagator in the second set is number
<strong>p</strong>.
</p>
<p>The propagator stanza is simply
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">mass &lt;float&gt;
# If HISQ, we also have ...
naik_term_epsilon &lt;float&gt;

error_for_propagator &lt;float&gt;
rel_error_for_propagator &lt;float&gt;

# Propagator input specification
fresh_ksprop |
continue_ksprop |
reload_ascii_ksprop &lt;char[]&gt; |
reload_serial_ksprop &lt;char[]&gt; |
reload_parallel_ksprop &lt;char[]&gt;

# Propagator output specification
forget_ksprop |
save_ascii_ksprop &lt;char[]&gt; |
save_serial_scidac_ksprop &lt;char[]&gt; |
save_parallel_scidac_ksprop &lt;char[]&gt; |
save_partfile_scidac_ksprop &lt;char[]&gt; |
save_multifile_scidac_ksprop &lt;char[]&gt; |
</pre></td></tr></table>

<hr size="6">
<a name="KS-quark-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-propagator-set-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-meson-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-quark-description-1"></a>
<h3 class="subsection">7.2.7 KS quark description</h3>
<a name="index-KS-quark-description"></a>

<p>The &ldquo;quarks&rdquo; are constructed exactly as with the
<strong>clover_invert2</strong> code, so the description is not repeated
here. See section <a href="#Quark-description">Quark description</a>.
</p>

<hr size="6">
<a name="KS-meson-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-quark-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#KS-baryon-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-meson-description-1"></a>
<h3 class="subsection">7.2.8 KS meson description</h3>
<a name="index-KS-meson-description"></a>

<p>The meson and baryon specification is very similar to the
specification for the <strong>clover_invert2</strong> code.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_mesons &lt;int m&gt;

# pair 0

[meson_stanza]

# pair 1

[meson_stanza]

...

# pair h-1

[meson_stanza]
</pre></td></tr></table>

<p>The <strong>[meson_stanza]</strong> follows the same pattern as for the
<strong>clover_invert</strong> code:.  See section <a href="#Hadron-description">Hadron description</a>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">pair &lt;int&gt; &lt;int&gt;
spectrum_request meson
save_corr_fnal &lt;char[]&gt;
r_offset &lt;int[4]&gt;
</pre></td></tr></table>

<p>The only <strong>spectrum_request</strong> choice is &ldquo;meson&rdquo; at the moment.
Baryons are specified separately later in this code.  The correlator
output and offset have the same meaning as with the
<strong>clover_invert2</strong> code.
</p>
<p>The <strong>[meson_stanza]</strong> concludes with a specification of the
meson correlators:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_correlators &lt;int&gt;
[correlator_line]
[correlator_line]
...
[correlator_line]
</pre></td></tr></table>

<p>The <strong>[correlator_line]</strong> has the following format:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">correlator &lt;char[] = label&gt; &lt;char[] = momlabel&gt; &lt;1|-1|i|-i&gt; [*/] &lt;float = norm&gt; 
   &lt;spin_taste_sink&gt; &lt;int[3] = mom&gt; &lt;char[3] = E|O|EO = reflection_parity&gt;
</pre></td></tr></table>

<p>As with the <strong>clover_invert2</strong> correlator specification,
correlators with the same label/momlabel are averaged.  The correlator
is multiplied by the specified phase and normalization factor.
</p>
<p>Unlike Dirac quarks, with staggered quarks the source spin-taste
content is built into the source and propagator and cannot be modified
once the propagator is generated.  So only the sink spin-taste
combination is specified in the <strong>correlator</strong> stanza.  To obtain
a variety of sink spin-taste combinations from the same pair of
quarks, it is necessary to use a broad-spectrum source, such as one of
the wall sources.
</p>
<p>Possible sink spin-taste combinations are these:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">pion5,  pion05,  pioni5,  pionij,  pioni,  pioni0,  pions,  pion0,  rhoi,
rhox,  rhoy,  rhoz,  rhoi0,  rhox0,  rhoy0,  rhoz0,  rhoxs,  rhoys,  rhozs,
rhots,  rhois,  rho0,  rhoxsfn,  rhoysfn,  rhozsfn,  rhotsfn,  rhoisfn
</pre></td></tr></table>

<p>For those familiar with it, the labeling follows our conventions in
the older <strong>spectrum_nlpi2</strong> code, except that rhox, rhoy, and
rhoz = rhoi, rhoxs, rhoys, rhozs = rhois, rhots, and the &quot;fn&quot; choices
are new.
</p>
<p>Normally the operator uses a symmetric shift, but the code can be
compiled with -DONE_SIDED_SHIFT to get a one-sided shift
</p>
<p>The &quot;fn&quot; choices use the fat and long links in place of the thin links
for parallel transport, so the vector operator is conserved.  However,
in the current code &quot;fn&quot; is always one-sided and uses only the asqtad
fat links &ndash; not the long links.
</p>
<p>The momentum is specified in the same manner as for the
<strong>clover_invert2</strong> code.
</p>
<hr size="6">
<a name="KS-baryon-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-meson-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ks_005fspectrum" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="KS-baryon-description-1"></a>
<h3 class="subsection">7.2.9 KS baryon description</h3>
<a name="index-KS-baryon-description"></a>

<p>In the <strong>ks_spectrum</strong> code baryons are specified separately from
mesons.  
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_baryons &lt;int b&gt;

# triplet 0

[baryon_stanza]

# pair 1

[baryon_stanza]

...

# pair b-1

[baryon_stanza]
</pre></td></tr></table>

<p>The <strong>[baryon_stanza]</strong> has the following format in analogy with
the <strong>[meson_stanza]</strong>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">triplet &lt;int&gt; &lt;int&gt; &lt;int&gt;
spectrum_request baryon
save_corr_fnal &lt;char[]&gt;
r_offset &lt;int[4]&gt;
</pre></td></tr></table>

<p>and continues with a specification of the correlators
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">number_of_correlators &lt;int&gt;
[correlator_line]
[correlator_line]
...
[correlator_line]
</pre></td></tr></table>

<p>The correlator line has the format
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">correlator &lt;char[] = label&gt; &lt;char[] = momlabel&gt; &lt;1|-1|i|-i&gt; [*/] &lt;float = norm&gt; 
   &lt;sink&gt; 
</pre></td></tr></table>

<p>The only sink choices are &quot;nucleon&quot; and &quot;delta&quot;.
</p>
<p>Currently the code does not support a momentum insertion at the sink.
</p>
<hr size="6">
<a name="Concept-Index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#KS-baryon-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Variable-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Documentation-for-Specific-Applications" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Variable-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Concept-Index-1"></a>
<h1 class="unnumbered">Concept Index</h1>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-Index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-J" class="summary-letter"><b>J</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-cp">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-A-Sample-Applications-Directory">A Sample Applications Directory</a></td><td valign="top"><a href="#A-Sample-Applications-Directory">5.12 A Sample Applications Directory</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Accessing-fields-at-other-sites">Accessing fields at other sites</a></td><td valign="top"><a href="#Accessing-fields-at-other-sites">5.7 Accessing fields at other sites</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-APE-smearing">APE smearing</a></td><td valign="top"><a href="#APE-smearing">7.1.2.4 APE smearing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Asqtad-action">Asqtad action</a></td><td valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Base-sources">Base sources</a></td><td valign="top"><a href="#Base-sources">7.1.4 Base sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Bugs-and-features">Bugs and features</a></td><td valign="top"><a href="#Bugs-and-features">5.13 Bugs and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bugs-reports">bugs reports</a></td><td valign="top"><a href="#Supported-architectures">1.7 Supported architectures</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Building-the-code">Building the code</a></td><td valign="top"><a href="#Building-the-MILC-Code">2. Building the MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Butterflies-_0028FFT_0029">Butterflies (FFT)</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-checking-the-build">checking the build</a></td><td valign="top"><a href="#Checking-the-Build">2.2 Checking the Build</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Clover-inverter">Clover inverter</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-clover_005finvert2">clover_invert2</a></td><td valign="top"><a href="#clover_005finvert2">7.1 clover_invert2</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comdefs_002eh">comdefs.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-command-line-options">command line options</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compilation-Macros">Compilation Macros</a></td><td valign="top"><a href="#Precision">4.3 Precision</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compilation-Macros-1">Compilation Macros</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-complex_002eh">complex.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-complex_005ffield">complex_field</a></td><td valign="top"><a href="#complex_005ffield">7.1.4.1 complex_field</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-complex_005ffield-operator">complex_field operator</a></td><td valign="top"><a href="#complex_005ffield-operator">7.1.5.1 complex_field operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-complex_005ffield_005ffm">complex_field_fm</a></td><td valign="top"><a href="#complex_005ffield_005ffm">7.1.4.2 complex_field_fm</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-complex_005ffield_005ffm-operator">complex_field_fm operator</a></td><td valign="top"><a href="#complex_005ffield_005ffm-operator">7.1.5.2 complex_field_fm operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-config_002eh">config.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Conjugate-gradient-_002d-multimass">Conjugate gradient - multimass</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coordinate-origin">coordinate origin</a></td><td valign="top"><a href="#Coordinate-origin">7.1.2.5 Coordinate origin</a></td></tr>
<tr><td></td><td valign="top"><a href="#Top">Copyright</a></td><td valign="top"><a href="#Top">The MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-corner_005fwall">corner_wall</a></td><td valign="top"><a href="#corner_005fwall">7.1.4.3 corner_wall</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-covariant_005fgaussian-operator">covariant_gaussian operator</a></td><td valign="top"><a href="#covariant_005fgaussian-operator">7.1.5.7 covariant_gaussian operator</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Data-types">Data types</a></td><td valign="top"><a href="#Data-types">5.4 Data types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Debugging">Debugging</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-defines_002eh">defines.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deriv1-operator">deriv1 operator</a></td><td valign="top"><a href="#deriv1-operator">7.1.5.8 deriv1 operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deriv2_005fB-operator">deriv2_B operator</a></td><td valign="top"><a href="#deriv2_005fB-operator">7.1.5.10 deriv2_B operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deriv2_005fD-operator">deriv2_D operator</a></td><td valign="top"><a href="#deriv2_005fD-operator">7.1.5.9 deriv2_D operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deriv3_005fA-operator">deriv3_A operator</a></td><td valign="top"><a href="#deriv3_005fA-operator">7.1.5.11 deriv3_A operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Details-of-gathers-and-creating-new-ones">Details of gathers and creating new ones</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dirac-inverter">Dirac inverter</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dirac_005ffield-source">dirac_field source</a></td><td valign="top"><a href="#dirac_005ffield">7.1.4.14 dirac_field</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dirac_005ffield_005ffm-source">dirac_field_fm source</a></td><td valign="top"><a href="#dirac_005ffield_005ffm">7.1.4.15 dirac_field_fm</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dirac_005fpropagator_005ffile-source">dirac_propagator_file source</a></td><td valign="top"><a href="#dirac_005fpropagator_005ffile">7.1.4.16 dirac_propagator_file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Directory-Layout">Directory Layout</a></td><td valign="top"><a href="#Directory-Layout">4.1 Directory Layout</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dirs_002eh">dirs.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distributing-sites-among-nodes">Distributing sites among nodes</a></td><td valign="top"><a href="#Distributing-sites-among-nodes">5.9 Distributing sites among nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Documentation-for-Specific-Applications">Documentation for Specific Applications</a></td><td valign="top"><a href="#Documentation-for-Specific-Applications">7. Documentation for Specific Applications</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-doubleword-boundaries">doubleword boundaries</a></td><td valign="top"><a href="#Bugs-and-features">5.13 Bugs and features</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-evenandodd_005fwall">evenandodd_wall</a></td><td valign="top"><a href="#evenandodd_005fwall">7.1.4.5 evenandodd_wall</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-evenandodd_005fwall-operator">evenandodd_wall operator</a></td><td valign="top"><a href="#evenandodd_005fwall-operator">7.1.5.3 evenandodd_wall operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-evenminusodd_005fwall">evenminusodd_wall</a></td><td valign="top"><a href="#evenminusodd_005fwall">7.1.4.6 evenminusodd_wall</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-even_005fwall">even_wall</a></td><td valign="top"><a href="#even_005fwall">7.1.4.4 even_wall</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-fat_005fcovariant_005fgaussian-operator">fat_covariant_gaussian operator</a></td><td valign="top"><a href="#fat_005fcovariant_005fgaussian-operator">7.1.5.12 fat_covariant_gaussian operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Fermion-force-_0028multiple_0029">Fermion force (multiple)</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FFT">FFT</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Free-Software-Foundation">Free Software Foundation</a></td><td valign="top"><a href="#Usage-conditions">1.2 Usage conditions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-funnywall1-operator">funnywall1 operator</a></td><td valign="top"><a href="#funnywall1-operator">7.1.5.13 funnywall1 operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-funnywall2-operator">funnywall2 operator</a></td><td valign="top"><a href="#funnywall2-operator">7.1.5.14 funnywall2 operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-funnywall2-operator-1">funnywall2 operator</a></td><td valign="top"><a href="#rotate_005f3D-operator">7.1.5.15 funnywall2 operator</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gauge-field-input">Gauge field input</a></td><td valign="top"><a href="#Gauge-field-input">7.1.2.1 Gauge field input</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gauge-field-output">Gauge field output</a></td><td valign="top"><a href="#Gauge-field-output">7.1.2.3 Gauge field output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gauge-field-specification">Gauge field specification</a></td><td valign="top"><a href="#Gauge-field-specification">7.1.2 Gauge field specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gaussian-operator">gaussian operator</a></td><td valign="top"><a href="#gaussian-operator">7.1.5.4 gaussian</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gaussian_005fwall">gaussian_wall</a></td><td valign="top"><a href="#gaussian">7.1.4.7 gaussian_wall</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-General-description-of-the-MILC-Code">General description of the MILC Code</a></td><td valign="top"><a href="#General-description">4. General description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gen_005fpt_005b_005d">gen_pt[]</a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-geom">geom</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Geometry-etc_002e-specification">Geometry etc. specification</a></td><td valign="top"><a href="#Geometry-etc_002e-specification">7.1.1 Geometry etc. specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Global-variables">Global variables</a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-General-Public-License">GNU General Public License</a></td><td valign="top"><a href="#Usage-conditions">1.2 Usage conditions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-fat-link-construction">GPU fat link construction</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-gauge-force">GPU gauge force</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-reunitarization">GPU reunitarization</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-staggered-conjugate-gradient">GPU staggered conjugate gradient</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-staggered-fermion-force">GPU staggered fermion force</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPU-Support">GPU Support</a></td><td valign="top"><a href="#GPU-Support">1.6 GPU Support</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Hadron-description">Hadron description</a></td><td valign="top"><a href="#Hadron-description">7.1.8 Hadron description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-header-files">header files</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HISQ">HISQ</a></td><td valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-I_002fO-partitions">I/O partitions</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-identity-operator">identity operator</a></td><td valign="top"><a href="#identity-operator">7.1.5.5 identity operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Inlining">Inlining</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installing-the-Code">Installing the Code</a></td><td valign="top"><a href="#Portability">1.4 Portability</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installing-the-MILC-Code">Installing the MILC Code</a></td><td valign="top"><a href="#Installing-the-MILC-Code">1.3 Installing the MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Intel-Paragon">Intel Paragon</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-interupts">interupts</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Inversion-control">Inversion control</a></td><td valign="top"><a href="#Inversion-control">7.1.3 Inversion control</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-io_005flat_002eh">io_lat.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-iPSC_002d860">iPSC-860</a></td><td valign="top"><a href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-jobs">jobs</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-baryon-description">KS baryon description</a></td><td valign="top"><a href="#KS-baryon-description">7.2.9 KS baryon description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-base-sources">KS base sources</a></td><td valign="top"><a href="#KS-base-sources">7.2.4 KS base sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-gauge-field-specification">KS gauge field specification</a></td><td valign="top"><a href="#KS-gauge-field-specification">7.2.2 KS gauge field specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-geometry-etc_002e-specification">KS geometry etc. specification</a></td><td valign="top"><a href="#KS-geometry-etc_002e-specification">7.2.1 KS geometry etc. specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-meson-description">KS meson description</a></td><td valign="top"><a href="#KS-meson-description">7.2.8 KS meson description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-modified-sources">KS modified sources</a></td><td valign="top"><a href="#KS-modified-sources">7.2.5 KS modified sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-propagator-set-description">KS propagator set description</a></td><td valign="top"><a href="#KS-propagator-set-description">7.2.6 KS propagator set description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-quark-condensate-specification">KS quark condensate specification</a></td><td valign="top"><a href="#KS-quark-condensate-specification">7.2.3 KS quark condensate specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-KS-quark-description">KS quark description</a></td><td valign="top"><a href="#KS-quark-description">7.2.7 KS quark description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ks_005fspectrum">ks_spectrum</a></td><td valign="top"><a href="#ks_005fspectrum">7.2 ks_spectrum</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#Top">Last change</a></td><td valign="top"><a href="#Top">The MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Lattice-storage">Lattice storage</a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lattice_002eh">lattice.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lattice_005b_005d">lattice[]</a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Layout">Layout</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-libraries">libraries</a></td><td valign="top"><a href="#Directory-Layout">4.1 Directory Layout</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Library-routines">Library routines</a></td><td valign="top"><a href="#Library-routines">5.5 Library routines</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Macros_002c-Optional">Macros, Optional</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002eh">macros.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Makefiles">Makefiles</a></td><td valign="top"><a href="#Building-the-MILC-Code">2. Building the MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-making-the-libraries">making the libraries</a></td><td valign="top"><a href="#Making-the-Libraries">2.1 Making the Libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mesh-view">mesh view</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MILC-Collaboration">MILC Collaboration</a></td><td valign="top"><a href="#General-description">4. General description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MILC-Homepage">MILC Homepage</a></td><td valign="top"><a href="#Web-sites">1.1 Web sites</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Mixed-Precision">Mixed Precision</a></td><td valign="top"><a href="#Precision">4.3 Precision</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Modified-sources">Modified sources</a></td><td valign="top"><a href="#Modified-sources">7.1.5 Modified sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Moving-around-in-the-lattice">Moving around in the lattice</a></td><td valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-multijob-operation">multijob operation</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-neighbor_005b_005d">neighbor[]</a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Obtaining-the-MILC-Code">Obtaining the MILC Code</a></td><td valign="top"><a href="#Obtaining-the-MILC-Code">1. Obtaining the MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Optimization">Optimization</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Overview-of-Applications-in-Release-Version">Overview of Applications in Release Version</a></td><td valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-params_002eh">params.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-params_002eh_002c-which-is-passed-between-nodes-by">params.h, which is passed between nodes by</a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-point-source">point source</a></td><td valign="top"><a href="#point">7.1.4.8 point</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Portability">Portability</a></td><td valign="top"><a href="#Portability">1.4 Portability</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Precision">Precision</a></td><td valign="top"><a href="#Precision">4.3 Precision</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Profiling">Profiling</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Programming-with-MILC-Code">Programming with MILC Code</a></td><td valign="top"><a href="#Programming-with-MILC-Code">5. Programming with MILC Code</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Propagator-description">Propagator description</a></td><td valign="top"><a href="#Propagator-description">7.1.6 Propagator description</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-QIO">QIO</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-QMP">QMP</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qmp_002dgeom">qmp-geom</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qmp_002dgeom-1">qmp-geom</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qmp_002djobs">qmp-jobs</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-QOP">QOP</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Quark-description">Quark description</a></td><td valign="top"><a href="#Quark-description">7.1.7 Quark description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-questions-to-the-authors">questions to the authors</a></td><td valign="top"><a href="#Supported-architectures">1.7 Supported architectures</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-numbers">Random numbers</a></td><td valign="top"><a href="#Random-numbers">5.11 Random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-random_005fcolor_005fwall-source">random_color_wall source</a></td><td valign="top"><a href="#random_005fcolor_005fwall">7.1.4.10 random_color_wall</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rational-function">rational function</a></td><td valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reading-and-writing-lattices-and-propagators">Reading and writing lattices and propagators</a></td><td valign="top"><a href="#Reading-and-Writing-Lattices-and-Propagators">5.10 Reading and writing lattices and propagators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RHMC">RHMC</a></td><td valign="top"><a href="#Overview-of-applications">4.2 Overview of Applications</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RHMC-1">RHMC</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-SciDAC-Support">SciDAC Support</a></td><td valign="top"><a href="#SciDAC-Support">1.5 SciDAC Support</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-setup_002ec">&lsquo;<tt>setup.c</tt>&rsquo;</a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-site">site</a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SSE">SSE</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stderr">stderr</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stdin">stdin</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stdout">stdout</a></td><td valign="top"><a href="#Command-line-options">3. Command line options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-su3_002eh">su3.h</a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Supported-architectures">Supported architectures</a></td><td valign="top"><a href="#Supported-architectures">1.7 Supported architectures</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tadpole-factor-and-gauge-fixing">Tadpole factor and gauge fixing</a></td><td valign="top"><a href="#Tadpole-factor-and-gauge-fixing">7.1.2.2 Tadpole factor and gauge fixing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Timing">Timing</a></td><td valign="top"><a href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Usage-conditions">Usage conditions</a></td><td valign="top"><a href="#Usage-conditions">1.2 Usage conditions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-vector_005ffield-source">vector_field source</a></td><td valign="top"><a href="#vector_005ffield">7.1.4.11 vector_field</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-vector_005ffield_005ffm-source">vector_field_fm source</a></td><td valign="top"><a href="#vector_005ffield_005ffm">7.1.4.12 vector_field_fm</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-vector_005fpropagator_005ffile-source">vector_propagator_file source</a></td><td valign="top"><a href="#vector_005fpropagator_005ffile">7.1.4.13 vector_propagator_file</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-wavefunction-operator">wavefunction operator</a></td><td valign="top"><a href="#wavefunction-operator">7.1.5.6 wavefunction operator</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-wavefunction-source">wavefunction source</a></td><td valign="top"><a href="#wavefunction">7.1.4.9 wavefunction</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Web-sites">Web sites</a></td><td valign="top"><a href="#Web-sites">1.1 Web sites</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Writing-Your-Own-Application">Writing Your Own Application</a></td><td valign="top"><a href="#Writing-Your-Own-Application">6. Writing Your Own Application</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-Index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-J" class="summary-letter"><b>J</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>


<hr size="6">
<a name="Variable-Index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Concept-Index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Variable-Index-1"></a>
<h1 class="unnumbered">Variable Index</h1>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Variable-Index-1_vr_symbol-1" class="summary-letter"><b>*</b></a>
 &nbsp; 
<br>
<a href="#Variable-Index-1_vr_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-vr">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_symbol-1">*</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002asavefile"><code>*savefile</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002astartfile"><code>*startfile</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-beta"><code>beta</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-CONTROL"><code>CONTROL</code></a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-epsilon"><code>epsilon</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-even_005fsites_005fon_005fnode"><code>even_sites_on_node</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-EXTERN"><code>EXTERN</code></a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-field_005foffset"><code>field_offset</code></a></td><td valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-field_005fpointer"><code>field_pointer</code></a></td><td valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fixflag"><code>fixflag</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-F_005fOFFSET"><code>F_OFFSET</code></a></td><td valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-F_005fPT"><code>F_PT</code></a></td><td valign="top"><a href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Include-files_002e"><code>Include files.</code></a></td><td valign="top"><a href="#Header-files">5.1 Header files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-iseed"><code>iseed</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-mass"><code>mass</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-nflavors"><code>nflavors</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nflavors1_002c-nflavors2"><code>nflavors1, nflavors2</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-number_005fof_005fnodes"><code>number_of_nodes</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nx_002cny_002cnz_002cnt"><code>nx,ny,nz,nt</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-odd_005fsites_005fon_005fnode"><code>odd_sites_on_node</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-params"><code>params</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-saveflag"><code>saveflag</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-saveflag-1"><code>saveflag</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-site-1"><code>site</code></a></td><td valign="top"><a href="#Lattice-storage">5.3 Lattice storage</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sites_005fon_005fnode"><code>sites_on_node</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-startflag"><code>startflag</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-steps"><code>steps</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-this_005fnode"><code>this_node</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-total_005fiters"><code>total_iters</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-trajecs"><code>trajecs</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-volume"><code>volume</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Variable-Index-1_vr_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-warms"><code>warms</code></a></td><td valign="top"><a href="#Global-variables">5.2 Global variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Variable-Index-1_vr_symbol-1" class="summary-letter"><b>*</b></a>
 &nbsp; 
<br>
<a href="#Variable-Index-1_vr_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Variable-Index-1_vr_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>


<hr size="6">
<a name="SEC_Contents"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>
<div class="contents">

<ul class="toc">
  <li><a name="toc-Obtaining-the-MILC-Code-1" href="#Obtaining-the-MILC-Code">1. Obtaining the MILC Code</a>
  <ul class="toc">
    <li><a name="toc-Web-sites-1" href="#Web-sites">1.1 Web sites</a></li>
    <li><a name="toc-Usage-conditions-1" href="#Usage-conditions">1.2 Usage conditions</a></li>
    <li><a name="toc-Installing-the-MILC-Code-1" href="#Installing-the-MILC-Code">1.3 Installing the MILC Code</a></li>
    <li><a name="toc-Portability-1" href="#Portability">1.4 Portability</a></li>
    <li><a name="toc-SciDAC-Support-1" href="#SciDAC-Support">1.5 SciDAC Support</a></li>
    <li><a name="toc-GPU-Support-1" href="#GPU-Support">1.6 GPU Support</a></li>
    <li><a name="toc-Supported-architectures-1" href="#Supported-architectures">1.7 Supported architectures</a></li>
  </ul></li>
  <li><a name="toc-Building-the-MILC-Code-1" href="#Building-the-MILC-Code">2. Building the MILC Code</a>
  <ul class="toc">
    <li><a name="toc-Making-the-Libraries" href="#Making-the-Libraries">2.1 Making the Libraries</a></li>
    <li><a name="toc-Checking-the-Build" href="#Checking-the-Build">2.2 Checking the Build</a></li>
  </ul></li>
  <li><a name="toc-Command-line-options-1" href="#Command-line-options">3. Command line options</a></li>
  <li><a name="toc-General-description-1" href="#General-description">4. General description</a>
  <ul class="toc">
    <li><a name="toc-Directory-Layout-1" href="#Directory-Layout">4.1 Directory Layout</a></li>
    <li><a name="toc-Overview-of-Applications" href="#Overview-of-applications">4.2 Overview of Applications</a></li>
    <li><a name="toc-Precision-1" href="#Precision">4.3 Precision</a></li>
    <li><a name="toc-Optional-Compilation-Macros-1" href="#Optional-Compilation-Macros">4.4 Optional Compilation Macros</a></li>
  </ul></li>
  <li><a name="toc-Programming-with-MILC-Code-1" href="#Programming-with-MILC-Code">5. Programming with MILC Code</a>
  <ul class="toc">
    <li><a name="toc-Header-files-1" href="#Header-files">5.1 Header files</a></li>
    <li><a name="toc-Global-variables-1" href="#Global-variables">5.2 Global variables</a></li>
    <li><a name="toc-Lattice-storage-1" href="#Lattice-storage">5.3 Lattice storage</a></li>
    <li><a name="toc-Data-types-1" href="#Data-types">5.4 Data types</a></li>
    <li><a name="toc-Library-routines-1" href="#Library-routines">5.5 Library routines</a>
    <ul class="toc">
      <li><a name="toc-Complex-numbers" href="#Complex-numbers">5.5.1 Complex numbers</a></li>
      <li><a name="toc-SU_00283_0029-operations" href="#SU_00283_0029-operations">5.5.2 SU(3) operations</a></li>
    </ul></li>
    <li><a name="toc-Moving-around-in-the-lattice-1" href="#Moving-around-in-the-lattice">5.6 Moving around in the lattice</a></li>
    <li><a name="toc-Accessing-fields-at-other-sites-1" href="#Accessing-fields-at-other-sites">5.7 Accessing fields at other sites</a></li>
    <li><a name="toc-Details-of-gathers-and-creating-new-ones-1" href="#Details-of-gathers-and-creating-new-ones">5.8 Details of gathers and creating new ones</a></li>
    <li><a name="toc-Distributing-sites-among-nodes-1" href="#Distributing-sites-among-nodes">5.9 Distributing sites among nodes</a></li>
    <li><a name="toc-Reading-and-writing-lattices-and-propagators" href="#Reading-and-Writing-Lattices-and-Propagators">5.10 Reading and writing lattices and propagators</a></li>
    <li><a name="toc-Random-numbers-1" href="#Random-numbers">5.11 Random numbers</a></li>
    <li><a name="toc-A-Sample-Applications-Directory-1" href="#A-Sample-Applications-Directory">5.12 A Sample Applications Directory</a></li>
    <li><a name="toc-Bugs-and-features-1" href="#Bugs-and-features">5.13 Bugs and features</a></li>
  </ul></li>
  <li><a name="toc-Writing-Your-Own-Application-1" href="#Writing-Your-Own-Application">6. Writing Your Own Application</a></li>
  <li><a name="toc-Documentation-for-Specific-Applications-1" href="#Documentation-for-Specific-Applications">7. Documentation for Specific Applications</a>
  <ul class="toc">
    <li><a name="toc-clover_005finvert2-1" href="#clover_005finvert2">7.1 clover_invert2</a>
    <ul class="toc">
      <li><a name="toc-Geometry-etc_002e-specification-1" href="#Geometry-etc_002e-specification">7.1.1 Geometry etc. specification</a></li>
      <li><a name="toc-Gauge-field-specification-1" href="#Gauge-field-specification">7.1.2 Gauge field specification</a>
      <ul class="toc">
        <li><a name="toc-Gauge-field-input-1" href="#Gauge-field-input">7.1.2.1 Gauge field input</a></li>
        <li><a name="toc-Tadpole-factor-and-gauge-fixing-1" href="#Tadpole-factor-and-gauge-fixing">7.1.2.2 Tadpole factor and gauge fixing</a></li>
        <li><a name="toc-Gauge-field-output-1" href="#Gauge-field-output">7.1.2.3 Gauge field output</a></li>
        <li><a name="toc-APE-smearing-1" href="#APE-smearing">7.1.2.4 APE smearing</a></li>
        <li><a name="toc-Coordinate-origin-1" href="#Coordinate-origin">7.1.2.5 Coordinate origin</a></li>
      </ul></li>
      <li><a name="toc-Inversion-control-1" href="#Inversion-control">7.1.3 Inversion control</a></li>
      <li><a name="toc-Base-sources-1" href="#Base-sources">7.1.4 Base sources</a>
      <ul class="toc">
        <li><a name="toc-complex_005ffield-1" href="#complex_005ffield">7.1.4.1 complex_field</a></li>
        <li><a name="toc-complex_005ffield_005ffm-1" href="#complex_005ffield_005ffm">7.1.4.2 complex_field_fm</a></li>
        <li><a name="toc-corner_005fwall-1" href="#corner_005fwall">7.1.4.3 corner_wall</a></li>
        <li><a name="toc-even_005fwall-1" href="#even_005fwall">7.1.4.4 even_wall</a></li>
        <li><a name="toc-evenandodd_005fwall-1" href="#evenandodd_005fwall">7.1.4.5 evenandodd_wall</a></li>
        <li><a name="toc-evenminusodd_005fwall-1" href="#evenminusodd_005fwall">7.1.4.6 evenminusodd_wall</a></li>
        <li><a name="toc-gaussian_005fwall" href="#gaussian">7.1.4.7 gaussian_wall</a></li>
        <li><a name="toc-point-1" href="#point">7.1.4.8 point</a></li>
        <li><a name="toc-wavefunction-1" href="#wavefunction">7.1.4.9 wavefunction</a></li>
        <li><a name="toc-random_005fcolor_005fwall-1" href="#random_005fcolor_005fwall">7.1.4.10 random_color_wall</a></li>
        <li><a name="toc-vector_005ffield-1" href="#vector_005ffield">7.1.4.11 vector_field</a></li>
        <li><a name="toc-vector_005ffield_005ffm-1" href="#vector_005ffield_005ffm">7.1.4.12 vector_field_fm</a></li>
        <li><a name="toc-vector_005fpropagator_005ffile-1" href="#vector_005fpropagator_005ffile">7.1.4.13 vector_propagator_file</a></li>
        <li><a name="toc-dirac_005ffield-1" href="#dirac_005ffield">7.1.4.14 dirac_field</a></li>
        <li><a name="toc-dirac_005ffield_005ffm-1" href="#dirac_005ffield_005ffm">7.1.4.15 dirac_field_fm</a></li>
        <li><a name="toc-dirac_005fpropagator_005ffile-1" href="#dirac_005fpropagator_005ffile">7.1.4.16 dirac_propagator_file</a></li>
      </ul></li>
      <li><a name="toc-Modified-sources-1" href="#Modified-sources">7.1.5 Modified sources</a>
      <ul class="toc">
        <li><a name="toc-complex_005ffield-operator-1" href="#complex_005ffield-operator">7.1.5.1 complex_field operator</a></li>
        <li><a name="toc-complex_005ffield_005ffm-operator-1" href="#complex_005ffield_005ffm-operator">7.1.5.2 complex_field_fm operator</a></li>
        <li><a name="toc-evenandodd_005fwall-operator-1" href="#evenandodd_005fwall-operator">7.1.5.3 evenandodd_wall operator</a></li>
        <li><a name="toc-gaussian-1" href="#gaussian-operator">7.1.5.4 gaussian</a></li>
        <li><a name="toc-identity-operator-1" href="#identity-operator">7.1.5.5 identity operator</a></li>
        <li><a name="toc-wavefunction-operator-1" href="#wavefunction-operator">7.1.5.6 wavefunction operator</a></li>
        <li><a name="toc-covariant_005fgaussian-operator-1" href="#covariant_005fgaussian-operator">7.1.5.7 covariant_gaussian operator</a></li>
        <li><a name="toc-deriv1-operator-1" href="#deriv1-operator">7.1.5.8 deriv1 operator</a></li>
        <li><a name="toc-deriv2_005fD-operator-1" href="#deriv2_005fD-operator">7.1.5.9 deriv2_D operator</a></li>
        <li><a name="toc-deriv2_005fB-operator-1" href="#deriv2_005fB-operator">7.1.5.10 deriv2_B operator</a></li>
        <li><a name="toc-deriv3_005fA-operator-1" href="#deriv3_005fA-operator">7.1.5.11 deriv3_A operator</a></li>
        <li><a name="toc-fat_005fcovariant_005fgaussian-operator-1" href="#fat_005fcovariant_005fgaussian-operator">7.1.5.12 fat_covariant_gaussian operator</a></li>
        <li><a name="toc-funnywall1-operator-1" href="#funnywall1-operator">7.1.5.13 funnywall1 operator</a></li>
        <li><a name="toc-funnywall2-operator-2" href="#funnywall2-operator">7.1.5.14 funnywall2 operator</a></li>
        <li><a name="toc-funnywall2-operator-1" href="#rotate_005f3D-operator">7.1.5.15 funnywall2 operator</a></li>
      </ul></li>
      <li><a name="toc-Propagator-description-1" href="#Propagator-description">7.1.6 Propagator description</a></li>
      <li><a name="toc-Quark-description-1" href="#Quark-description">7.1.7 Quark description</a></li>
      <li><a name="toc-Hadron-description-1" href="#Hadron-description">7.1.8 Hadron description</a></li>
    </ul></li>
    <li><a name="toc-ks_005fspectrum-1" href="#ks_005fspectrum">7.2 ks_spectrum</a>
    <ul class="toc">
      <li><a name="toc-KS-geometry-etc_002e-specification-1" href="#KS-geometry-etc_002e-specification">7.2.1 KS geometry etc. specification</a></li>
      <li><a name="toc-KS-gauge-field-specification-1" href="#KS-gauge-field-specification">7.2.2 KS gauge field specification</a></li>
      <li><a name="toc-KS-quark-condensate-specification-1" href="#KS-quark-condensate-specification">7.2.3 KS quark condensate specification</a></li>
      <li><a name="toc-KS-base-sources-1" href="#KS-base-sources">7.2.4 KS base sources</a></li>
      <li><a name="toc-KS-modified-sources-1" href="#KS-modified-sources">7.2.5 KS modified sources</a></li>
      <li><a name="toc-KS-propagator-set-description-1" href="#KS-propagator-set-description">7.2.6 KS propagator set description</a></li>
      <li><a name="toc-KS-quark-description-1" href="#KS-quark-description">7.2.7 KS quark description</a></li>
      <li><a name="toc-KS-meson-description-1" href="#KS-meson-description">7.2.8 KS meson description</a></li>
      <li><a name="toc-KS-baryon-description-1" href="#KS-baryon-description">7.2.9 KS baryon description</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Concept-Index-1" href="#Concept-Index">Concept Index</a></li>
  <li><a name="toc-Variable-Index-1" href="#Variable-Index">Variable Index</a></li>
</ul>
</div>
<hr size="1">
<a name="SEC_About"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>
<p>
  This document was generated by <em>Carleton DeTar</em> on <em>February 21, 2012</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr size="1">
<p>
 <font size="-1">
  This document was generated by <em>Carleton DeTar</em> on <em>February 21, 2012</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
